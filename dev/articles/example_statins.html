<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Example: Statins for cholesterol lowering • multinma</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Example: Statins for cholesterol lowering">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multinma</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.7.1.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vignette_overview.html">Overview of Examples</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Examples</h6></li>
    <li><a class="dropdown-item" href="../articles/example_atrial_fibrillation.html">Example: Atrial fibrillation</a></li>
    <li><a class="dropdown-item" href="../articles/example_bcg_vaccine.html">Example: BCG vaccine for tuberculosis</a></li>
    <li><a class="dropdown-item" href="../articles/example_blocker.html">Example: Beta blockers</a></li>
    <li><a class="dropdown-item" href="../articles/example_diabetes.html">Example: Diabetes</a></li>
    <li><a class="dropdown-item" href="../articles/example_dietary_fat.html">Example: Dietary fat</a></li>
    <li><a class="dropdown-item" href="../articles/example_hta_psoriasis.html">Example: Plaque psoriasis HTA report</a></li>
    <li><a class="dropdown-item" href="../articles/example_ndmm.html">Example: Newly diagnosed multiple myeloma</a></li>
    <li><a class="dropdown-item" href="../articles/example_parkinsons.html">Example: Parkinson's disease</a></li>
    <li><a class="dropdown-item" href="../articles/example_plaque_psoriasis.html">Example: Plaque psoriasis ML-NMR</a></li>
    <li><a class="dropdown-item" href="../articles/example_smoking.html">Example: Smoking cessation</a></li>
    <li><a class="dropdown-item" href="../articles/example_statins.html">Example: Statins for cholesterol lowering</a></li>
    <li><a class="dropdown-item" href="../articles/example_thrombolytics.html">Example: Thrombolytic treatments</a></li>
    <li><a class="dropdown-item" href="../articles/example_transfusion.html">Example: White blood cell transfusion</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dmphillippo/multinma/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Example: Statins for cholesterol lowering</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dmphillippo/multinma/blob/develop/vignettes/example_statins.Rmd" class="external-link"><code>vignettes/example_statins.Rmd</code></a></small>
      <div class="d-none name"><code>example_statins.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dmphillippo.github.io/multinma/">multinma</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; For execution on a local, multicore CPU with excess RAM we recommend calling</span></span>
<span><span class="co">#&gt; options(mc.cores = parallel::detectCores())</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'multinma'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     dgamma, pgamma, qgamma</span></span></code></pre>
<p>This vignette describes the analysis of 19 trials comparing statins
to placebo or usual care <span class="citation">(<a href="#ref-TSD3">Dias et al. 2011</a>)</span>. The data are available in
this package as <code>statins</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">statins</span><span class="op">)</span></span>
<span><span class="co">#&gt;   studyn    studyc trtn    trtc prevention   r    n</span></span>
<span><span class="co">#&gt; 1      1        4S    1 Placebo  Secondary 256 2223</span></span>
<span><span class="co">#&gt; 2      1        4S    2  Statin  Secondary 182 2221</span></span>
<span><span class="co">#&gt; 3      2 Bestehorn    1 Placebo  Secondary   4  125</span></span>
<span><span class="co">#&gt; 4      2 Bestehorn    2  Statin  Secondary   1  129</span></span>
<span><span class="co">#&gt; 5      3     Brown    1 Placebo  Secondary   0   52</span></span>
<span><span class="co">#&gt; 6      3     Brown    2  Statin  Secondary   1   94</span></span></code></pre></div>
<p><span class="citation">Dias et al. (<a href="#ref-TSD3">2011</a>)</span> used these data to demonstrate
meta-regression models adjusting for the binary covariate
<code>prevention</code> (primary or secondary prevention), which we
recreate here.</p>
<div class="section level2">
<h2 id="setting-up-the-network">Setting up the network<a class="anchor" aria-label="anchor" href="#setting-up-the-network"></a>
</h2>
<p>We have data giving the number of deaths (<code>r</code>) out of the
total (<code>n</code>) in each arm, so we use the function
<code><a href="../reference/set_agd_arm.html">set_agd_arm()</a></code> to set up the network. We set placebo as the
network reference treatment.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">statin_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_agd_arm.html">set_agd_arm</a></span><span class="op">(</span><span class="va">statins</span>, </span>
<span>                          study <span class="op">=</span> <span class="va">studyc</span>,</span>
<span>                          trt <span class="op">=</span> <span class="va">trtc</span>,</span>
<span>                          r <span class="op">=</span> <span class="va">r</span>, </span>
<span>                          n <span class="op">=</span> <span class="va">n</span>,</span>
<span>                          trt_ref <span class="op">=</span> <span class="st">"Placebo"</span><span class="op">)</span></span>
<span><span class="va">statin_net</span></span>
<span><span class="co">#&gt; A network with 19 AgD studies (arm-based).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">-------------------------------------------------------</span> <span style="font-weight: bold;">AgD studies (arm-based)</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt;  Study     Treatment arms     </span></span>
<span><span class="co">#&gt;  4S        2: Placebo | Statin</span></span>
<span><span class="co">#&gt;  Bestehorn 2: Placebo | Statin</span></span>
<span><span class="co">#&gt;  Brown     2: Placebo | Statin</span></span>
<span><span class="co">#&gt;  CCAIT     2: Placebo | Statin</span></span>
<span><span class="co">#&gt;  Downs     2: Placebo | Statin</span></span>
<span><span class="co">#&gt;  EXCEL     2: Placebo | Statin</span></span>
<span><span class="co">#&gt;  Furberg   2: Placebo | Statin</span></span>
<span><span class="co">#&gt;  Haskell   2: Placebo | Statin</span></span>
<span><span class="co">#&gt;  Jones     2: Placebo | Statin</span></span>
<span><span class="co">#&gt;  KAPS      2: Placebo | Statin</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> ... plus 9 more studies</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Outcome type: count</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">------------------------------------------------------------------------------------</span></span></span>
<span><span class="co">#&gt; Total number of treatments: 2</span></span>
<span><span class="co">#&gt; Total number of studies: 19</span></span>
<span><span class="co">#&gt; Reference treatment is: Placebo</span></span>
<span><span class="co">#&gt; Network is <span style="color: #00BB00;">connected</span></span></span></code></pre></div>
<p>The <code>prevention</code> variable in the <code>statins</code> data
frame will automatically be available to use in a meta-regression
model.</p>
</div>
<div class="section level2">
<h2 id="meta-analysis-models">Meta-analysis models<a class="anchor" aria-label="anchor" href="#meta-analysis-models"></a>
</h2>
<p>We fit fixed effect (FE) and random effects (RE) models, with a
meta-regression on the binary covariate <code>prevention</code>.</p>
<div class="section level3">
<h3 id="fixed-effect-meta-regression">Fixed effect meta-regression<a class="anchor" aria-label="anchor" href="#fixed-effect-meta-regression"></a>
</h3>
<p>We start by fitting a FE model. We use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mn>100</mn><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{N}(0, 100^2)</annotation></semantics></math>
prior distributions for the treatment effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></msub><annotation encoding="application/x-tex">d_\mathrm{Statin}</annotation></semantics></math>,
study-specific intercepts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\mu_j</annotation></semantics></math>,
and regression coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>.
We can examine the range of parameter values implied by these prior
distributions with the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; A Normal prior distribution: location = 0, scale = 100.</span></span>
<span><span class="co">#&gt; 50% of the prior density lies between -67.45 and 67.45.</span></span>
<span><span class="co">#&gt; 95% of the prior density lies between -196 and 196.</span></span></code></pre></div>
<p>The model is fitted with the <code><a href="../reference/nma.html">nma()</a></code> function, with a
fixed effect model specified by <code>trt_effects = "fixed"</code>. The
<code>regression</code> formula <code>~ .trt:prevention</code> means
that interaction of primary/secondary prevention with treatment will be
included; the <code>.trt</code> special variable indicates treatment,
and <code>prevention</code> is in the original data set.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">statin_fit_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">statin_net</span>, </span>
<span>                     trt_effects <span class="op">=</span> <span class="st">"fixed"</span>,</span>
<span>                     regression <span class="op">=</span> <span class="op">~</span><span class="va">.trt</span><span class="op">:</span><span class="va">prevention</span>,</span>
<span>                     prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                     prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                     prior_reg <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: No treatment classes specified in network, any interactions in `regression` formula will be separate (independent) for each treatment.</span></span>
<span><span class="co">#&gt; Use set_*() argument `trt_class` and nma() argument `class_interactions` to change this.</span></span></code></pre></div>
<p>Basic parameter summaries are given by the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>
method:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">statin_fit_FE</span></span>
<span><span class="co">#&gt; A fixed effects NMA with a binomial likelihood (logit link).</span></span>
<span><span class="co">#&gt; Regression model: ~.trt:prevention.</span></span>
<span><span class="co">#&gt; Inference for Stan model: binomial_1par.</span></span>
<span><span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span></span>
<span><span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                          mean se_mean   sd     2.5%      25%      50%      75%</span></span>
<span><span class="co">#&gt; beta[.trtStatin:preventionSecondary]    -0.21    0.00 0.11    -0.43    -0.28    -0.21    -0.13</span></span>
<span><span class="co">#&gt; d[Statin]                               -0.10    0.00 0.10    -0.29    -0.17    -0.10    -0.04</span></span>
<span><span class="co">#&gt; lp__                                 -7246.65    0.09 3.40 -7254.24 -7248.77 -7246.33 -7244.14</span></span>
<span><span class="co">#&gt;                                         97.5% n_eff Rhat</span></span>
<span><span class="co">#&gt; beta[.trtStatin:preventionSecondary]     0.01  2522    1</span></span>
<span><span class="co">#&gt; d[Statin]                                0.09  2463    1</span></span>
<span><span class="co">#&gt; lp__                                 -7241.06  1543    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Tue Jul 30 15:12:07 2024.</span></span>
<span><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span><span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span></span>
<span><span class="co">#&gt; convergence, Rhat=1).</span></span></code></pre></div>
<p>By default, summaries of the study-specific intercepts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\mu_j</annotation></semantics></math>
are hidden, but could be examined by changing the <code>pars</code>
argument:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Not run</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">statin_fit_FE</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"beta"</span>, <span class="st">"mu"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The prior and posterior distributions can be compared visually using
the <code><a href="../reference/plot_prior_posterior.html">plot_prior_posterior()</a></code> function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_prior_posterior.html">plot_prior_posterior</a></span><span class="op">(</span><span class="va">statin_fit_FE</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trt"</span>, <span class="st">"reg"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_statins_files/figure-html/statin_FE_pp_plot-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="random-effects-meta-regression">Random effects meta-regression<a class="anchor" aria-label="anchor" href="#random-effects-meta-regression"></a>
</h3>
<p>We now fit a RE model. We use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mn>100</mn><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{N}(0, 100^2)</annotation></semantics></math>
prior distributions for the treatment effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></msub><annotation encoding="application/x-tex">d_\mathrm{Statin}</annotation></semantics></math>,
study-specific intercepts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\mu_j</annotation></semantics></math>,
and regression coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>.
We use a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">half-N</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mn>5</mn><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\textrm{half-N}(0, 5^2)</annotation></semantics></math>
prior distribution for the heterogeneity standard deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>.
We can examine the range of parameter values implied by these prior
distributions with the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; A Normal prior distribution: location = 0, scale = 100.</span></span>
<span><span class="co">#&gt; 50% of the prior density lies between -67.45 and 67.45.</span></span>
<span><span class="co">#&gt; 95% of the prior density lies between -196 and 196.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">half_normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; A half-Normal prior distribution: location = 0, scale = 5.</span></span>
<span><span class="co">#&gt; 50% of the prior density lies between 0 and 3.37.</span></span>
<span><span class="co">#&gt; 95% of the prior density lies between 0 and 9.8.</span></span></code></pre></div>
<p>Again, the model is fitted with the <code><a href="../reference/nma.html">nma()</a></code> function, now
with <code>trt_effects = "random"</code>. We increase
<code>adapt_delta</code> to 0.99 to remove a small number of divergent
transition errors (the default for RE models is set to 0.95).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">statin_fit_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">statin_net</span>, </span>
<span>                     trt_effects <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>                     regression <span class="op">=</span> <span class="op">~</span><span class="va">.trt</span><span class="op">:</span><span class="va">prevention</span>,</span>
<span>                     prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                     prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                     prior_reg <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                     prior_het <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">half_normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>                     adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: No treatment classes specified in network, any interactions in `regression` formula will be separate (independent) for each treatment.</span></span>
<span><span class="co">#&gt; Use set_*() argument `trt_class` and nma() argument `class_interactions` to change this.</span></span></code></pre></div>
<p>Basic parameter summaries are given by the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>
method:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">statin_fit_RE</span></span>
<span><span class="co">#&gt; A random effects NMA with a binomial likelihood (logit link).</span></span>
<span><span class="co">#&gt; Regression model: ~.trt:prevention.</span></span>
<span><span class="co">#&gt; Inference for Stan model: binomial_1par.</span></span>
<span><span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span></span>
<span><span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                          mean se_mean   sd     2.5%      25%      50%      75%</span></span>
<span><span class="co">#&gt; beta[.trtStatin:preventionSecondary]    -0.30    0.01 0.26    -0.90    -0.43    -0.27    -0.15</span></span>
<span><span class="co">#&gt; d[Statin]                               -0.06    0.01 0.21    -0.46    -0.18    -0.07     0.04</span></span>
<span><span class="co">#&gt; lp__                                 -7255.75    0.18 5.35 -7266.83 -7259.27 -7255.51 -7252.11</span></span>
<span><span class="co">#&gt; tau                                      0.25    0.01 0.21     0.01     0.09     0.19     0.34</span></span>
<span><span class="co">#&gt;                                         97.5% n_eff Rhat</span></span>
<span><span class="co">#&gt; beta[.trtStatin:preventionSecondary]     0.19   970 1.01</span></span>
<span><span class="co">#&gt; d[Statin]                                0.39  1080 1.01</span></span>
<span><span class="co">#&gt; lp__                                 -7246.03   863 1.01</span></span>
<span><span class="co">#&gt; tau                                      0.77   667 1.01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Tue Jul 30 15:12:11 2024.</span></span>
<span><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span><span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span></span>
<span><span class="co">#&gt; convergence, Rhat=1).</span></span></code></pre></div>
<p>By default, summaries of the study-specific intercepts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\mu_j</annotation></semantics></math>
and study-specific relative effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\delta_{jk}</annotation></semantics></math>
are hidden, but could be examined by changing the <code>pars</code>
argument:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Not run</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">statin_fit_RE</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"beta"</span>, <span class="st">"mu"</span>, <span class="st">"delta"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The prior and posterior distributions can be compared visually using
the <code><a href="../reference/plot_prior_posterior.html">plot_prior_posterior()</a></code> function:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_prior_posterior.html">plot_prior_posterior</a></span><span class="op">(</span><span class="va">statin_fit_RE</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trt"</span>, <span class="st">"reg"</span>, <span class="st">"het"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_statins_files/figure-html/statin_RE_pp_plot-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="model-fit-and-comparison">Model fit and comparison<a class="anchor" aria-label="anchor" href="#model-fit-and-comparison"></a>
</h2>
<p>Model fit can be checked using the <code><a href="../reference/dic.html">dic()</a></code> function:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">statin_dic_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">statin_fit_FE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Residual deviance: 45.9<span style="color: #555555;"> (on 38 data points)</span></span></span>
<span><span class="co">#&gt;                pD: 21.6</span></span>
<span><span class="co">#&gt;               DIC: 67.5</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">statin_dic_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">statin_fit_RE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Residual deviance: 42.5<span style="color: #555555;"> (on 38 data points)</span></span></span>
<span><span class="co">#&gt;                pD: 25</span></span>
<span><span class="co">#&gt;               DIC: 67.4</span></span></code></pre></div>
<p>The DIC is very similar between FE and RE models, so we might choose
the FE model based on parsimony. The residual deviance statistics are
larger than the number of data points, suggesting that some data points
are not fit well.</p>
<p>We can also examine the residual deviance contributions with the
corresponding <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">statin_dic_FE</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_statins_files/figure-html/statin_FE_resdev_plot-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">statin_dic_RE</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_statins_files/figure-html/statin_RE_resdev_plot-1.png" width="700" style="display: block; margin: auto;"></p>
<p>There are a number of studies which are not fit well under either
model, having posterior mean residual deviance contributions greater
than 1, and should be investigated to see if there are further
substantive differences between studies.</p>
</div>
<div class="section level2">
<h2 id="further-results">Further results<a class="anchor" aria-label="anchor" href="#further-results"></a>
</h2>
<p>We can produce estimates of the relative effect of statins
vs. placebo for either primary or secondary prevention, using the
<code><a href="../reference/relative_effects.html">relative_effects()</a></code> function. The <code>newdata</code>
argument specifies a data frame containing the levels of the covariate
<code>prevention</code> that we are interested in, and the
<code>study</code> argument is used to specify a column of
<code>newdata</code> for an informative label.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">statin_releff_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relative_effects.html">relative_effects</a></span><span class="op">(</span><span class="va">statin_fit_FE</span>,</span>
<span>                                     newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>prevention <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Primary"</span>, <span class="st">"Secondary"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                     study <span class="op">=</span> <span class="va">prevention</span><span class="op">)</span></span>
<span></span>
<span><span class="va">statin_releff_FE</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">----------------------------------------------------------------</span> <span style="font-weight: bold;">Study: Primary</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  prevention</span></span>
<span><span class="co">#&gt;     Primary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                    mean  sd  2.5%   25%  50%   75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; d[Primary: Statin] -0.1 0.1 -0.29 -0.17 -0.1 -0.04  0.09     2476     2633    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: Secondary</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  prevention</span></span>
<span><span class="co">#&gt;   Secondary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                       mean   sd  2.5%   25%   50%   75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; d[Secondary: Statin] -0.31 0.05 -0.42 -0.35 -0.31 -0.28 -0.21     4856     3721    1</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method may be used to visually compare these
estimates:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">statin_releff_FE</span>, </span>
<span>     ref_line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_statins_files/figure-html/statins_releff_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Model parameters may be plotted with the corresponding
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">statin_fit_FE</span>, </span>
<span>     pars <span class="op">=</span> <span class="st">"beta"</span>, </span>
<span>     ref_line <span class="op">=</span> <span class="fl">0</span>,</span>
<span>     stat <span class="op">=</span> <span class="st">"halfeye"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_statins_files/figure-html/statins_beta_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Whilst the 95% Credible Interval includes zero, there is a suggestion
that statins are more effective for secondary prevention.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-TSD3" class="csl-entry">
Dias, S., A. J. Sutton, N. J. Welton, and A. E. Ades. 2011.
<span>“<span>NICE DSU Technical Support Document</span> 3:
Heterogeneity: Subgroups, Meta-Regression, Bias and
Bias-Adjustment.”</span> <span>National Institute for Health and Care
Excellence</span>. <a href="https://www.sheffield.ac.uk/nice-dsu" class="external-link">https://www.sheffield.ac.uk/nice-dsu</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David M. Phillippo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>



  <script data-goatcounter="https://multinma.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</body>
</html>
