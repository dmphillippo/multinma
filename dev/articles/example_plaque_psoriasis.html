<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="multinma">
<title>Example: Plaque psoriasis ML-NMR • multinma</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Source%20Sans%20Pro-0.4.0/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Example: Plaque psoriasis ML-NMR">
<meta property="og:description" content="multinma">
<meta property="og:image" content="https://dmphillippo.github.io/multinma/logo.svg">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">multinma</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.3.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vignette_overview.html">Overview of Examples</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Examples</h6>
    <a class="dropdown-item" href="../articles/example_atrial_fibrillation.html">Example: Atrial fibrillation</a>
    <a class="dropdown-item" href="../articles/example_bcg_vaccine.html">Example: BCG vaccine for tuberculosis</a>
    <a class="dropdown-item" href="../articles/example_blocker.html">Example: Beta blockers</a>
    <a class="dropdown-item" href="../articles/example_diabetes.html">Example: Diabetes</a>
    <a class="dropdown-item" href="../articles/example_dietary_fat.html">Example: Dietary fat</a>
    <a class="dropdown-item" href="../articles/example_hta_psoriasis.html">Example: Plaque psoriasis HTA report</a>
    <a class="dropdown-item" href="../articles/example_parkinsons.html">Example: Parkinson's disease</a>
    <a class="dropdown-item" href="../articles/example_plaque_psoriasis.html">Example: Plaque psoriasis ML-NMR</a>
    <a class="dropdown-item" href="../articles/example_smoking.html">Example: Smoking cessation</a>
    <a class="dropdown-item" href="../articles/example_statins.html">Example: Statins for cholesterol lowering</a>
    <a class="dropdown-item" href="../articles/example_thrombolytics.html">Example: Thrombolytic treatments</a>
    <a class="dropdown-item" href="../articles/example_transfusion.html">Example: White blood cell transfusion</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dmphillippo/multinma/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="example_plaque_psoriasis_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Example: Plaque psoriasis ML-NMR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dmphillippo/multinma/blob/HEAD/vignettes/example_plaque_psoriasis.Rmd" class="external-link"><code>vignettes/example_plaque_psoriasis.Rmd</code></a></small>
      <div class="d-none name"><code>example_plaque_psoriasis.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dmphillippo.github.io/multinma/">multinma</a></span><span class="op">)</span>
<span class="co">#&gt; For execution on a local, multicore CPU with excess RAM we recommend calling</span>
<span class="co">#&gt; options(mc.cores = parallel::detectCores())</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'multinma'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     dgamma, pgamma, qgamma</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>      <span class="co"># dplyr and tidyr for data manipulation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>    <span class="co"># ggplot2 for plotting covariate distributions</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Simulated individual patient data (IPD) from trials comparing treatments for plaque psoriasis are found in the data set <code>plaque_psoriasis_ipd</code>. Aggregate data (AgD) are available on a further set of trials, found in the data set <code>plaque_psoriasis_agd</code>. In this vignette, we recreate the multilevel network meta-regression (ML-NMR) analyses performed by <span class="citation">Phillippo et al. (2020; see also Phillippo 2019)</span>. We will analyse IPD from three studies, UNCOVER-1, UNCOVER-2, and UNCOVER-3 <span class="citation">(Griffiths et al. 2015; Gordon et al. 2016)</span>, and AgD from one study, FIXTURE <span class="citation">(Langley et al. 2014)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pso_ipd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plaque_psoriasis_ipd</span>,
                  <span class="va">studyc</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UNCOVER-1"</span>, <span class="st">"UNCOVER-2"</span>, <span class="st">"UNCOVER-3"</span><span class="op">)</span><span class="op">)</span>

<span class="va">pso_agd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plaque_psoriasis_agd</span>,
                  <span class="va">studyc</span> <span class="op">==</span> <span class="st">"FIXTURE"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pso_ipd</span><span class="op">)</span>
<span class="co">#&gt;      studyc      trtc_long    trtc trtn pasi75 pasi90 pasi100 age  bmi pasi_w0  male bsa</span>
<span class="co">#&gt; 1 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      0      0       0  34 32.2    18.2  TRUE  18</span>
<span class="co">#&gt; 2 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      1      0       0  64 41.9    23.4  TRUE  33</span>
<span class="co">#&gt; 3 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      1      1       0  42 26.2    12.8  TRUE  33</span>
<span class="co">#&gt; 4 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      0      0       0  45 52.9    36.0 FALSE  50</span>
<span class="co">#&gt; 5 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      1      0       0  67 22.9    20.9 FALSE  35</span>
<span class="co">#&gt; 6 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      1      1       1  57 22.4    18.2  TRUE  29</span>
<span class="co">#&gt;   weight durnpso prevsys   psa</span>
<span class="co">#&gt; 1   98.1     6.7    TRUE  TRUE</span>
<span class="co">#&gt; 2  129.6    14.5   FALSE  TRUE</span>
<span class="co">#&gt; 3   78.0    26.5    TRUE FALSE</span>
<span class="co">#&gt; 4  139.9    25.0    TRUE  TRUE</span>
<span class="co">#&gt; 5   54.2    11.9    TRUE FALSE</span>
<span class="co">#&gt; 6   67.5    15.2    TRUE FALSE</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pso_agd</span><span class="op">)</span>
<span class="co">#&gt;    studyc          trtc_long    trtc trtn pasi75_r pasi75_n pasi90_r pasi90_n pasi100_r</span>
<span class="co">#&gt; 1 FIXTURE         Etanercept     ETN    4      142      323       67      323        14</span>
<span class="co">#&gt; 2 FIXTURE            Placebo     PBO    1       16      324        5      324         0</span>
<span class="co">#&gt; 3 FIXTURE Secukinumab 150 mg SEC_150    5      219      327      137      327        47</span>
<span class="co">#&gt; 4 FIXTURE Secukinumab 300 mg SEC_300    6      249      323      175      323        78</span>
<span class="co">#&gt;   pasi100_n sample_size_w0 age_mean age_sd bmi_mean bmi_sd pasi_w0_mean pasi_w0_sd male</span>
<span class="co">#&gt; 1       323            326     43.8   13.0     28.7    5.9         23.2        9.8 71.2</span>
<span class="co">#&gt; 2       324            326     44.1   12.6     27.9    6.1         24.1       10.5 72.7</span>
<span class="co">#&gt; 3       327            327     45.4   12.9     28.4    5.9         23.7       10.5 72.2</span>
<span class="co">#&gt; 4       323            327     44.5   13.2     28.4    6.4         23.9        9.9 68.5</span>
<span class="co">#&gt;   bsa_mean bsa_sd weight_mean weight_sd durnpso_mean durnpso_sd prevsys  psa</span>
<span class="co">#&gt; 1     33.6   18.0        84.6      20.5         16.4       12.0    65.6 13.5</span>
<span class="co">#&gt; 2     35.2   19.1        82.0      20.4         16.6       11.6    62.6 15.0</span>
<span class="co">#&gt; 3     34.5   19.4        83.6      20.8         17.3       12.2    64.8 15.0</span>
<span class="co">#&gt; 4     34.3   19.2        83.0      21.6         15.8       12.3    63.0 15.3</span></code></pre></div>
<p>We consider running a ML-NMR adjusting for five potential effect-modifying covariates: duration of psoriasis <code>durnpso</code>, weight <code>weight</code>, previous systemic treatment <code>prevsys</code>, body surface area <code>bsa</code>, and psoriatic arthritis <code>psa</code>.</p>
<div class="section level1">
<h1 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h1>
<div class="section level2">
<h2 id="preparing-the-data">Preparing the data<a class="anchor" aria-label="anchor" href="#preparing-the-data"></a>
</h2>
<p>We need to prepare the data so that it is in an acceptable format to run a ML-NMR model. Firstly, we need to handle the binary covariates <code>prevsys</code> and <code>psa</code>. In the IPD, these are coded as <code>TRUE</code> or <code>FALSE</code>, but in the AgD these are coded as percentages (out of 100). We need these to transform both of these sets of variables so that they are numeric and lie in the interval <span class="math inline">\([0,1]\)</span>, so that the variables are compatible across the data sources. Whilst we are here, we also transform body surface area <code>bsa</code> (a percentage) to lie in <span class="math inline">\([0,1]\)</span>, since that will make specifying an appropriate marginal distribution easier later, and rescale <code>weight</code> and <code>duration</code> to aid interpretation of the regression coefficients (in terms of 10 kilos and 10 years respectively). We also add in a <code>trtclass</code> variable, indicating which treatments belong to which classes. Finally, we check for missing values in the IPD.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pso_ipd</span> <span class="op">&lt;-</span> <span class="va">pso_ipd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="co"># Variable transformations</span>
         bsa <span class="op">=</span> <span class="va">bsa</span> <span class="op">/</span> <span class="fl">100</span>,
         prevsys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">prevsys</span><span class="op">)</span>,
         psa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">psa</span><span class="op">)</span>,
         weight <span class="op">=</span> <span class="va">weight</span> <span class="op">/</span> <span class="fl">10</span>,
         durnpso <span class="op">=</span> <span class="va">durnpso</span> <span class="op">/</span> <span class="fl">10</span>,
         <span class="co"># Treatment classes</span>
         trtclass <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">trtn</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Placebo"</span>,
                              <span class="va">trtn</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">~</span> <span class="st">"IL blocker"</span>,
                              <span class="va">trtn</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"TNFa blocker"</span><span class="op">)</span>,
         <span class="co"># Check complete cases for covariates of interest</span>
         complete <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">durnpso</span>, <span class="va">prevsys</span>, <span class="va">bsa</span>, <span class="va">weight</span>, <span class="va">psa</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">pso_agd</span> <span class="op">&lt;-</span> <span class="va">pso_agd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    <span class="co"># Variable transformations</span>
    bsa_mean <span class="op">=</span> <span class="va">bsa_mean</span> <span class="op">/</span> <span class="fl">100</span>,
    bsa_sd <span class="op">=</span> <span class="va">bsa_sd</span> <span class="op">/</span> <span class="fl">100</span>,
    prevsys <span class="op">=</span> <span class="va">prevsys</span> <span class="op">/</span> <span class="fl">100</span>,
    psa <span class="op">=</span> <span class="va">psa</span> <span class="op">/</span> <span class="fl">100</span>,
    weight_mean <span class="op">=</span> <span class="va">weight_mean</span> <span class="op">/</span> <span class="fl">10</span>,
    weight_sd <span class="op">=</span> <span class="va">weight_sd</span> <span class="op">/</span> <span class="fl">10</span>,
    durnpso_mean <span class="op">=</span> <span class="va">durnpso_mean</span> <span class="op">/</span> <span class="fl">10</span>,
    durnpso_sd <span class="op">=</span> <span class="va">durnpso_sd</span> <span class="op">/</span> <span class="fl">10</span>,
    <span class="co"># Treatment classes</span>
    trtclass <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">trtn</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Placebo"</span>,
                              <span class="va">trtn</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">~</span> <span class="st">"IL blocker"</span>,
                              <span class="va">trtn</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"TNFa blocker"</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>A small number of individuals have missing covariates:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">pso_ipd</span><span class="op">$</span><span class="va">complete</span><span class="op">)</span>
<span class="co">#&gt; [1] 4</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">!</span><span class="va">pso_ipd</span><span class="op">$</span><span class="va">complete</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.001036807</span></code></pre></div>
<p>Since the proportion of missing data is so small, we will simply exclude these individuals from the analysis.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pso_ipd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pso_ipd</span>, <span class="va">complete</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-the-network">Creating the network<a class="anchor" aria-label="anchor" href="#creating-the-network"></a>
</h2>
<p>Set up the network, setting the IPD with <code><a href="../reference/set_ipd.html">set_ipd()</a></code>, AgD (arm-based) with <code><a href="../reference/set_agd_arm.html">set_agd_arm()</a></code>, and combining together using <code><a href="../reference/combine_network.html">combine_network()</a></code>. We specify the binary <code>pasi75</code> outcome as <code>r</code> in the IPD, and the count outcome <code>pasi75_r</code> and denominator <code>pasi75_n</code> as <code>r</code> and <code>n</code> in the AgD. We specify the treatment classes with <code>trt_class = trtclass</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pso_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_network.html">combine_network</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/set_ipd.html">set_ipd</a></span><span class="op">(</span><span class="va">pso_ipd</span>, 
          study <span class="op">=</span> <span class="va">studyc</span>, 
          trt <span class="op">=</span> <span class="va">trtc</span>, 
          r <span class="op">=</span> <span class="va">pasi75</span>,
          trt_class <span class="op">=</span> <span class="va">trtclass</span><span class="op">)</span>,
  <span class="fu"><a href="../reference/set_agd_arm.html">set_agd_arm</a></span><span class="op">(</span><span class="va">pso_agd</span>, 
              study <span class="op">=</span> <span class="va">studyc</span>, 
              trt <span class="op">=</span> <span class="va">trtc</span>, 
              r <span class="op">=</span> <span class="va">pasi75_r</span>, 
              n <span class="op">=</span> <span class="va">pasi75_n</span>,
              trt_class <span class="op">=</span> <span class="va">trtclass</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">pso_net</span>
<span class="co">#&gt; A network with 3 IPD studies, and 1 AgD study (arm-based).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">-------------------------------------------------------------------</span> <span style="font-weight: bold;">IPD studies</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt;  Study     Treatments                      </span>
<span class="co">#&gt;  UNCOVER-1 3: IXE_Q2W | IXE_Q4W | PBO      </span>
<span class="co">#&gt;  UNCOVER-2 4: ETN | IXE_Q2W | IXE_Q4W | PBO</span>
<span class="co">#&gt;  UNCOVER-3 4: ETN | IXE_Q2W | IXE_Q4W | PBO</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Outcome type: binary</span>
<span class="co">#&gt; <span style="color: #555555;">-------------------------------------------------------</span> <span style="font-weight: bold;">AgD studies (arm-based)</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt;  Study   Treatments                      </span>
<span class="co">#&gt;  FIXTURE 4: ETN | PBO | SEC_150 | SEC_300</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Outcome type: count</span>
<span class="co">#&gt; <span style="color: #555555;">------------------------------------------------------------------------------------</span></span>
<span class="co">#&gt; Total number of treatments: 6, in 3 classes</span>
<span class="co">#&gt; Total number of studies: 4</span>
<span class="co">#&gt; Reference treatment is: PBO</span>
<span class="co">#&gt; Network is <span style="color: #00BB00;">connected</span></span></code></pre></div>
<p>We can produce a network plot with the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_net</span>, weight_nodes <span class="op">=</span> <span class="cn">TRUE</span>, weight_edges <span class="op">=</span> <span class="cn">TRUE</span>, show_trt_class <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.box <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_network_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="numerical-integration-for-ml-nmr">Numerical integration for ML-NMR<a class="anchor" aria-label="anchor" href="#numerical-integration-for-ml-nmr"></a>
</h2>
<p>ML-NMR models define the meta-regression model at the individual level, in exactly the same manner as a full-IPD meta-regression. ML-NMR then incorporates the AgD into the model by integrating this individual-level model over the covariate distribution in each AgD study <span class="citation">(Phillippo et al. 2020; Phillippo 2019)</span>. Using integration, instead of simply “plugging-in” mean covariate values for the AgD studies, avoids aggregation bias when the link function is not the identity function.</p>
<p>This package utilises numerical integration to incorporate the aggregate data - specifically, quasi-Monte Carlo (QMC) integration with a Gaussian copula <span class="citation">(Phillippo et al. 2020; Phillippo 2019)</span>. QMC integration is a very general and flexible integration approach, which typically requires far fewer integration points than standard (pseudo-random) Monte-Carlo integration to achieve the same numerical accuracy.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The convergence rate of QMC is typically &lt;span class="math inline"&gt;\(\mathcal{O}(1/n)\)&lt;/span&gt;, whereas the expected convergence rate of standard MC is &lt;span class="math inline"&gt;\(\mathcal{O}(1/n^\frac{1}{2})\)&lt;/span&gt; &lt;span class="citation"&gt;(Caflisch 1998; Niederreiter 1978)&lt;/span&gt;.&lt;/p&gt;'><sup>1</sup></a> A Gaussian copula allows us to account for correlations between covariates, which may have any specified marginal distributions.</p>
<p>We now set up the numerical integration for the network. The five covariates that we will consider adjusting for are body surface area <code>bsa</code>, duration of psoriasis <code>durnpso</code>, previous systemic treatment <code>prevsys</code>, psoriatic arthritis <code>psa</code>, and weight <code>weight</code>. We need to choose suitable marginal distributions for these covariates to draw the integration points from. <code>prevsys</code> and <code>psa</code> are binary covariates, so these are given a Bernoulli distribution. <code>bsa</code> is a percentage, so we choose a logit-Normal distribution (note, this requires the <code>logitnorm</code> package to be installed). We choose Gamma distributions for <code>durnpso</code> and <code>weight</code> to account for skewness. These choices seem to match well the marginal distributions observed in the IPD:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get mean and sd of covariates in each study</span>
<span class="va">ipd_summary</span> <span class="op">&lt;-</span> <span class="va">pso_ipd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">studyc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarise_at</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">weight</span>, <span class="va">durnpso</span>, <span class="va">bsa</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span>, min <span class="op">=</span> <span class="va">min</span>, max <span class="op">=</span> <span class="va">max</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">weight_mean</span><span class="op">:</span><span class="va">bsa_max</span>, names_sep <span class="op">=</span> <span class="st">"_"</span>, names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covariate"</span>, <span class="st">".value"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="co"># Assign distributions</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">covariate</span>,
                       bsa <span class="op">=</span> <span class="st">"dlogitnorm"</span>,
                       durnpso <span class="op">=</span> <span class="st">"dgamma"</span>,
                       weight <span class="op">=</span> <span class="st">"dgamma"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="co"># Compute density curves</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">studyc</span>, <span class="va">covariate</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"dlogitnorm"</span>,
                         <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">101</span><span class="op">)</span><span class="op">)</span>,
                         <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">min</span><span class="op">*</span><span class="fl">0.8</span>, <span class="va">max</span><span class="op">*</span><span class="fl">1.2</span>, length.out <span class="op">=</span> <span class="fl">101</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html" class="external-link">call</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">first</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">value</span>, mean <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">first</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">first</a></span><span class="op">(</span><span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Plot histograms and assumed densities</span>
<span class="va">pso_ipd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">weight</span>, <span class="va">durnpso</span>, <span class="va">bsa</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"covariate"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, 
                 binwidth <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/nclass.html" class="external-link">nclass.Sturges</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
                 boundary <span class="op">=</span> <span class="fl">0</span>,
                 fill <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">dens</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">ipd_summary</span>,
            colour <span class="op">=</span> <span class="st">"darkred"</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">studyc</span> <span class="op">+</span> <span class="va">covariate</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/theme_multinma.html">theme_multinma</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_covariate_plot-1.png" width="700" style="display: block; margin: auto;"></p>
<p>We add integration points to the AgD studies in the network using the <code><a href="../reference/add_integration.html">add_integration()</a></code> function. Marginal distributions for each covariate are specified using the <code><a href="../reference/distr.html">distr()</a></code> function, which takes a cumulative distribution function corresponding to the chosen marginal distribution, and arguments to that distribution as column names in the aggregate data. Since we do not know the correlations between covariates in the AgD studies, we impute these with the weighted mean of the correlations in the IPD studies (the default option).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pso_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_integration.html">add_integration</a></span><span class="op">(</span><span class="va">pso_net</span>,
  durnpso <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">durnpso_mean</span>, sd <span class="op">=</span> <span class="va">durnpso_sd</span><span class="op">)</span>,
  prevsys <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">prevsys</span><span class="op">)</span>,
  bsa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qlogitnorm</span>, mean <span class="op">=</span> <span class="va">bsa_mean</span>, sd <span class="op">=</span> <span class="va">bsa_sd</span><span class="op">)</span>,
  weight <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">weight_mean</span>, sd <span class="op">=</span> <span class="va">weight_sd</span><span class="op">)</span>,
  psa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">psa</span><span class="op">)</span>,
  n_int <span class="op">=</span> <span class="fl">1000</span>
<span class="op">)</span>
<span class="co">#&gt; Using weighted average correlation matrix computed from IPD studies.</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> This package provides several convenience functions for specifying these distributions, including <code><a href="../reference/GammaDist.html">qgamma()</a></code> which allows for a parameterisation of the Gamma distribution in terms of mean and standard deviation, <code><a href="../reference/Bernoulli.html">qbern()</a></code> which provides the Bernoulli distribution, and <code><a href="../reference/logitNormal.html">qlogitnorm()</a></code> which provides the logit-Normal distribution allowing for a parameterisation in terms of mean and standard deviation (requires the <code>logitnorm</code> package to be installed).</p>
</blockquote>
</div>
</div>
<div class="section level1">
<h1 id="ml-nmr-models">ML-NMR models<a class="anchor" aria-label="anchor" href="#ml-nmr-models"></a>
</h1>
<p>We fit both fixed effect (FE) and random effects (RE) ML-NMR models.</p>
<div class="section level2">
<h2 id="fixed-effect-ml-nmr">Fixed effect ML-NMR<a class="anchor" aria-label="anchor" href="#fixed-effect-ml-nmr"></a>
</h2>
<p>First, we fit a FE ML-NMR model using the function <code><a href="../reference/nma.html">nma()</a></code>. Following <span class="citation">(Phillippo et al. 2020)</span> we specify weakly-informative <span class="math inline">\(N(0, 10^2)\)</span> priors on each parameter. The range of parameter values implied by these prior distributions can be checked using the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; A Normal prior distribution: location = 0, scale = 10.</span>
<span class="co">#&gt; 50% of the prior density lies between -6.74 and 6.74.</span>
<span class="co">#&gt; 95% of the prior density lies between -19.6 and 19.6.</span></code></pre></div>
<p>The regression model is specified with <code>regression = ~(durnpso + prevsys + bsa + weight + psa)*.trt</code>, which will include the main (prognostic) effects of each covariate as well as interactions with treatment. We use a probit link function (<code>link = "probit"</code>), and specify that the two-parameter Binomial approximation for the aggregate-level likelihood should be used (<code>likelihood = "bernoulli2"</code>, where “bernoulli” refers to the individual-level likelihood, and “2” denotes the two-parameter adjustment to the aggregate-level likelihood) <span class="citation">(Phillippo et al. 2020)</span>. We utilise the shared effect modifier assumption to help identify the model, setting treatment-covariate interactions to be equal within each class (<code>class_interactions = "common"</code>). We narrow the possible range for random initial values with <code>init_r = 0.1</code> (the default is <code>init_r = 2</code>), since probit models in particular are often hard to initialise. Using the QR decomposition (<code>QR = TRUE</code>) greatly improves sampling efficiency here, as is often the case for regression models.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pso_fit_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">pso_net</span>, 
                  trt_effects <span class="op">=</span> <span class="st">"fixed"</span>,
                  link <span class="op">=</span> <span class="st">"probit"</span>, 
                  likelihood <span class="op">=</span> <span class="st">"bernoulli2"</span>,
                  regression <span class="op">=</span> <span class="op">~</span><span class="op">(</span><span class="va">durnpso</span> <span class="op">+</span> <span class="va">prevsys</span> <span class="op">+</span> <span class="va">bsa</span> <span class="op">+</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">psa</span><span class="op">)</span><span class="op">*</span><span class="va">.trt</span>,
                  class_interactions <span class="op">=</span> <span class="st">"common"</span>,
                  prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
                  prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
                  prior_reg <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
                  init_r <span class="op">=</span> <span class="fl">0.1</span>,
                  QR <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Note: Setting "PBO" as the network reference treatment.</span></code></pre></div>
<p>Basic parameter summaries are given by the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pso_fit_FE</span><span class="op">)</span>
<span class="co">#&gt; A fixed effects ML-NMR with a bernoulli2 likelihood (probit link).</span>
<span class="co">#&gt; Regression model: ~(durnpso + prevsys + bsa + weight + psa) * .trt.</span>
<span class="co">#&gt; Centred covariates at the following overall mean values:</span>
<span class="co">#&gt;   durnpso   prevsys       bsa    weight       psa </span>
<span class="co">#&gt; 1.8259772 0.6496080 0.2917665 8.9328237 0.2167777 </span>
<span class="co">#&gt; Inference for Stan model: binomial_2par.</span>
<span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span>
<span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                         mean se_mean   sd     2.5%      25%      50%      75%</span>
<span class="co">#&gt; beta[durnpso]                           0.04    0.00 0.06    -0.08     0.00     0.05     0.09</span>
<span class="co">#&gt; beta[prevsys]                          -0.13    0.00 0.16    -0.44    -0.24    -0.13    -0.03</span>
<span class="co">#&gt; beta[bsa]                              -0.06    0.01 0.45    -0.97    -0.36    -0.05     0.24</span>
<span class="co">#&gt; beta[weight]                            0.04    0.00 0.03    -0.02     0.02     0.04     0.06</span>
<span class="co">#&gt; beta[psa]                              -0.08    0.00 0.17    -0.41    -0.18    -0.07     0.04</span>
<span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]    -0.03    0.00 0.07    -0.17    -0.08    -0.03     0.02</span>
<span class="co">#&gt; beta[durnpso:.trtclassIL blocker]      -0.01    0.00 0.07    -0.14    -0.06    -0.01     0.03</span>
<span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]     0.18    0.00 0.18    -0.19     0.06     0.19     0.31</span>
<span class="co">#&gt; beta[prevsys:.trtclassIL blocker]       0.06    0.00 0.18    -0.29    -0.06     0.06     0.18</span>
<span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]         0.05    0.01 0.53    -0.94    -0.32     0.03     0.39</span>
<span class="co">#&gt; beta[bsa:.trtclassIL blocker]           0.29    0.01 0.49    -0.63    -0.05     0.28     0.60</span>
<span class="co">#&gt; beta[weight:.trtclassTNFa blocker]     -0.17    0.00 0.04    -0.24    -0.19    -0.17    -0.14</span>
<span class="co">#&gt; beta[weight:.trtclassIL blocker]       -0.10    0.00 0.03    -0.16    -0.12    -0.10    -0.08</span>
<span class="co">#&gt; beta[psa:.trtclassTNFa blocker]        -0.06    0.00 0.20    -0.46    -0.19    -0.06     0.08</span>
<span class="co">#&gt; beta[psa:.trtclassIL blocker]           0.01    0.00 0.18    -0.35    -0.12     0.00     0.13</span>
<span class="co">#&gt; d[ETN]                                  1.55    0.00 0.08     1.39     1.50     1.55     1.61</span>
<span class="co">#&gt; d[IXE_Q2W]                              2.95    0.00 0.09     2.78     2.89     2.95     3.02</span>
<span class="co">#&gt; d[IXE_Q4W]                              2.54    0.00 0.08     2.39     2.49     2.54     2.60</span>
<span class="co">#&gt; d[SEC_150]                              2.14    0.00 0.11     1.93     2.07     2.14     2.22</span>
<span class="co">#&gt; d[SEC_300]                              2.45    0.00 0.12     2.23     2.38     2.45     2.53</span>
<span class="co">#&gt; lp__                                -1576.40    0.09 3.42 -1583.72 -1578.55 -1576.06 -1573.98</span>
<span class="co">#&gt;                                        97.5% n_eff Rhat</span>
<span class="co">#&gt; beta[durnpso]                           0.16  5450    1</span>
<span class="co">#&gt; beta[prevsys]                           0.19  5288    1</span>
<span class="co">#&gt; beta[bsa]                               0.77  6205    1</span>
<span class="co">#&gt; beta[weight]                            0.09  5326    1</span>
<span class="co">#&gt; beta[psa]                               0.25  6489    1</span>
<span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]     0.11  5836    1</span>
<span class="co">#&gt; beta[durnpso:.trtclassIL blocker]       0.13  6500    1</span>
<span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]     0.54  5823    1</span>
<span class="co">#&gt; beta[prevsys:.trtclassIL blocker]       0.41  6662    1</span>
<span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]         1.08  6736    1</span>
<span class="co">#&gt; beta[bsa:.trtclassIL blocker]           1.29  7988    1</span>
<span class="co">#&gt; beta[weight:.trtclassTNFa blocker]     -0.09  6452    1</span>
<span class="co">#&gt; beta[weight:.trtclassIL blocker]       -0.03  6097    1</span>
<span class="co">#&gt; beta[psa:.trtclassTNFa blocker]         0.34  7036    1</span>
<span class="co">#&gt; beta[psa:.trtclassIL blocker]           0.37  6884    1</span>
<span class="co">#&gt; d[ETN]                                  1.71  3899    1</span>
<span class="co">#&gt; d[IXE_Q2W]                              3.12  4157    1</span>
<span class="co">#&gt; d[IXE_Q4W]                              2.70  4388    1</span>
<span class="co">#&gt; d[SEC_150]                              2.37  5817    1</span>
<span class="co">#&gt; d[SEC_300]                              2.68  6155    1</span>
<span class="co">#&gt; lp__                                -1570.59  1443    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Wed Dec  8 14:02:09 2021.</span>
<span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span>
<span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span>
<span class="co">#&gt; convergence, Rhat=1).</span></code></pre></div>
<p>By default, summaries of the study-specific intercepts <span class="math inline">\(\mu_j\)</span> are hidden, but could be examined by changing the <code>pars</code> argument:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Not run</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"beta"</span>, <span class="st">"mu"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The prior and posterior distributions can be compared visually using the <code><a href="../reference/plot_prior_posterior.html">plot_prior_posterior()</a></code> function:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_prior_posterior.html">plot_prior_posterior</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intercept"</span>, <span class="st">"trt"</span>, <span class="st">"reg"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_FE_pp_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Plots of estimated numerical integration error are produced using the <code><a href="../reference/plot_integration_error.html">plot_integration_error()</a></code> function:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_integration_error.html">plot_integration_error</a></span><span class="op">(</span><span class="va">pso_fit_FE</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_FE_cumint-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="random-effects-ml-nmr">Random effects ML-NMR<a class="anchor" aria-label="anchor" href="#random-effects-ml-nmr"></a>
</h2>
<p>We now fit a RE model. Again, we specify weakly-informative <span class="math inline">\(N(0, 10^2)\)</span> priors on each parameter, and now specify a <span class="math inline">\(\textrm{half-N}(0, 2.5^2)\)</span> prior for the heterogeneity standard deviation <span class="math inline">\(\tau\)</span>. The range of parameter values implied by these prior distributions can be checked using the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; A Normal prior distribution: location = 0, scale = 10.</span>
<span class="co">#&gt; 50% of the prior density lies between -6.74 and 6.74.</span>
<span class="co">#&gt; 95% of the prior density lies between -19.6 and 19.6.</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">half_normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; A half-Normal prior distribution: location = 0, scale = 2.5.</span>
<span class="co">#&gt; 50% of the prior density lies between 0 and 1.69.</span>
<span class="co">#&gt; 95% of the prior density lies between 0 and 4.9.</span></code></pre></div>
<p>Fitting the model uses the same call to <code><a href="../reference/nma.html">nma()</a></code> as before, except now with <code>trt_effects = "random"</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pso_fit_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">pso_net</span>, 
                  trt_effects <span class="op">=</span> <span class="st">"random"</span>,
                  link <span class="op">=</span> <span class="st">"probit"</span>, 
                  likelihood <span class="op">=</span> <span class="st">"bernoulli2"</span>,
                  regression <span class="op">=</span> <span class="op">~</span><span class="op">(</span><span class="va">durnpso</span> <span class="op">+</span> <span class="va">prevsys</span> <span class="op">+</span> <span class="va">bsa</span> <span class="op">+</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">psa</span><span class="op">)</span><span class="op">*</span><span class="va">.trt</span>,
                  class_interactions <span class="op">=</span> <span class="st">"common"</span>,
                  prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
                  prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
                  prior_reg <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
                  prior_het <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">half_normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>,
                  init_r <span class="op">=</span> <span class="fl">0.1</span>,
                  QR <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Note: Setting "PBO" as the network reference treatment.</span>
<span class="co">#&gt; Warning: There were 4 divergent transitions after warmup. See</span>
<span class="co">#&gt; http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span>
<span class="co">#&gt; to find out why this is a problem and how to eliminate them.</span>
<span class="co">#&gt; Warning: Examine the pairs() plot to diagnose sampling problems</span></code></pre></div>
<p>Basic parameter summaries are given by the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pso_fit_RE</span><span class="op">)</span>
<span class="co">#&gt; A random effects ML-NMR with a bernoulli2 likelihood (probit link).</span>
<span class="co">#&gt; Regression model: ~(durnpso + prevsys + bsa + weight + psa) * .trt.</span>
<span class="co">#&gt; Centred covariates at the following overall mean values:</span>
<span class="co">#&gt;   durnpso   prevsys       bsa    weight       psa </span>
<span class="co">#&gt; 1.8259772 0.6496080 0.2917665 8.9328237 0.2167777 </span>
<span class="co">#&gt; Inference for Stan model: binomial_2par.</span>
<span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span>
<span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                         mean se_mean   sd     2.5%      25%      50%      75%</span>
<span class="co">#&gt; beta[durnpso]                           0.05    0.00 0.06    -0.08     0.00     0.05     0.09</span>
<span class="co">#&gt; beta[prevsys]                          -0.12    0.00 0.16    -0.45    -0.24    -0.12    -0.01</span>
<span class="co">#&gt; beta[bsa]                              -0.09    0.01 0.45    -1.02    -0.39    -0.07     0.22</span>
<span class="co">#&gt; beta[weight]                            0.04    0.00 0.03    -0.02     0.02     0.04     0.06</span>
<span class="co">#&gt; beta[psa]                              -0.06    0.00 0.17    -0.41    -0.17    -0.06     0.05</span>
<span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]    -0.03    0.00 0.07    -0.17    -0.08    -0.03     0.02</span>
<span class="co">#&gt; beta[durnpso:.trtclassIL blocker]      -0.01    0.00 0.07    -0.15    -0.06    -0.02     0.03</span>
<span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]     0.18    0.00 0.19    -0.20     0.05     0.18     0.31</span>
<span class="co">#&gt; beta[prevsys:.trtclassIL blocker]       0.05    0.00 0.18    -0.31    -0.07     0.05     0.17</span>
<span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]         0.08    0.01 0.52    -0.90    -0.27     0.07     0.43</span>
<span class="co">#&gt; beta[bsa:.trtclassIL blocker]           0.33    0.01 0.49    -0.63    -0.02     0.32     0.65</span>
<span class="co">#&gt; beta[weight:.trtclassTNFa blocker]     -0.17    0.00 0.04    -0.24    -0.20    -0.17    -0.15</span>
<span class="co">#&gt; beta[weight:.trtclassIL blocker]       -0.10    0.00 0.03    -0.17    -0.12    -0.10    -0.08</span>
<span class="co">#&gt; beta[psa:.trtclassTNFa blocker]        -0.07    0.00 0.21    -0.49    -0.22    -0.07     0.07</span>
<span class="co">#&gt; beta[psa:.trtclassIL blocker]          -0.01    0.00 0.19    -0.38    -0.14    -0.02     0.11</span>
<span class="co">#&gt; d[ETN]                                  1.56    0.00 0.15     1.28     1.47     1.55     1.64</span>
<span class="co">#&gt; d[IXE_Q2W]                              2.98    0.00 0.15     2.69     2.89     2.97     3.06</span>
<span class="co">#&gt; d[IXE_Q4W]                              2.56    0.00 0.14     2.28     2.47     2.55     2.64</span>
<span class="co">#&gt; d[SEC_150]                              2.13    0.00 0.22     1.67     2.00     2.13     2.25</span>
<span class="co">#&gt; d[SEC_300]                              2.44    0.00 0.22     2.00     2.31     2.44     2.56</span>
<span class="co">#&gt; lp__                                -1580.48    0.14 4.77 -1590.54 -1583.67 -1580.21 -1577.04</span>
<span class="co">#&gt; tau                                     0.18    0.00 0.12     0.01     0.10     0.16     0.24</span>
<span class="co">#&gt;                                        97.5% n_eff Rhat</span>
<span class="co">#&gt; beta[durnpso]                           0.16  4412    1</span>
<span class="co">#&gt; beta[prevsys]                           0.20  3941    1</span>
<span class="co">#&gt; beta[bsa]                               0.77  2963    1</span>
<span class="co">#&gt; beta[weight]                            0.10  4261    1</span>
<span class="co">#&gt; beta[psa]                               0.27  3786    1</span>
<span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]     0.11  4425    1</span>
<span class="co">#&gt; beta[durnpso:.trtclassIL blocker]       0.11  4967    1</span>
<span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]     0.55  4309    1</span>
<span class="co">#&gt; beta[prevsys:.trtclassIL blocker]       0.39  4654    1</span>
<span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]         1.13  3432    1</span>
<span class="co">#&gt; beta[bsa:.trtclassIL blocker]           1.31  3237    1</span>
<span class="co">#&gt; beta[weight:.trtclassTNFa blocker]     -0.10  4936    1</span>
<span class="co">#&gt; beta[weight:.trtclassIL blocker]       -0.04  4884    1</span>
<span class="co">#&gt; beta[psa:.trtclassTNFa blocker]         0.33  4070    1</span>
<span class="co">#&gt; beta[psa:.trtclassIL blocker]           0.36  4260    1</span>
<span class="co">#&gt; d[ETN]                                  1.86  2189    1</span>
<span class="co">#&gt; d[IXE_Q2W]                              3.27  1915    1</span>
<span class="co">#&gt; d[IXE_Q4W]                              2.85  2085    1</span>
<span class="co">#&gt; d[SEC_150]                              2.56  2884    1</span>
<span class="co">#&gt; d[SEC_300]                              2.89  2263    1</span>
<span class="co">#&gt; lp__                                -1571.96  1226    1</span>
<span class="co">#&gt; tau                                     0.46   697    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Wed Dec  8 14:11:31 2021.</span>
<span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span>
<span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span>
<span class="co">#&gt; convergence, Rhat=1).</span></code></pre></div>
<p>By default, summaries of the study-specific intercepts <span class="math inline">\(\mu_j\)</span> and study-specific relative effects <span class="math inline">\(\delta_{jk}\)</span> are hidden, but could be examined by changing the <code>pars</code> argument:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Not run</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pso_fit_RE</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"beta"</span>, <span class="st">"tau"</span>, <span class="st">"mu"</span>, <span class="st">"delta"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>There are a number of divergent transitions, which we can investigate using the <code><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs()</a></code> method:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">pso_fit_RE</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"delta[UNCOVER-2: ETN]"</span>, <span class="st">"d[ETN]"</span>, <span class="st">"tau"</span>, <span class="st">"lp__"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_RE_pairs-1.png" width="700" style="display: block; margin: auto;"></p>
<p>The divergent transition errors (red crosses) seem to be concentrated in the upper tail of the heterogeneity standard deviation parameter. This suggests that the information to identify the heterogeneity parameter is weak - we have only four studies in the network - and that a more informative prior distribution might aid estimation.</p>
<p>The prior and posterior distributions can be compared visually using the <code><a href="../reference/plot_prior_posterior.html">plot_prior_posterior()</a></code> function:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_prior_posterior.html">plot_prior_posterior</a></span><span class="op">(</span><span class="va">pso_fit_RE</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intercept"</span>, <span class="st">"trt"</span>, <span class="st">"reg"</span>, <span class="st">"het"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_RE_pp_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Plots of estimated numerical integration error are produced using the <code><a href="../reference/plot_integration_error.html">plot_integration_error()</a></code> function:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_integration_error.html">plot_integration_error</a></span><span class="op">(</span><span class="va">pso_fit_RE</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_RE_cumint-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level1">
<h1 id="model-comparison">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h1>
<p>The model fit under the FE and RE models can be checked using the <code><a href="../reference/dic.html">dic()</a></code> function.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_dic_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">pso_fit_FE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Residual deviance: 3129.6<span style="color: #555555;"> (on 3858 data points)</span></span>
<span class="co">#&gt;                pD: 24.3</span>
<span class="co">#&gt;               DIC: 3153.9</span>
<span class="op">(</span><span class="va">pso_dic_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">pso_fit_RE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Residual deviance: 3123.9<span style="color: #555555;"> (on 3858 data points)</span></span>
<span class="co">#&gt;                pD: 28.1</span>
<span class="co">#&gt;               DIC: 3152</span></code></pre></div>
<p>The DIC is similar between the FE and RE models, suggesting that there is little evidence for any residual heterogeneity.</p>
</div>
<div class="section level1">
<h1 id="further-results">Further results<a class="anchor" aria-label="anchor" href="#further-results"></a>
</h1>
<p>Parameter estimates can be plotted using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method, for example to examine the estimated regression coefficients:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>,
     pars <span class="op">=</span> <span class="st">"beta"</span>,
     stat <span class="op">=</span> <span class="st">"halfeye"</span>,
     ref_line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/unnamed-chunk-20-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Plots of posterior summaries are based on the <code>ggdist</code> package, which allows a great degree of flexibility, and can be further customised using <code>ggplot2</code> commands. In the above command we specify a <code>"halfeye"</code> plot, which shows the posterior density along with posterior medians (points) and 95% Credible Intervals (thin line) with 66% inner bands (thicker line) by default. For more details on the plotting options see <code><a href="../reference/plot.nma_summary.html">?plot.nma_summary</a></code>.</p>
<p>We can produce population-adjusted relative effects for each study population in the network using the <code><a href="../reference/relative_effects.html">relative_effects()</a></code> function.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_releff_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relative_effects.html">relative_effects</a></span><span class="op">(</span><span class="va">pso_fit_FE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #555555;">----------------------------------------------------------------</span> <span style="font-weight: bold;">Study: FIXTURE</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.65    0.64 0.34   8.32 0.15</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                     mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; d[FIXTURE: ETN]     1.66 0.09 1.49 1.60 1.66 1.72  1.84     3563     2715    1</span>
<span class="co">#&gt; d[FIXTURE: IXE_Q2W] 3.03 0.10 2.84 2.96 3.03 3.10  3.22     3655     2873    1</span>
<span class="co">#&gt; d[FIXTURE: IXE_Q4W] 2.62 0.09 2.44 2.55 2.62 2.68  2.80     3918     3501    1</span>
<span class="co">#&gt; d[FIXTURE: SEC_150] 2.22 0.12 2.00 2.14 2.22 2.30  2.45     5342     3163    1</span>
<span class="co">#&gt; d[FIXTURE: SEC_300] 2.53 0.12 2.30 2.45 2.53 2.61  2.77     5667     3485    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-1</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;        2    0.73 0.28   9.24 0.28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; d[UNCOVER-1: ETN]     1.51 0.08 1.34 1.45 1.51 1.56  1.68     4277     3586    1</span>
<span class="co">#&gt; d[UNCOVER-1: IXE_Q2W] 2.92 0.09 2.75 2.86 2.92 2.98  3.09     4538     3524    1</span>
<span class="co">#&gt; d[UNCOVER-1: IXE_Q4W] 2.51 0.08 2.36 2.46 2.51 2.56  2.67     4730     3449    1</span>
<span class="co">#&gt; d[UNCOVER-1: SEC_150] 2.11 0.12 1.88 2.03 2.11 2.19  2.35     6082     3279    1</span>
<span class="co">#&gt; d[UNCOVER-1: SEC_300] 2.42 0.12 2.19 2.34 2.42 2.50  2.67     6431     3409    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-2</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.87    0.64 0.27   9.17 0.24</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; d[UNCOVER-2: ETN]     1.51 0.08 1.35 1.45 1.51 1.56  1.68     4453     3578    1</span>
<span class="co">#&gt; d[UNCOVER-2: IXE_Q2W] 2.92 0.09 2.75 2.86 2.92 2.98  3.09     4902     3207    1</span>
<span class="co">#&gt; d[UNCOVER-2: IXE_Q4W] 2.51 0.08 2.36 2.46 2.51 2.56  2.67     5281     3132    1</span>
<span class="co">#&gt; d[UNCOVER-2: SEC_150] 2.11 0.12 1.89 2.03 2.11 2.19  2.34     6210     3082    1</span>
<span class="co">#&gt; d[UNCOVER-2: SEC_300] 2.42 0.12 2.19 2.34 2.42 2.50  2.66     6618     3369    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-3</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight psa</span>
<span class="co">#&gt;     1.78    0.59 0.28   9.01 0.2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; d[UNCOVER-3: ETN]     1.53 0.08 1.37 1.47 1.53 1.58  1.69     4544     3476    1</span>
<span class="co">#&gt; d[UNCOVER-3: IXE_Q2W] 2.94 0.09 2.77 2.88 2.94 3.00  3.11     4734     3270    1</span>
<span class="co">#&gt; d[UNCOVER-3: IXE_Q4W] 2.53 0.08 2.38 2.47 2.53 2.58  2.68     5193     2986    1</span>
<span class="co">#&gt; d[UNCOVER-3: SEC_150] 2.13 0.11 1.91 2.05 2.13 2.21  2.36     6131     3010    1</span>
<span class="co">#&gt; d[UNCOVER-3: SEC_300] 2.44 0.12 2.21 2.36 2.44 2.52  2.67     6620     3228    1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_releff_FE</span>, ref_line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_releff_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Predicted probabilities of achieving PASI 75 in each study population on each treatment are produced using the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method. The argument <code>type = "reponse"</code> specifies that we want predicted probabilities, rather than probit probabilities.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_pred_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #555555;">----------------------------------------------------------------</span> <span style="font-weight: bold;">Study: FIXTURE</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                        mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; pred[FIXTURE: PBO]     0.04 0.01 0.03 0.04 0.04 0.05  0.06     4257     2997    1</span>
<span class="co">#&gt; pred[FIXTURE: ETN]     0.46 0.02 0.41 0.44 0.46 0.47  0.51     7777     3390    1</span>
<span class="co">#&gt; pred[FIXTURE: IXE_Q2W] 0.89 0.02 0.85 0.88 0.89 0.90  0.92     6690     3480    1</span>
<span class="co">#&gt; pred[FIXTURE: IXE_Q4W] 0.80 0.03 0.75 0.78 0.80 0.81  0.84     7343     3399    1</span>
<span class="co">#&gt; pred[FIXTURE: SEC_150] 0.67 0.03 0.62 0.65 0.67 0.69  0.72     9668     3050    1</span>
<span class="co">#&gt; pred[FIXTURE: SEC_300] 0.77 0.02 0.72 0.76 0.77 0.79  0.81    10076     3005    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-1</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; pred[UNCOVER-1: PBO]     0.06 0.01 0.04 0.05 0.06 0.06  0.08     5735     3289    1</span>
<span class="co">#&gt; pred[UNCOVER-1: ETN]     0.46 0.03 0.41 0.44 0.46 0.48  0.52     7588     3358    1</span>
<span class="co">#&gt; pred[UNCOVER-1: IXE_Q2W] 0.90 0.01 0.88 0.89 0.90 0.91  0.92     7649     2963    1</span>
<span class="co">#&gt; pred[UNCOVER-1: IXE_Q4W] 0.81 0.01 0.78 0.80 0.81 0.82  0.84     9920     3142    1</span>
<span class="co">#&gt; pred[UNCOVER-1: SEC_150] 0.69 0.04 0.60 0.66 0.69 0.72  0.76     7008     3341    1</span>
<span class="co">#&gt; pred[UNCOVER-1: SEC_300] 0.79 0.04 0.71 0.76 0.79 0.81  0.85     7431     3470    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-2</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; pred[UNCOVER-2: PBO]     0.05 0.01 0.03 0.04 0.05 0.05  0.06     5266     3004    1</span>
<span class="co">#&gt; pred[UNCOVER-2: ETN]     0.42 0.02 0.38 0.41 0.42 0.43  0.46     9173     3341    1</span>
<span class="co">#&gt; pred[UNCOVER-2: IXE_Q2W] 0.88 0.01 0.86 0.87 0.88 0.89  0.90     7350     3091    1</span>
<span class="co">#&gt; pred[UNCOVER-2: IXE_Q4W] 0.78 0.02 0.75 0.77 0.78 0.79  0.81     7792     2915    1</span>
<span class="co">#&gt; pred[UNCOVER-2: SEC_150] 0.65 0.04 0.57 0.62 0.65 0.68  0.73     7150     3074    1</span>
<span class="co">#&gt; pred[UNCOVER-2: SEC_300] 0.75 0.04 0.68 0.73 0.76 0.78  0.82     7001     3691    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-3</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; pred[UNCOVER-3: PBO]     0.08 0.01 0.06 0.07 0.08 0.08  0.10     6041     3252    1</span>
<span class="co">#&gt; pred[UNCOVER-3: ETN]     0.53 0.02 0.49 0.52 0.53 0.54  0.57     8236     3026    1</span>
<span class="co">#&gt; pred[UNCOVER-3: IXE_Q2W] 0.93 0.01 0.91 0.92 0.93 0.93  0.94     7771     3367    1</span>
<span class="co">#&gt; pred[UNCOVER-3: IXE_Q4W] 0.85 0.01 0.83 0.85 0.85 0.86  0.88     8762     2320    1</span>
<span class="co">#&gt; pred[UNCOVER-3: SEC_150] 0.75 0.03 0.68 0.72 0.75 0.77  0.81     7842     3074    1</span>
<span class="co">#&gt; pred[UNCOVER-3: SEC_300] 0.83 0.03 0.77 0.81 0.83 0.85  0.88     7528     3551    1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_pred_FE</span>, ref_line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_pred_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<p>We can produce population-adjusted ranks, rank probabilities, and cumulative rank probabilities in each study population using the <code><a href="../reference/posterior_ranks.html">posterior_ranks()</a></code> and <code><a href="../reference/posterior_ranks.html">posterior_rank_probs()</a></code> functions (although here the ranks are unchanged between populations, as the distributions of effect modifiers are similar). We specify <code>lower_better = FALSE</code>, since a higher outcome is better (higher chance of achieving PASI 75).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_ranks_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_ranks.html">posterior_ranks</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, lower_better <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #555555;">----------------------------------------------------------------</span> <span style="font-weight: bold;">Study: FIXTURE</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.65    0.64 0.34   8.32 0.15</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                        mean   sd 2.5% 25% 50% 75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; rank[FIXTURE: PBO]     6.00 0.00    6   6   6   6     6       NA       NA   NA</span>
<span class="co">#&gt; rank[FIXTURE: ETN]     5.00 0.00    5   5   5   5     5       NA       NA   NA</span>
<span class="co">#&gt; rank[FIXTURE: IXE_Q2W] 1.00 0.00    1   1   1   1     1       NA       NA   NA</span>
<span class="co">#&gt; rank[FIXTURE: IXE_Q4W] 2.24 0.43    2   2   2   2     3     4288       NA    1</span>
<span class="co">#&gt; rank[FIXTURE: SEC_150] 4.00 0.05    4   4   4   4     4     3513       NA    1</span>
<span class="co">#&gt; rank[FIXTURE: SEC_300] 2.76 0.43    2   3   3   3     3     4309     3513    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-1</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;        2    0.73 0.28   9.24 0.28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          mean   sd 2.5% 25% 50% 75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; rank[UNCOVER-1: PBO]     6.00 0.00    6   6   6   6     6       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-1: ETN]     5.00 0.00    5   5   5   5     5       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-1: IXE_Q2W] 1.00 0.00    1   1   1   1     1       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-1: IXE_Q4W] 2.24 0.43    2   2   2   2     3     4288       NA    1</span>
<span class="co">#&gt; rank[UNCOVER-1: SEC_150] 4.00 0.05    4   4   4   4     4     3513       NA    1</span>
<span class="co">#&gt; rank[UNCOVER-1: SEC_300] 2.76 0.43    2   3   3   3     3     4309     3513    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-2</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.87    0.64 0.27   9.17 0.24</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          mean   sd 2.5% 25% 50% 75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; rank[UNCOVER-2: PBO]     6.00 0.00    6   6   6   6     6       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-2: ETN]     5.00 0.00    5   5   5   5     5       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-2: IXE_Q2W] 1.00 0.00    1   1   1   1     1       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-2: IXE_Q4W] 2.24 0.43    2   2   2   2     3     4288       NA    1</span>
<span class="co">#&gt; rank[UNCOVER-2: SEC_150] 4.00 0.05    4   4   4   4     4     3513       NA    1</span>
<span class="co">#&gt; rank[UNCOVER-2: SEC_300] 2.76 0.43    2   3   3   3     3     4309     3513    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-3</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight psa</span>
<span class="co">#&gt;     1.78    0.59 0.28   9.01 0.2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          mean   sd 2.5% 25% 50% 75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; rank[UNCOVER-3: PBO]     6.00 0.00    6   6   6   6     6       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-3: ETN]     5.00 0.00    5   5   5   5     5       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-3: IXE_Q2W] 1.00 0.00    1   1   1   1     1       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-3: IXE_Q4W] 2.24 0.43    2   2   2   2     3     4288       NA    1</span>
<span class="co">#&gt; rank[UNCOVER-3: SEC_150] 4.00 0.05    4   4   4   4     4     3513       NA    1</span>
<span class="co">#&gt; rank[UNCOVER-3: SEC_300] 2.76 0.43    2   3   3   3     3     4309     3513    1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_ranks_FE</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_ranks_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_rankprobs_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_ranks.html">posterior_rank_probs</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, lower_better <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #555555;">----------------------------------------------------------------</span> <span style="font-weight: bold;">Study: FIXTURE</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.65    0.64 0.34   8.32 0.15</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                     p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[FIXTURE: PBO]             0      0.00      0.00         0         0         1</span>
<span class="co">#&gt; d[FIXTURE: ETN]             0      0.00      0.00         0         1         0</span>
<span class="co">#&gt; d[FIXTURE: IXE_Q2W]         1      0.00      0.00         0         0         0</span>
<span class="co">#&gt; d[FIXTURE: IXE_Q4W]         0      0.76      0.24         0         0         0</span>
<span class="co">#&gt; d[FIXTURE: SEC_150]         0      0.00      0.00         1         0         0</span>
<span class="co">#&gt; d[FIXTURE: SEC_300]         0      0.24      0.76         0         0         0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-1</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;        2    0.73 0.28   9.24 0.28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[UNCOVER-1: PBO]             0      0.00      0.00         0         0         1</span>
<span class="co">#&gt; d[UNCOVER-1: ETN]             0      0.00      0.00         0         1         0</span>
<span class="co">#&gt; d[UNCOVER-1: IXE_Q2W]         1      0.00      0.00         0         0         0</span>
<span class="co">#&gt; d[UNCOVER-1: IXE_Q4W]         0      0.76      0.24         0         0         0</span>
<span class="co">#&gt; d[UNCOVER-1: SEC_150]         0      0.00      0.00         1         0         0</span>
<span class="co">#&gt; d[UNCOVER-1: SEC_300]         0      0.24      0.76         0         0         0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-2</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.87    0.64 0.27   9.17 0.24</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[UNCOVER-2: PBO]             0      0.00      0.00         0         0         1</span>
<span class="co">#&gt; d[UNCOVER-2: ETN]             0      0.00      0.00         0         1         0</span>
<span class="co">#&gt; d[UNCOVER-2: IXE_Q2W]         1      0.00      0.00         0         0         0</span>
<span class="co">#&gt; d[UNCOVER-2: IXE_Q4W]         0      0.76      0.24         0         0         0</span>
<span class="co">#&gt; d[UNCOVER-2: SEC_150]         0      0.00      0.00         1         0         0</span>
<span class="co">#&gt; d[UNCOVER-2: SEC_300]         0      0.24      0.76         0         0         0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-3</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight psa</span>
<span class="co">#&gt;     1.78    0.59 0.28   9.01 0.2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[UNCOVER-3: PBO]             0      0.00      0.00         0         0         1</span>
<span class="co">#&gt; d[UNCOVER-3: ETN]             0      0.00      0.00         0         1         0</span>
<span class="co">#&gt; d[UNCOVER-3: IXE_Q2W]         1      0.00      0.00         0         0         0</span>
<span class="co">#&gt; d[UNCOVER-3: IXE_Q4W]         0      0.76      0.24         0         0         0</span>
<span class="co">#&gt; d[UNCOVER-3: SEC_150]         0      0.00      0.00         1         0         0</span>
<span class="co">#&gt; d[UNCOVER-3: SEC_300]         0      0.24      0.76         0         0         0</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_rankprobs_FE</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_rankprobs_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_cumrankprobs_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_ranks.html">posterior_rank_probs</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, lower_better <span class="op">=</span> <span class="cn">FALSE</span>, cumulative <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #555555;">----------------------------------------------------------------</span> <span style="font-weight: bold;">Study: FIXTURE</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.65    0.64 0.34   8.32 0.15</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                     p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[FIXTURE: PBO]             0      0.00         0         0         0         1</span>
<span class="co">#&gt; d[FIXTURE: ETN]             0      0.00         0         0         1         1</span>
<span class="co">#&gt; d[FIXTURE: IXE_Q2W]         1      1.00         1         1         1         1</span>
<span class="co">#&gt; d[FIXTURE: IXE_Q4W]         0      0.76         1         1         1         1</span>
<span class="co">#&gt; d[FIXTURE: SEC_150]         0      0.00         0         1         1         1</span>
<span class="co">#&gt; d[FIXTURE: SEC_300]         0      0.24         1         1         1         1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-1</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;        2    0.73 0.28   9.24 0.28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[UNCOVER-1: PBO]             0      0.00         0         0         0         1</span>
<span class="co">#&gt; d[UNCOVER-1: ETN]             0      0.00         0         0         1         1</span>
<span class="co">#&gt; d[UNCOVER-1: IXE_Q2W]         1      1.00         1         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-1: IXE_Q4W]         0      0.76         1         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-1: SEC_150]         0      0.00         0         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-1: SEC_300]         0      0.24         1         1         1         1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-2</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.87    0.64 0.27   9.17 0.24</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[UNCOVER-2: PBO]             0      0.00         0         0         0         1</span>
<span class="co">#&gt; d[UNCOVER-2: ETN]             0      0.00         0         0         1         1</span>
<span class="co">#&gt; d[UNCOVER-2: IXE_Q2W]         1      1.00         1         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-2: IXE_Q4W]         0      0.76         1         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-2: SEC_150]         0      0.00         0         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-2: SEC_300]         0      0.24         1         1         1         1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-3</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight psa</span>
<span class="co">#&gt;     1.78    0.59 0.28   9.01 0.2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[UNCOVER-3: PBO]             0      0.00         0         0         0         1</span>
<span class="co">#&gt; d[UNCOVER-3: ETN]             0      0.00         0         0         1         1</span>
<span class="co">#&gt; d[UNCOVER-3: IXE_Q2W]         1      1.00         1         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-3: IXE_Q4W]         0      0.76         1         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-3: SEC_150]         0      0.00         0         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-3: SEC_300]         0      0.24         1         1         1         1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_cumrankprobs_FE</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_cumrankprobs_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<p>All of the above estimates (relative effects, predictions, rankings) can also be produced for a specific target population or populations by providing a suitable <code>newdata</code> argument to for function (and a <code>baseline</code> distribution for <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>).</p>
<p>To produce population-adjusted relative effects (and corresponding rankings) for a chosen target population, we require only the mean covariate values in that population. For example, <code>newdata</code> could provide the following mean covariate values:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_agd_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
  bsa <span class="op">=</span> <span class="fl">0.6</span>,
  prevsys <span class="op">=</span> <span class="fl">0.1</span>,
  psa <span class="op">=</span> <span class="fl">0.2</span>,
  weight <span class="op">=</span> <span class="fl">10</span>,
  durnpso <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p>Population-adjusted relative effects in this target population are then calculated using the <code><a href="../reference/relative_effects.html">relative_effects()</a></code> function, and can be plotted with the corresponding <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_releff_FE_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relative_effects.html">relative_effects</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, newdata <span class="op">=</span> <span class="va">new_agd_means</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #555555;">------------------------------------------------------------------</span> <span style="font-weight: bold;">Study: New 1</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys bsa weight psa</span>
<span class="co">#&gt;        3     0.1 0.6     10 0.2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                   mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; d[New 1: ETN]     1.25 0.23 0.82 1.10 1.25 1.40  1.71     6705     3628    1</span>
<span class="co">#&gt; d[New 1: IXE_Q2W] 2.89 0.22 2.46 2.74 2.89 3.03  3.32     7539     3559    1</span>
<span class="co">#&gt; d[New 1: IXE_Q4W] 2.48 0.21 2.07 2.33 2.47 2.62  2.90     8350     3691    1</span>
<span class="co">#&gt; d[New 1: SEC_150] 2.08 0.22 1.66 1.93 2.08 2.22  2.52     7273     3755    1</span>
<span class="co">#&gt; d[New 1: SEC_300] 2.39 0.22 1.96 2.23 2.39 2.54  2.83     7671     3160    1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_releff_FE_new</span>, ref_line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_releff_FE_new-1.png" width="700" style="display: block; margin: auto;"></p>
<p>For absolute predictions, we require information about the full covariate distribution in the target population, not just the mean values. If IPD are available for the target population, <code>newdata</code> is simply a data frame of the IPD. If AgD are available for the target population, <code>newdata</code> must be a data frame with added integration points created using the <code><a href="../reference/add_integration.html">add_integration()</a></code> function.</p>
<p>For example, suppose the aggregate target population introduced above had the following covariate means and standard deviations (for continuous covariates) or proportions (for discrete covariates):</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_agd_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
  bsa_mean <span class="op">=</span> <span class="fl">0.6</span>,
  bsa_sd <span class="op">=</span> <span class="fl">0.3</span>,
  prevsys <span class="op">=</span> <span class="fl">0.1</span>,
  psa <span class="op">=</span> <span class="fl">0.2</span>,
  weight_mean <span class="op">=</span> <span class="fl">10</span>,
  weight_sd <span class="op">=</span> <span class="fl">1</span>,
  durnpso_mean <span class="op">=</span> <span class="fl">3</span>,
  durnpso_sd <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span></code></pre></div>
<p>We add integration points to this data frame in a similar manner to before. Again, we need to supply a correlation matrix for the joint covariate distribution; we use the same weighted mean correlation matrix computed earlier from the IPD in the network, which is stored in the network object as <code>int_cor</code>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_agd_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_integration.html">add_integration</a></span><span class="op">(</span><span class="va">new_agd_int</span>,
  durnpso <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">durnpso_mean</span>, sd <span class="op">=</span> <span class="va">durnpso_sd</span><span class="op">)</span>,
  prevsys <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">prevsys</span><span class="op">)</span>,
  bsa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qlogitnorm</span>, mean <span class="op">=</span> <span class="va">bsa_mean</span>, sd <span class="op">=</span> <span class="va">bsa_sd</span><span class="op">)</span>,
  weight <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">weight_mean</span>, sd <span class="op">=</span> <span class="va">weight_sd</span><span class="op">)</span>,
  psa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">psa</span><span class="op">)</span>,
  cor <span class="op">=</span> <span class="va">pso_net</span><span class="op">$</span><span class="va">int_cor</span>,
  n_int <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code></pre></div>
<p>Predicted probabilities of achieving PASI 75 in this target population, given a <span class="math inline">\(N(-1.75, 0.08^2)\)</span> distribution on the baseline probit-probability of response on Placebo (at the reference levels of the covariates), are then produced using the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_pred_FE_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, 
                            type <span class="op">=</span> <span class="st">"response"</span>,
                            newdata <span class="op">=</span> <span class="va">new_agd_int</span>,
                            baseline <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qnorm</span>, <span class="op">-</span><span class="fl">1.75</span>, <span class="fl">0.08</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #555555;">------------------------------------------------------------------</span> <span style="font-weight: bold;">Study: New 1</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                      mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; pred[New 1: PBO]     0.06 0.02 0.03 0.04 0.06 0.07  0.12     5548     3438    1</span>
<span class="co">#&gt; pred[New 1: ETN]     0.37 0.06 0.26 0.33 0.37 0.41  0.48     6059     3604    1</span>
<span class="co">#&gt; pred[New 1: IXE_Q2W] 0.90 0.03 0.84 0.88 0.90 0.92  0.94     4574     3352    1</span>
<span class="co">#&gt; pred[New 1: IXE_Q4W] 0.81 0.04 0.73 0.78 0.81 0.83  0.87     4640     3170    1</span>
<span class="co">#&gt; pred[New 1: SEC_150] 0.68 0.05 0.57 0.65 0.68 0.72  0.78     5291     3694    1</span>
<span class="co">#&gt; pred[New 1: SEC_300] 0.78 0.05 0.68 0.75 0.78 0.81  0.87     5577     3689    1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_pred_FE_new</span>, ref_line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_pred_FE_new-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level1 unnumbered">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<div id="refs" class="references">
<div id="ref-Caflisch1998">
<p>Caflisch, R. E. 1998. “Monte Carlo and Quasi-Monte Carlo Methods.” <em>Acta Numerica</em> 7: 1–49. <a href="https://doi.org/10.1017/S0962492900002804" class="external-link">https://doi.org/10.1017/S0962492900002804</a>.</p>
</div>
<div id="ref-Gordon2016">
<p>Gordon, K. B., A. Blauvelt, K. A. Papp, R. G. Langley, T. Luger, M. Ohtsuki, K. Reich, et al. 2016. “Phase 3 Trials of Ixekizumab in Moderate-to-Severe Plaque Psoriasis.” <em>New England Journal of Medicine</em> 375 (4): 345–56. <a href="https://doi.org/10.1056/nejmoa1512711" class="external-link">https://doi.org/10.1056/nejmoa1512711</a>.</p>
</div>
<div id="ref-Griffiths2015">
<p>Griffiths, C. E. M., K. Reich, M. Lebwohl, P. van de Kerkhof, C. Paul, A. Menter, G. S. Cameron, et al. 2015. “Comparison of Ixekizumab with Etanercept or Placebo in Moderate-to-Severe Psoriasis (UNCOVER-2 and UNCOVER-3): Results from Two Phase 3 Randomised Trials.” <em>The Lancet</em> 386 (9993): 541–51. <a href="https://doi.org/10.1016/s0140-6736(15)60125-8" class="external-link">https://doi.org/10.1016/s0140-6736(15)60125-8</a>.</p>
</div>
<div id="ref-Langley2014">
<p>Langley, R. G., B. E. Elewski, M. Lebwohl, K. Reich, C. E. M. Griffiths, K. Papp, L. Puig, et al. 2014. “Secukinumab in Plaque Psoriasis — Results of Two Phase 3 Trials.” <em>New England Journal of Medicine</em> 371 (4): 326–38. <a href="https://doi.org/10.1056/nejmoa1314258" class="external-link">https://doi.org/10.1056/nejmoa1314258</a>.</p>
</div>
<div id="ref-Niederreiter1978">
<p>Niederreiter, H. 1978. “Quasi-Monte Carlo Methods and Pseudo-Random Numbers.” <em>Bulletin of the American Mathematical Society</em> 84 (6): 957–1041. <a href="https://doi.org/10.1090/S0002-9904-1978-14532-7" class="external-link">https://doi.org/10.1090/S0002-9904-1978-14532-7</a>.</p>
</div>
<div id="ref-Phillippo_thesis">
<p>Phillippo, D. M. 2019. “Calibration of Treatment Effects in Network Meta-Analysis Using Individual Patient Data.” PhD thesis, University of Bristol.</p>
</div>
<div id="ref-methods_paper">
<p>Phillippo, D. M., S. Dias, A. E. Ades, M. Belger, A. Brnabic, A. Schacht, D. Saure, Z. Kadziola, and N. J. Welton. 2020. “Multilevel Network Meta-Regression for Population-Adjusted Treatment Comparisons.” <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em> 183 (3): 1189–1210. <a href="https://doi.org/10.1111/rssa.12579" class="external-link">https://doi.org/10.1111/rssa.12579</a>.</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by David M. Phillippo.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
