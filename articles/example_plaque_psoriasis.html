<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example: Plaque psoriasis ML-NMR • multinma</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Example: Plaque psoriasis ML-NMR">
<meta property="og:description" content="multinma">
<meta property="og:image" content="https://dmphillippo.github.io/multinma/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multinma</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette_overview.html">Overview of Examples</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Examples</li>
    <li>
      <a href="../articles/example_atrial_fibrillation.html">Example: Atrial fibrillation</a>
    </li>
    <li>
      <a href="../articles/example_bcg_vaccine.html">Example: BCG vaccine for tuberculosis</a>
    </li>
    <li>
      <a href="../articles/example_blocker.html">Example: Beta blockers</a>
    </li>
    <li>
      <a href="../articles/example_diabetes.html">Example: Diabetes</a>
    </li>
    <li>
      <a href="../articles/example_dietary_fat.html">Example: Dietary fat</a>
    </li>
    <li>
      <a href="../articles/example_hta_psoriasis.html">Example: Plaque psoriasis HTA report</a>
    </li>
    <li>
      <a href="../articles/example_parkinsons.html">Example: Parkinson's disease</a>
    </li>
    <li>
      <a href="../articles/example_plaque_psoriasis.html">Example: Plaque psoriasis ML-NMR</a>
    </li>
    <li>
      <a href="../articles/example_smoking.html">Example: Smoking cessation</a>
    </li>
    <li>
      <a href="../articles/example_statins.html">Example: Statins for cholesterol lowering</a>
    </li>
    <li>
      <a href="../articles/example_thrombolytics.html">Example: Thrombolytic treatments</a>
    </li>
    <li>
      <a href="../articles/example_transfusion.html">Example: White blood cell transfusion</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dmphillippo/multinma/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="example_plaque_psoriasis_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="example_plaque_psoriasis_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="example_plaque_psoriasis_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example: Plaque psoriasis ML-NMR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dmphillippo/multinma/blob/master/vignettes/example_plaque_psoriasis.Rmd"><code>vignettes/example_plaque_psoriasis.Rmd</code></a></small>
      <div class="hidden name"><code>example_plaque_psoriasis.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dmphillippo.github.io/multinma/">multinma</a></span><span class="op">)</span>
<span class="co">#&gt; For execution on a local, multicore CPU with excess RAM we recommend calling</span>
<span class="co">#&gt; options(mc.cores = parallel::detectCores())</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'multinma'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     dgamma, pgamma, qgamma</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>      <span class="co"># dplyr and tidyr for data manipulation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>    <span class="co"># ggplot2 for plotting covariate distributions</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Simulated individual patient data (IPD) from trials comparing treatments for plaque psoriasis are found in the data set <code>plaque_psoriasis_ipd</code>. Aggregate data (AgD) are available on a further set of trials, found in the data set <code>plaque_psoriasis_agd</code>. In this vignette, we recreate the multilevel network meta-regression (ML-NMR) analyses performed by <span class="citation">Phillippo et al. (2020; see also Phillippo 2019)</span>. We will analyse IPD from three studies, UNCOVER-1, UNCOVER-2, and UNCOVER-3 <span class="citation">(Griffiths et al. 2015; Gordon et al. 2016)</span>, and AgD from one study, FIXTURE <span class="citation">(Langley et al. 2014)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pso_ipd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">plaque_psoriasis_ipd</span>,
                  <span class="va">studyc</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UNCOVER-1"</span>, <span class="st">"UNCOVER-2"</span>, <span class="st">"UNCOVER-3"</span><span class="op">)</span><span class="op">)</span>

<span class="va">pso_agd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">plaque_psoriasis_agd</span>,
                  <span class="va">studyc</span> <span class="op">==</span> <span class="st">"FIXTURE"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pso_ipd</span><span class="op">)</span>
<span class="co">#&gt;      studyc      trtc_long    trtc trtn pasi75 pasi90 pasi100 age  bmi pasi_w0  male bsa weight</span>
<span class="co">#&gt; 1 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      0      0       0  34 32.2    18.2  TRUE  18   98.1</span>
<span class="co">#&gt; 2 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      1      0       0  64 41.9    23.4  TRUE  33  129.6</span>
<span class="co">#&gt; 3 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      1      1       0  42 26.2    12.8  TRUE  33   78.0</span>
<span class="co">#&gt; 4 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      0      0       0  45 52.9    36.0 FALSE  50  139.9</span>
<span class="co">#&gt; 5 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      1      0       0  67 22.9    20.9 FALSE  35   54.2</span>
<span class="co">#&gt; 6 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      1      1       1  57 22.4    18.2  TRUE  29   67.5</span>
<span class="co">#&gt;   durnpso prevsys   psa</span>
<span class="co">#&gt; 1     6.7    TRUE  TRUE</span>
<span class="co">#&gt; 2    14.5   FALSE  TRUE</span>
<span class="co">#&gt; 3    26.5    TRUE FALSE</span>
<span class="co">#&gt; 4    25.0    TRUE  TRUE</span>
<span class="co">#&gt; 5    11.9    TRUE FALSE</span>
<span class="co">#&gt; 6    15.2    TRUE FALSE</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pso_agd</span><span class="op">)</span>
<span class="co">#&gt;    studyc          trtc_long    trtc trtn pasi75_r pasi75_n pasi90_r pasi90_n pasi100_r pasi100_n</span>
<span class="co">#&gt; 1 FIXTURE         Etanercept     ETN    4      142      323       67      323        14       323</span>
<span class="co">#&gt; 2 FIXTURE            Placebo     PBO    1       16      324        5      324         0       324</span>
<span class="co">#&gt; 3 FIXTURE Secukinumab 150 mg SEC_150    5      219      327      137      327        47       327</span>
<span class="co">#&gt; 4 FIXTURE Secukinumab 300 mg SEC_300    6      249      323      175      323        78       323</span>
<span class="co">#&gt;   sample_size_w0 age_mean age_sd bmi_mean bmi_sd pasi_w0_mean pasi_w0_sd male bsa_mean bsa_sd</span>
<span class="co">#&gt; 1            326     43.8   13.0     28.7    5.9         23.2        9.8 71.2     33.6   18.0</span>
<span class="co">#&gt; 2            326     44.1   12.6     27.9    6.1         24.1       10.5 72.7     35.2   19.1</span>
<span class="co">#&gt; 3            327     45.4   12.9     28.4    5.9         23.7       10.5 72.2     34.5   19.4</span>
<span class="co">#&gt; 4            327     44.5   13.2     28.4    6.4         23.9        9.9 68.5     34.3   19.2</span>
<span class="co">#&gt;   weight_mean weight_sd durnpso_mean durnpso_sd prevsys  psa</span>
<span class="co">#&gt; 1        84.6      20.5         16.4       12.0    65.6 13.5</span>
<span class="co">#&gt; 2        82.0      20.4         16.6       11.6    62.6 15.0</span>
<span class="co">#&gt; 3        83.6      20.8         17.3       12.2    64.8 15.0</span>
<span class="co">#&gt; 4        83.0      21.6         15.8       12.3    63.0 15.3</span></code></pre></div>
<p>We consider running a ML-NMR adjusting for five potential effect-modifying covariates: duration of psoriasis <code>durnpso</code>, weight <code>weight</code>, previous systemic treatment <code>prevsys</code>, body surface area <code>bsa</code>, and psoriatic arthritis <code>psa</code>.</p>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<div id="preparing-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#preparing-the-data" class="anchor"></a>Preparing the data</h2>
<p>We need to prepare the data so that it is in an acceptable format to run a ML-NMR model. Firstly, we need to handle the binary covariates <code>prevsys</code> and <code>psa</code>. In the IPD, these are coded as <code>TRUE</code> or <code>FALSE</code>, but in the AgD these are coded as percentages (out of 100). We need these to transform both of these sets of variables so that they are numeric and lie in the interval <span class="math inline">\([0,1]\)</span>, so that the variables are compatible across the data sources. Whilst we are here, we also transform body surface area <code>bsa</code> (a percentage) to lie in <span class="math inline">\([0,1]\)</span>, since that will make specifying an appropriate marginal distribution easier later, and rescale <code>weight</code> and <code>duration</code> to aid interpretation of the regression coefficients (in terms of 10 kilos and 10 years respectively). We also add in a <code>trtclass</code> variable, indicating which treatments belong to which classes. Finally, we check for missing values in the IPD.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pso_ipd</span> <span class="op">&lt;-</span> <span class="va">pso_ipd</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="co"># Variable transformations</span>
         bsa <span class="op">=</span> <span class="va">bsa</span> <span class="op">/</span> <span class="fl">100</span>,
         prevsys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">prevsys</span><span class="op">)</span>,
         psa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">psa</span><span class="op">)</span>,
         weight <span class="op">=</span> <span class="va">weight</span> <span class="op">/</span> <span class="fl">10</span>,
         durnpso <span class="op">=</span> <span class="va">durnpso</span> <span class="op">/</span> <span class="fl">10</span>,
         <span class="co"># Treatment classes</span>
         trtclass <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">trtn</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Placebo"</span>,
                              <span class="va">trtn</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">~</span> <span class="st">"IL blocker"</span>,
                              <span class="va">trtn</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"TNFa blocker"</span><span class="op">)</span>,
         <span class="co"># Check complete cases for covariates of interest</span>
         complete <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">durnpso</span>, <span class="va">prevsys</span>, <span class="va">bsa</span>, <span class="va">weight</span>, <span class="va">psa</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">pso_agd</span> <span class="op">&lt;-</span> <span class="va">pso_agd</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    <span class="co"># Variable transformations</span>
    bsa_mean <span class="op">=</span> <span class="va">bsa_mean</span> <span class="op">/</span> <span class="fl">100</span>,
    bsa_sd <span class="op">=</span> <span class="va">bsa_sd</span> <span class="op">/</span> <span class="fl">100</span>,
    prevsys <span class="op">=</span> <span class="va">prevsys</span> <span class="op">/</span> <span class="fl">100</span>,
    psa <span class="op">=</span> <span class="va">psa</span> <span class="op">/</span> <span class="fl">100</span>,
    weight_mean <span class="op">=</span> <span class="va">weight_mean</span> <span class="op">/</span> <span class="fl">10</span>,
    weight_sd <span class="op">=</span> <span class="va">weight_sd</span> <span class="op">/</span> <span class="fl">10</span>,
    durnpso_mean <span class="op">=</span> <span class="va">durnpso_mean</span> <span class="op">/</span> <span class="fl">10</span>,
    durnpso_sd <span class="op">=</span> <span class="va">durnpso_sd</span> <span class="op">/</span> <span class="fl">10</span>,
    <span class="co"># Treatment classes</span>
    trtclass <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">trtn</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Placebo"</span>,
                              <span class="va">trtn</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">~</span> <span class="st">"IL blocker"</span>,
                              <span class="va">trtn</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"TNFa blocker"</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>A small number of individuals have missing covariates:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">pso_ipd</span><span class="op">$</span><span class="va">complete</span><span class="op">)</span>
<span class="co">#&gt; [1] 4</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">!</span><span class="va">pso_ipd</span><span class="op">$</span><span class="va">complete</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.001036807</span></code></pre></div>
<p>Since the proportion of missing data is so small, we will simply exclude these individuals from the analysis.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pso_ipd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">pso_ipd</span>, <span class="va">complete</span><span class="op">)</span></code></pre></div>
</div>
<div id="creating-the-network" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-the-network" class="anchor"></a>Creating the network</h2>
<p>Set up the network, setting the IPD with <code><a href="../reference/set_ipd.html">set_ipd()</a></code>, AgD (arm-based) with <code><a href="../reference/set_agd_arm.html">set_agd_arm()</a></code>, and combining together using <code><a href="../reference/combine_network.html">combine_network()</a></code>. We specify the binary <code>pasi75</code> outcome as <code>r</code> in the IPD, and the count outcome <code>pasi75_r</code> and denominator <code>pasi75_n</code> as <code>r</code> and <code>n</code> in the AgD. We specify the treatment classes with <code>trt_class = trtclass</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pso_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_network.html">combine_network</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/set_ipd.html">set_ipd</a></span><span class="op">(</span><span class="va">pso_ipd</span>, 
          study <span class="op">=</span> <span class="va">studyc</span>, 
          trt <span class="op">=</span> <span class="va">trtc</span>, 
          r <span class="op">=</span> <span class="va">pasi75</span>,
          trt_class <span class="op">=</span> <span class="va">trtclass</span><span class="op">)</span>,
  <span class="fu"><a href="../reference/set_agd_arm.html">set_agd_arm</a></span><span class="op">(</span><span class="va">pso_agd</span>, 
              study <span class="op">=</span> <span class="va">studyc</span>, 
              trt <span class="op">=</span> <span class="va">trtc</span>, 
              r <span class="op">=</span> <span class="va">pasi75_r</span>, 
              n <span class="op">=</span> <span class="va">pasi75_n</span>,
              trt_class <span class="op">=</span> <span class="va">trtclass</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">pso_net</span>
<span class="co">#&gt; A network with 3 IPD studies, and 1 AgD study (arm-based).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ------------------------------------------------------------------- IPD studies ---- </span>
<span class="co">#&gt;  Study     Treatments                      </span>
<span class="co">#&gt;  UNCOVER-1 3: IXE_Q2W | IXE_Q4W | PBO      </span>
<span class="co">#&gt;  UNCOVER-2 4: ETN | IXE_Q2W | IXE_Q4W | PBO</span>
<span class="co">#&gt;  UNCOVER-3 4: ETN | IXE_Q2W | IXE_Q4W | PBO</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Outcome type: binary</span>
<span class="co">#&gt; ------------------------------------------------------- AgD studies (arm-based) ---- </span>
<span class="co">#&gt;  Study   Treatments                      </span>
<span class="co">#&gt;  FIXTURE 4: ETN | PBO | SEC_150 | SEC_300</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Outcome type: count</span>
<span class="co">#&gt; ------------------------------------------------------------------------------------</span>
<span class="co">#&gt; Total number of treatments: 6, in 3 classes</span>
<span class="co">#&gt; Total number of studies: 4</span>
<span class="co">#&gt; Reference treatment is: PBO</span>
<span class="co">#&gt; Network is connected</span></code></pre></div>
<p>We can produce a network plot with the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> method:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pso_net</span>, weight_nodes <span class="op">=</span> <span class="cn">TRUE</span>, weight_edges <span class="op">=</span> <span class="cn">TRUE</span>, show_trt_class <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.box <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_network_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="numerical-integration-for-ml-nmr" class="section level2">
<h2 class="hasAnchor">
<a href="#numerical-integration-for-ml-nmr" class="anchor"></a>Numerical integration for ML-NMR</h2>
<p>ML-NMR models define the meta-regression model at the individual level, in exactly the same manner as a full-IPD meta-regression. ML-NMR then incorporates the AgD into the model by integrating this individual-level model over the covariate distribution in each AgD study <span class="citation">(Phillippo et al. 2020; Phillippo 2019)</span>. Using integration, instead of simply “plugging-in” mean covariate values for the AgD studies, avoids aggregation bias when the link function is not the identity function.</p>
<p>This package utilises numerical integration to incorporate the aggregate data - specifically, quasi-Monte Carlo (QMC) integration with a Gaussian copula <span class="citation">(Phillippo et al. 2020; Phillippo 2019)</span>. QMC integration is a very general and flexible integration approach, which typically requires far fewer integration points than standard (pseudo-random) Monte-Carlo integration to achieve the same numerical accuracy.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> A Gaussian copula allows us to account for correlations between covariates, which may have any specified marginal distributions.</p>
<p>We now set up the numerical integration for the network. The five covariates that we will consider adjusting for are body surface area <code>bsa</code>, duration of psoriasis <code>durnpso</code>, previous systemic treatment <code>prevsys</code>, psoriatic arthritis <code>psa</code>, and weight <code>weight</code>. We need to choose suitable marginal distributions for these covariates to draw the integration points from. <code>prevsys</code> and <code>psa</code> are binary covariates, so these are given a Bernoulli distribution. <code>bsa</code> is a percentage, so we choose a logit-Normal distribution. We choose Gamma distributions for <code>durnpso</code> and <code>weight</code> to account for skewness. These choices seem to match well the marginal distributions observed in the IPD:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get mean and sd of covariates in each study</span>
<span class="va">ipd_summary</span> <span class="op">&lt;-</span> <span class="va">pso_ipd</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">studyc</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_at</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">weight</span>, <span class="va">durnpso</span>, <span class="va">bsa</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span>, min <span class="op">=</span> <span class="va">min</span>, max <span class="op">=</span> <span class="va">max</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">weight_mean</span><span class="op">:</span><span class="va">bsa_max</span>, names_sep <span class="op">=</span> <span class="st">"_"</span>, names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"covariate"</span>, <span class="st">".value"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># Assign distributions</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">covariate</span>,
                       bsa <span class="op">=</span> <span class="st">"dlogitnorm"</span>,
                       durnpso <span class="op">=</span> <span class="st">"dgamma"</span>,
                       weight <span class="op">=</span> <span class="st">"dgamma"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># Compute density curves</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">studyc</span>, <span class="va">covariate</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"dlogitnorm"</span>,
                         <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">101</span><span class="op">)</span><span class="op">)</span>,
                         <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">min</span><span class="op">*</span><span class="fl">0.8</span>, <span class="va">max</span><span class="op">*</span><span class="fl">1.2</span>, length.out <span class="op">=</span> <span class="fl">101</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>dens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html">first</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, mean <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html">first</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html">first</a></span><span class="op">(</span><span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Plot histograms and assumed densities</span>
<span class="va">pso_ipd</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">weight</span>, <span class="va">durnpso</span>, <span class="va">bsa</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"covariate"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, 
                 binwidth <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/nclass.html">nclass.Sturges</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
                 boundary <span class="op">=</span> <span class="fl">0</span>,
                 fill <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">dens</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">ipd_summary</span>,
            colour <span class="op">=</span> <span class="st">"darkred"</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">studyc</span> <span class="op">+</span> <span class="va">covariate</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/theme_multinma.html">theme_multinma</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_covariate_plot-1.png" width="700" style="display: block; margin: auto;"></p>
<p>We add integration points to the AgD studies in the network using the <code><a href="../reference/add_integration.html">add_integration()</a></code> function. Marginal distributions for each covariate are specified using the <code><a href="../reference/distr.html">distr()</a></code> function, which takes a cumulative distribution function corresponding to the chosen marginal distribution, and arguments to that distribution as column names in the aggregate data. (Note: This package provides several convenience functions for specifying these distributions, including <code><a href="../reference/qgamma.html">qgamma()</a></code> which allows for a parameterisation of the Gamma distribution in terms of mean and standard deviation, <code><a href="../reference/qbern.html">qbern()</a></code> which provides the Bernoulli distribution, and <code><a href="../reference/qlogitnorm.html">qlogitnorm()</a></code> which provides the logit-Normal distribution allowing for a parameterisation in terms of mean and standard deviation.) Since we do not know the correlations between covariates in the AgD studies, we impute these with the weighted mean of the correlations in the IPD studies (the default option).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pso_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_integration.html">add_integration</a></span><span class="op">(</span><span class="va">pso_net</span>,
  durnpso <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">durnpso_mean</span>, sd <span class="op">=</span> <span class="va">durnpso_sd</span><span class="op">)</span>,
  prevsys <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">prevsys</span><span class="op">)</span>,
  bsa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qlogitnorm</span>, mean <span class="op">=</span> <span class="va">bsa_mean</span>, sd <span class="op">=</span> <span class="va">bsa_sd</span><span class="op">)</span>,
  weight <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">weight_mean</span>, sd <span class="op">=</span> <span class="va">weight_sd</span><span class="op">)</span>,
  psa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">psa</span><span class="op">)</span>,
  n_int <span class="op">=</span> <span class="fl">1000</span>
<span class="op">)</span>
<span class="co">#&gt; Using weighted average correlation matrix computed from IPD studies.</span></code></pre></div>
</div>
</div>
<div id="ml-nmr-models" class="section level1">
<h1 class="hasAnchor">
<a href="#ml-nmr-models" class="anchor"></a>ML-NMR models</h1>
<p>We fit both fixed effect (FE) and random effects (RE) ML-NMR models.</p>
<div id="fixed-effect-ml-nmr" class="section level2">
<h2 class="hasAnchor">
<a href="#fixed-effect-ml-nmr" class="anchor"></a>Fixed effect ML-NMR</h2>
<p>First, we fit a FE ML-NMR model using the function <code><a href="../reference/nma.html">nma()</a></code>. Following <span class="citation">(Phillippo et al. 2020)</span> we specify weakly-informative <span class="math inline">\(N(0, 10^2)\)</span> priors on each parameter. The range of parameter values implied by these prior distributions can be checked using the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> method:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; A Normal prior distribution: location = 0, scale = 10.</span>
<span class="co">#&gt; 50% of the prior density lies between -6.74 and 6.74.</span>
<span class="co">#&gt; 95% of the prior density lies between -19.6 and 19.6.</span></code></pre></div>
<p>The regression model is specified with <code>regression = ~(durnpso + prevsys + bsa + weight + psa)*.trt</code>, which will include the main (prognostic) effects of each covariate as well as interactions with treatment. We use a probit link function (<code>link = "probit"</code>), and specify that the two-parameter Binomial approximation for the aggregate-level likelihood should be used (<code>likelihood = "bernoulli2"</code>, where “bernoulli” refers to the individual-level likelihood, and “2” denotes the two-parameter adjustment to the aggregate-level likelihood) <span class="citation">(Phillippo et al. 2020)</span>. We utilise the shared effect modifier assumption to help identify the model, setting treatment-covariate interactions to be equal within each class (<code>class_interactions = "common"</code>). We narrow the possible range for random initial values with <code>init_r = 0.1</code> (the default is <code>init_r = 2</code>), since probit models in particular are often hard to initialise. Using the QR decomposition (<code>QR = TRUE</code>) greatly improves sampling efficiency here, as is often the case for regression models.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pso_fit_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">pso_net</span>, 
                  trt_effects <span class="op">=</span> <span class="st">"fixed"</span>,
                  link <span class="op">=</span> <span class="st">"probit"</span>, 
                  likelihood <span class="op">=</span> <span class="st">"bernoulli2"</span>,
                  regression <span class="op">=</span> <span class="op">~</span><span class="op">(</span><span class="va">durnpso</span> <span class="op">+</span> <span class="va">prevsys</span> <span class="op">+</span> <span class="va">bsa</span> <span class="op">+</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">psa</span><span class="op">)</span><span class="op">*</span><span class="va">.trt</span>,
                  class_interactions <span class="op">=</span> <span class="st">"common"</span>,
                  prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
                  prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
                  prior_reg <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
                  init_r <span class="op">=</span> <span class="fl">0.1</span>,
                  QR <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Note: Setting "PBO" as the network reference treatment.</span></code></pre></div>
<p>Basic parameter summaries are given by the <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> method:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">pso_fit_FE</span><span class="op">)</span>
<span class="co">#&gt; A fixed effects ML-NMR with a bernoulli2 likelihood (probit link).</span>
<span class="co">#&gt; Regression model: ~(durnpso + prevsys + bsa + weight + psa) * .trt.</span>
<span class="co">#&gt; Centred covariates at the following overall mean values:</span>
<span class="co">#&gt;   durnpso   prevsys       bsa    weight       psa </span>
<span class="co">#&gt; 1.8259772 0.6495432 0.2917678 8.9328063 0.2172823 </span>
<span class="co">#&gt; Inference for Stan model: binomial_2par.</span>
<span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span>
<span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                         mean se_mean   sd     2.5%      25%      50%      75%</span>
<span class="co">#&gt; beta[durnpso]                           0.04    0.00 0.06    -0.07     0.00     0.05     0.09</span>
<span class="co">#&gt; beta[prevsys]                          -0.13    0.00 0.16    -0.45    -0.24    -0.13    -0.03</span>
<span class="co">#&gt; beta[bsa]                              -0.05    0.01 0.45    -0.99    -0.33    -0.04     0.26</span>
<span class="co">#&gt; beta[weight]                            0.04    0.00 0.03    -0.02     0.02     0.04     0.06</span>
<span class="co">#&gt; beta[psa]                              -0.08    0.00 0.17    -0.42    -0.19    -0.08     0.04</span>
<span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]    -0.03    0.00 0.07    -0.18    -0.08    -0.03     0.02</span>
<span class="co">#&gt; beta[durnpso:.trtclassIL blocker]      -0.01    0.00 0.07    -0.14    -0.06    -0.01     0.03</span>
<span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]     0.18    0.00 0.18    -0.17     0.06     0.18     0.31</span>
<span class="co">#&gt; beta[prevsys:.trtclassIL blocker]       0.06    0.00 0.18    -0.28    -0.06     0.06     0.18</span>
<span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]         0.04    0.01 0.52    -0.95    -0.32     0.02     0.38</span>
<span class="co">#&gt; beta[bsa:.trtclassIL blocker]           0.27    0.01 0.49    -0.67    -0.07     0.26     0.59</span>
<span class="co">#&gt; beta[weight:.trtclassTNFa blocker]     -0.17    0.00 0.03    -0.24    -0.19    -0.17    -0.15</span>
<span class="co">#&gt; beta[weight:.trtclassIL blocker]       -0.10    0.00 0.03    -0.16    -0.12    -0.10    -0.08</span>
<span class="co">#&gt; beta[psa:.trtclassTNFa blocker]        -0.05    0.00 0.21    -0.47    -0.20    -0.06     0.09</span>
<span class="co">#&gt; beta[psa:.trtclassIL blocker]           0.01    0.00 0.19    -0.36    -0.12     0.01     0.13</span>
<span class="co">#&gt; d[ETN]                                  1.55    0.00 0.08     1.39     1.50     1.55     1.61</span>
<span class="co">#&gt; d[IXE_Q2W]                              2.95    0.00 0.09     2.78     2.89     2.95     3.01</span>
<span class="co">#&gt; d[IXE_Q4W]                              2.54    0.00 0.08     2.37     2.49     2.54     2.60</span>
<span class="co">#&gt; d[SEC_150]                              2.14    0.00 0.12     1.92     2.07     2.15     2.22</span>
<span class="co">#&gt; d[SEC_300]                              2.45    0.00 0.12     2.22     2.38     2.45     2.53</span>
<span class="co">#&gt; lp__                                -1576.51    0.09 3.55 -1584.54 -1578.59 -1576.10 -1573.98</span>
<span class="co">#&gt;                                        97.5% n_eff Rhat</span>
<span class="co">#&gt; beta[durnpso]                           0.16  6813    1</span>
<span class="co">#&gt; beta[prevsys]                           0.17  6368    1</span>
<span class="co">#&gt; beta[bsa]                               0.77  5862    1</span>
<span class="co">#&gt; beta[weight]                            0.10  5934    1</span>
<span class="co">#&gt; beta[psa]                               0.25  5486    1</span>
<span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]     0.12  7469    1</span>
<span class="co">#&gt; beta[durnpso:.trtclassIL blocker]       0.12  9045    1</span>
<span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]     0.55  6582    1</span>
<span class="co">#&gt; beta[prevsys:.trtclassIL blocker]       0.40  8210    1</span>
<span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]         1.09  6497    1</span>
<span class="co">#&gt; beta[bsa:.trtclassIL blocker]           1.30  6828    1</span>
<span class="co">#&gt; beta[weight:.trtclassTNFa blocker]     -0.10  6412    1</span>
<span class="co">#&gt; beta[weight:.trtclassIL blocker]       -0.04  6284    1</span>
<span class="co">#&gt; beta[psa:.trtclassTNFa blocker]         0.37  6479    1</span>
<span class="co">#&gt; beta[psa:.trtclassIL blocker]           0.38  6831    1</span>
<span class="co">#&gt; d[ETN]                                  1.71  5191    1</span>
<span class="co">#&gt; d[IXE_Q2W]                              3.13  6118    1</span>
<span class="co">#&gt; d[IXE_Q4W]                              2.71  6364    1</span>
<span class="co">#&gt; d[SEC_150]                              2.38  6818    1</span>
<span class="co">#&gt; d[SEC_300]                              2.68  7143    1</span>
<span class="co">#&gt; lp__                                -1570.66  1481    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Fri Dec  4 17:03:55 2020.</span>
<span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span>
<span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span>
<span class="co">#&gt; convergence, Rhat=1).</span></code></pre></div>
<p>By default, summaries of the study-specific intercepts <span class="math inline">\(\mu_j\)</span> are hidden, but could be examined by changing the <code>pars</code> argument:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Not run</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"beta"</span>, <span class="st">"mu"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The prior and posterior distributions can be compared visually using the <code><a href="../reference/plot_prior_posterior.html">plot_prior_posterior()</a></code> function:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_prior_posterior.html">plot_prior_posterior</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"intercept"</span>, <span class="st">"trt"</span>, <span class="st">"reg"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_FE_pp_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Plots of estimated numerical integration error are produced using the <code><a href="../reference/plot_integration_error.html">plot_integration_error()</a></code> function:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_integration_error.html">plot_integration_error</a></span><span class="op">(</span><span class="va">pso_fit_FE</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_FE_cumint-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="random-effects-ml-nmr" class="section level2">
<h2 class="hasAnchor">
<a href="#random-effects-ml-nmr" class="anchor"></a>Random effects ML-NMR</h2>
<p>We now fit a RE model. Again, we specify weakly-informative <span class="math inline">\(N(0, 10^2)\)</span> priors on each parameter, and now specify a <span class="math inline">\(\textrm{half-N}(0, 2.5^2)\)</span> prior for the heterogeneity standard deviation <span class="math inline">\(\tau\)</span>. The range of parameter values implied by these prior distributions can be checked using the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> method:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; A Normal prior distribution: location = 0, scale = 10.</span>
<span class="co">#&gt; 50% of the prior density lies between -6.74 and 6.74.</span>
<span class="co">#&gt; 95% of the prior density lies between -19.6 and 19.6.</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">half_normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; A half-Normal prior distribution: location = 0, scale = 2.5.</span>
<span class="co">#&gt; 50% of the prior density lies between 0 and 1.69.</span>
<span class="co">#&gt; 95% of the prior density lies between 0 and 4.9.</span></code></pre></div>
<p>Fitting the model uses the same call to <code><a href="../reference/nma.html">nma()</a></code> as before, except now with <code>trt_effects = "random"</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pso_fit_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">pso_net</span>, 
                  trt_effects <span class="op">=</span> <span class="st">"random"</span>,
                  link <span class="op">=</span> <span class="st">"probit"</span>, 
                  likelihood <span class="op">=</span> <span class="st">"bernoulli2"</span>,
                  regression <span class="op">=</span> <span class="op">~</span><span class="op">(</span><span class="va">durnpso</span> <span class="op">+</span> <span class="va">prevsys</span> <span class="op">+</span> <span class="va">bsa</span> <span class="op">+</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">psa</span><span class="op">)</span><span class="op">*</span><span class="va">.trt</span>,
                  class_interactions <span class="op">=</span> <span class="st">"common"</span>,
                  prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
                  prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
                  prior_reg <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
                  prior_het <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">half_normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>,
                  init_r <span class="op">=</span> <span class="fl">0.1</span>,
                  QR <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Note: Setting "PBO" as the network reference treatment.</span>
<span class="co">#&gt; Warning: There were 5 divergent transitions after warmup. See</span>
<span class="co">#&gt; http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span>
<span class="co">#&gt; to find out why this is a problem and how to eliminate them.</span>
<span class="co">#&gt; Warning: Examine the pairs() plot to diagnose sampling problems</span></code></pre></div>
<p>Basic parameter summaries are given by the <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> method:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">pso_fit_RE</span><span class="op">)</span>
<span class="co">#&gt; A random effects ML-NMR with a bernoulli2 likelihood (probit link).</span>
<span class="co">#&gt; Regression model: ~(durnpso + prevsys + bsa + weight + psa) * .trt.</span>
<span class="co">#&gt; Centred covariates at the following overall mean values:</span>
<span class="co">#&gt;   durnpso   prevsys       bsa    weight       psa </span>
<span class="co">#&gt; 1.8259772 0.6495432 0.2917678 8.9328063 0.2172823 </span>
<span class="co">#&gt; Inference for Stan model: binomial_2par.</span>
<span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span>
<span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                         mean se_mean   sd     2.5%      25%      50%      75%</span>
<span class="co">#&gt; beta[durnpso]                           0.05    0.00 0.06    -0.07     0.01     0.05     0.09</span>
<span class="co">#&gt; beta[prevsys]                          -0.12    0.00 0.16    -0.42    -0.23    -0.12    -0.02</span>
<span class="co">#&gt; beta[bsa]                              -0.10    0.01 0.45    -1.01    -0.40    -0.09     0.20</span>
<span class="co">#&gt; beta[weight]                            0.04    0.00 0.03    -0.01     0.02     0.04     0.06</span>
<span class="co">#&gt; beta[psa]                              -0.06    0.00 0.17    -0.39    -0.17    -0.06     0.06</span>
<span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]    -0.04    0.00 0.07    -0.18    -0.08    -0.04     0.01</span>
<span class="co">#&gt; beta[durnpso:.trtclassIL blocker]      -0.02    0.00 0.07    -0.15    -0.06    -0.02     0.03</span>
<span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]     0.18    0.00 0.19    -0.17     0.05     0.19     0.31</span>
<span class="co">#&gt; beta[prevsys:.trtclassIL blocker]       0.05    0.00 0.17    -0.29    -0.07     0.05     0.17</span>
<span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]         0.09    0.01 0.53    -0.93    -0.26     0.09     0.45</span>
<span class="co">#&gt; beta[bsa:.trtclassIL blocker]           0.34    0.01 0.50    -0.62     0.00     0.34     0.67</span>
<span class="co">#&gt; beta[weight:.trtclassTNFa blocker]     -0.17    0.00 0.04    -0.24    -0.20    -0.17    -0.15</span>
<span class="co">#&gt; beta[weight:.trtclassIL blocker]       -0.10    0.00 0.03    -0.17    -0.12    -0.10    -0.08</span>
<span class="co">#&gt; beta[psa:.trtclassTNFa blocker]        -0.07    0.00 0.20    -0.46    -0.21    -0.08     0.06</span>
<span class="co">#&gt; beta[psa:.trtclassIL blocker]          -0.01    0.00 0.19    -0.38    -0.14    -0.02     0.11</span>
<span class="co">#&gt; d[ETN]                                  1.56    0.00 0.15     1.26     1.47     1.56     1.64</span>
<span class="co">#&gt; d[IXE_Q2W]                              2.97    0.00 0.15     2.67     2.88     2.97     3.06</span>
<span class="co">#&gt; d[IXE_Q4W]                              2.56    0.00 0.15     2.27     2.47     2.56     2.64</span>
<span class="co">#&gt; d[SEC_150]                              2.13    0.00 0.23     1.66     2.00     2.13     2.27</span>
<span class="co">#&gt; d[SEC_300]                              2.45    0.00 0.23     1.97     2.32     2.44     2.58</span>
<span class="co">#&gt; lp__                                -1580.21    0.14 4.83 -1590.50 -1583.22 -1579.85 -1576.78</span>
<span class="co">#&gt; tau                                     0.19    0.00 0.12     0.02     0.11     0.17     0.25</span>
<span class="co">#&gt;                                        97.5% n_eff Rhat</span>
<span class="co">#&gt; beta[durnpso]                           0.17  5145    1</span>
<span class="co">#&gt; beta[prevsys]                           0.18  5596    1</span>
<span class="co">#&gt; beta[bsa]                               0.77  4694    1</span>
<span class="co">#&gt; beta[weight]                            0.10  5015    1</span>
<span class="co">#&gt; beta[psa]                               0.26  5108    1</span>
<span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]     0.11  5503    1</span>
<span class="co">#&gt; beta[durnpso:.trtclassIL blocker]       0.11  5601    1</span>
<span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]     0.54  4889    1</span>
<span class="co">#&gt; beta[prevsys:.trtclassIL blocker]       0.37  6285    1</span>
<span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]         1.14  4780    1</span>
<span class="co">#&gt; beta[bsa:.trtclassIL blocker]           1.34  5312    1</span>
<span class="co">#&gt; beta[weight:.trtclassTNFa blocker]     -0.10  5526    1</span>
<span class="co">#&gt; beta[weight:.trtclassIL blocker]       -0.04  4991    1</span>
<span class="co">#&gt; beta[psa:.trtclassTNFa blocker]         0.32  5221    1</span>
<span class="co">#&gt; beta[psa:.trtclassIL blocker]           0.37  5896    1</span>
<span class="co">#&gt; d[ETN]                                  1.87  1392    1</span>
<span class="co">#&gt; d[IXE_Q2W]                              3.30  1884    1</span>
<span class="co">#&gt; d[IXE_Q4W]                              2.87  1326    1</span>
<span class="co">#&gt; d[SEC_150]                              2.59  2326    1</span>
<span class="co">#&gt; d[SEC_300]                              2.94  2676    1</span>
<span class="co">#&gt; lp__                                -1571.75  1218    1</span>
<span class="co">#&gt; tau                                     0.49   775    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Fri Dec  4 17:10:38 2020.</span>
<span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span>
<span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span>
<span class="co">#&gt; convergence, Rhat=1).</span></code></pre></div>
<p>By default, summaries of the study-specific intercepts <span class="math inline">\(\mu_j\)</span> and study-specific relative effects <span class="math inline">\(\delta_{jk}\)</span> are hidden, but could be examined by changing the <code>pars</code> argument:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Not run</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">pso_fit_RE</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"beta"</span>, <span class="st">"tau"</span>, <span class="st">"mu"</span>, <span class="st">"delta"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>There are a number of divergent transitions, which we can investigate using the <code><a href="https://rdrr.io/r/graphics/pairs.html">pairs()</a></code> method:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">pso_fit_RE</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"delta[UNCOVER-2: ETN]"</span>, <span class="st">"d[ETN]"</span>, <span class="st">"tau"</span>, <span class="st">"lp__"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_RE_pairs-1.png" width="700" style="display: block; margin: auto;"></p>
<p>The divergent transition errors (red crosses) seem to be concentrated in the upper tail of the heterogeneity standard deviation parameter. This suggests that the information to identify the heterogeneity parameter is weak - we have only four studies in the network - and that a more informative prior distribution might aid estimation.</p>
<p>The prior and posterior distributions can be compared visually using the <code><a href="../reference/plot_prior_posterior.html">plot_prior_posterior()</a></code> function:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_prior_posterior.html">plot_prior_posterior</a></span><span class="op">(</span><span class="va">pso_fit_RE</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"intercept"</span>, <span class="st">"trt"</span>, <span class="st">"reg"</span>, <span class="st">"het"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_RE_pp_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Plots of estimated numerical integration error are produced using the <code><a href="../reference/plot_integration_error.html">plot_integration_error()</a></code> function:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_integration_error.html">plot_integration_error</a></span><span class="op">(</span><span class="va">pso_fit_RE</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_RE_cumint-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="model-comparison" class="section level1">
<h1 class="hasAnchor">
<a href="#model-comparison" class="anchor"></a>Model comparison</h1>
<p>The model fit under the FE and RE models can be checked using the <code><a href="../reference/dic.html">dic()</a></code> function.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_dic_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">pso_fit_FE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Residual deviance: 3129.8 (on 3858 data points)</span>
<span class="co">#&gt;                pD: 24.4</span>
<span class="co">#&gt;               DIC: 3154.3</span>
<span class="op">(</span><span class="va">pso_dic_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">pso_fit_RE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Residual deviance: 3123.5 (on 3858 data points)</span>
<span class="co">#&gt;                pD: 28.3</span>
<span class="co">#&gt;               DIC: 3151.8</span></code></pre></div>
<p>The DIC is similar between the FE and RE models, suggesting that there is little evidence for any residual heterogeneity.</p>
</div>
<div id="further-results" class="section level1">
<h1 class="hasAnchor">
<a href="#further-results" class="anchor"></a>Further results</h1>
<p>Parameter estimates can be plotted using the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> method, for example to examine the estimated regression coefficients:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>,
     pars <span class="op">=</span> <span class="st">"beta"</span>,
     stat <span class="op">=</span> <span class="st">"halfeye"</span>,
     ref_line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/unnamed-chunk-20-1.png" width="700" style="display: block; margin: auto;"></p>
<p>We can produce population-adjusted relative effects for each study population in the network using the <code><a href="../reference/relative_effects.html">relative_effects()</a></code> function.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_releff_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relative_effects.html">relative_effects</a></span><span class="op">(</span><span class="va">pso_fit_FE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ---------------------------------------------------------------- Study: FIXTURE ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.65    0.64 0.34   8.32 0.15</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                     mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; d[FIXTURE: ETN]     1.66 0.09 1.49 1.60 1.66 1.72  1.84     4257     3196    1</span>
<span class="co">#&gt; d[FIXTURE: IXE_Q2W] 3.03 0.10 2.83 2.96 3.03 3.10  3.23     5425     2918    1</span>
<span class="co">#&gt; d[FIXTURE: IXE_Q4W] 2.62 0.10 2.42 2.55 2.62 2.68  2.81     5810     2937    1</span>
<span class="co">#&gt; d[FIXTURE: SEC_150] 2.22 0.12 1.99 2.14 2.22 2.30  2.46     5857     3087    1</span>
<span class="co">#&gt; d[FIXTURE: SEC_300] 2.53 0.12 2.29 2.45 2.53 2.61  2.77     6415     3320    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-1 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;        2    0.73 0.28   9.24 0.28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; d[UNCOVER-1: ETN]     1.51 0.08 1.34 1.45 1.51 1.56  1.67     5903     3532    1</span>
<span class="co">#&gt; d[UNCOVER-1: IXE_Q2W] 2.92 0.09 2.75 2.86 2.92 2.98  3.10     6510     2988    1</span>
<span class="co">#&gt; d[UNCOVER-1: IXE_Q4W] 2.51 0.08 2.34 2.45 2.51 2.57  2.68     6626     2796    1</span>
<span class="co">#&gt; d[UNCOVER-1: SEC_150] 2.11 0.12 1.88 2.03 2.11 2.19  2.35     7319     3243    1</span>
<span class="co">#&gt; d[UNCOVER-1: SEC_300] 2.42 0.12 2.18 2.34 2.42 2.50  2.66     7502     2947    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-2 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.87    0.64 0.27   9.17 0.24</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; d[UNCOVER-2: ETN]     1.51 0.08 1.35 1.45 1.51 1.56  1.66     6037     3495    1</span>
<span class="co">#&gt; d[UNCOVER-2: IXE_Q2W] 2.92 0.09 2.75 2.86 2.92 2.98  3.09     6431     2910    1</span>
<span class="co">#&gt; d[UNCOVER-2: IXE_Q4W] 2.51 0.08 2.35 2.46 2.51 2.56  2.67     6672     2850    1</span>
<span class="co">#&gt; d[UNCOVER-2: SEC_150] 2.11 0.12 1.88 2.03 2.11 2.19  2.35     7313     3270    1</span>
<span class="co">#&gt; d[UNCOVER-2: SEC_300] 2.42 0.12 2.19 2.34 2.42 2.50  2.66     7377     3216    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-3 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight psa</span>
<span class="co">#&gt;     1.78    0.59 0.28   9.01 0.2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; d[UNCOVER-3: ETN]     1.53 0.08 1.37 1.48 1.53 1.58  1.68     5657     3522    1</span>
<span class="co">#&gt; d[UNCOVER-3: IXE_Q2W] 2.94 0.09 2.77 2.88 2.94 3.00  3.11     6208     3027    1</span>
<span class="co">#&gt; d[UNCOVER-3: IXE_Q4W] 2.53 0.08 2.36 2.47 2.53 2.58  2.69     6561     2827    1</span>
<span class="co">#&gt; d[UNCOVER-3: SEC_150] 2.13 0.12 1.90 2.05 2.13 2.21  2.36     7040     3136    1</span>
<span class="co">#&gt; d[UNCOVER-3: SEC_300] 2.44 0.12 2.21 2.36 2.44 2.52  2.67     7169     3135    1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pso_releff_FE</span>, ref_line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_releff_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Predicted probabilities of achieving PASI 75 in each study population on each treatment are produced using the <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> method. The argument <code>type = "reponse"</code> specifies that we want predicted probabilities, rather than probit probabilities.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_pred_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ---------------------------------------------------------------- Study: FIXTURE ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                        mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; pred[FIXTURE: PBO]     0.04 0.01 0.03 0.04 0.04 0.05  0.06     4996     3126    1</span>
<span class="co">#&gt; pred[FIXTURE: ETN]     0.46 0.02 0.41 0.44 0.46 0.47  0.51     7783     2905    1</span>
<span class="co">#&gt; pred[FIXTURE: IXE_Q2W] 0.89 0.02 0.85 0.88 0.89 0.90  0.92     8993     2961    1</span>
<span class="co">#&gt; pred[FIXTURE: IXE_Q4W] 0.80 0.03 0.74 0.78 0.80 0.81  0.85     8499     3128    1</span>
<span class="co">#&gt; pred[FIXTURE: SEC_150] 0.67 0.03 0.62 0.65 0.67 0.69  0.72     9949     2690    1</span>
<span class="co">#&gt; pred[FIXTURE: SEC_300] 0.77 0.02 0.72 0.76 0.77 0.79  0.81     9523     2540    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-1 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; pred[UNCOVER-1: PBO]     0.06 0.01 0.04 0.05 0.06 0.06  0.08     8575     2768    1</span>
<span class="co">#&gt; pred[UNCOVER-1: ETN]     0.46 0.03 0.40 0.44 0.46 0.48  0.52     9939     3219    1</span>
<span class="co">#&gt; pred[UNCOVER-1: IXE_Q2W] 0.90 0.01 0.88 0.89 0.90 0.91  0.92     9052     2851    1</span>
<span class="co">#&gt; pred[UNCOVER-1: IXE_Q4W] 0.81 0.02 0.78 0.80 0.81 0.82  0.84     9654     3189    1</span>
<span class="co">#&gt; pred[UNCOVER-1: SEC_150] 0.69 0.04 0.60 0.66 0.69 0.72  0.76     8849     3230    1</span>
<span class="co">#&gt; pred[UNCOVER-1: SEC_300] 0.79 0.04 0.71 0.76 0.79 0.81  0.85     8965     3415    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-2 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; pred[UNCOVER-2: PBO]     0.05 0.01 0.03 0.04 0.05 0.05  0.06     7109     3063    1</span>
<span class="co">#&gt; pred[UNCOVER-2: ETN]     0.42 0.02 0.38 0.41 0.42 0.43  0.46     9907     2617    1</span>
<span class="co">#&gt; pred[UNCOVER-2: IXE_Q2W] 0.88 0.01 0.86 0.87 0.88 0.89  0.91     7635     2956    1</span>
<span class="co">#&gt; pred[UNCOVER-2: IXE_Q4W] 0.78 0.02 0.75 0.77 0.78 0.79  0.81     9856     3134    1</span>
<span class="co">#&gt; pred[UNCOVER-2: SEC_150] 0.65 0.04 0.56 0.62 0.65 0.68  0.73     8689     3494    1</span>
<span class="co">#&gt; pred[UNCOVER-2: SEC_300] 0.75 0.04 0.68 0.73 0.76 0.78  0.82     8456     3073    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-3 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; pred[UNCOVER-3: PBO]     0.08 0.01 0.06 0.07 0.08 0.08  0.10     6622     2811    1</span>
<span class="co">#&gt; pred[UNCOVER-3: ETN]     0.53 0.02 0.49 0.52 0.53 0.54  0.57    10545     3423    1</span>
<span class="co">#&gt; pred[UNCOVER-3: IXE_Q2W] 0.93 0.01 0.91 0.92 0.93 0.93  0.94     8024     3220    1</span>
<span class="co">#&gt; pred[UNCOVER-3: IXE_Q4W] 0.85 0.01 0.83 0.85 0.85 0.86  0.88     9059     3283    1</span>
<span class="co">#&gt; pred[UNCOVER-3: SEC_150] 0.75 0.03 0.67 0.72 0.75 0.77  0.81     8223     3285    1</span>
<span class="co">#&gt; pred[UNCOVER-3: SEC_300] 0.83 0.03 0.77 0.81 0.83 0.85  0.88     8150     2929    1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pso_pred_FE</span>, ref_line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_pred_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<p>We can produce population-adjusted ranks, rank probabilities, and cumulative rank probabilities in each study population using the <code><a href="../reference/posterior_ranks.html">posterior_ranks()</a></code> and <code><a href="../reference/posterior_ranks.html">posterior_rank_probs()</a></code> functions. We specify <code>lower_better = FALSE</code>, since a higher outcome is better (higher chance of achieving PASI 75).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_ranks_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_ranks.html">posterior_ranks</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, lower_better <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ---------------------------------------------------------------- Study: FIXTURE ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.65    0.64 0.34   8.32 0.15</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                        mean   sd 2.5% 25% 50% 75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; rank[FIXTURE: PBO]     6.00 0.00    6   6   6   6     6       NA       NA   NA</span>
<span class="co">#&gt; rank[FIXTURE: ETN]     5.00 0.00    5   5   5   5     5       NA       NA   NA</span>
<span class="co">#&gt; rank[FIXTURE: IXE_Q2W] 1.00 0.00    1   1   1   1     1       NA       NA   NA</span>
<span class="co">#&gt; rank[FIXTURE: IXE_Q4W] 2.25 0.43    2   2   2   2     3     4209     4024    1</span>
<span class="co">#&gt; rank[FIXTURE: SEC_150] 4.00 0.04    4   4   4   4     4     4029       NA    1</span>
<span class="co">#&gt; rank[FIXTURE: SEC_300] 2.76 0.43    2   3   3   3     3     4352     4018    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-1 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;        2    0.73 0.28   9.24 0.28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          mean   sd 2.5% 25% 50% 75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; rank[UNCOVER-1: PBO]     6.00 0.00    6   6   6   6     6       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-1: ETN]     5.00 0.00    5   5   5   5     5       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-1: IXE_Q2W] 1.00 0.00    1   1   1   1     1       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-1: IXE_Q4W] 2.25 0.43    2   2   2   2     3     4209     4024    1</span>
<span class="co">#&gt; rank[UNCOVER-1: SEC_150] 4.00 0.04    4   4   4   4     4     4029       NA    1</span>
<span class="co">#&gt; rank[UNCOVER-1: SEC_300] 2.76 0.43    2   3   3   3     3     4352     4018    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-2 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.87    0.64 0.27   9.17 0.24</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          mean   sd 2.5% 25% 50% 75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; rank[UNCOVER-2: PBO]     6.00 0.00    6   6   6   6     6       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-2: ETN]     5.00 0.00    5   5   5   5     5       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-2: IXE_Q2W] 1.00 0.00    1   1   1   1     1       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-2: IXE_Q4W] 2.25 0.43    2   2   2   2     3     4209     4024    1</span>
<span class="co">#&gt; rank[UNCOVER-2: SEC_150] 4.00 0.04    4   4   4   4     4     4029       NA    1</span>
<span class="co">#&gt; rank[UNCOVER-2: SEC_300] 2.76 0.43    2   3   3   3     3     4352     4018    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-3 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight psa</span>
<span class="co">#&gt;     1.78    0.59 0.28   9.01 0.2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          mean   sd 2.5% 25% 50% 75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; rank[UNCOVER-3: PBO]     6.00 0.00    6   6   6   6     6       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-3: ETN]     5.00 0.00    5   5   5   5     5       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-3: IXE_Q2W] 1.00 0.00    1   1   1   1     1       NA       NA   NA</span>
<span class="co">#&gt; rank[UNCOVER-3: IXE_Q4W] 2.25 0.43    2   2   2   2     3     4209     4024    1</span>
<span class="co">#&gt; rank[UNCOVER-3: SEC_150] 4.00 0.04    4   4   4   4     4     4029       NA    1</span>
<span class="co">#&gt; rank[UNCOVER-3: SEC_300] 2.76 0.43    2   3   3   3     3     4352     4018    1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pso_ranks_FE</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_ranks_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_rankprobs_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_ranks.html">posterior_rank_probs</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, lower_better <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ---------------------------------------------------------------- Study: FIXTURE ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.65    0.64 0.34   8.32 0.15</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                     p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[FIXTURE: PBO]             0      0.00      0.00         0         0         1</span>
<span class="co">#&gt; d[FIXTURE: ETN]             0      0.00      0.00         0         1         0</span>
<span class="co">#&gt; d[FIXTURE: IXE_Q2W]         1      0.00      0.00         0         0         0</span>
<span class="co">#&gt; d[FIXTURE: IXE_Q4W]         0      0.76      0.24         0         0         0</span>
<span class="co">#&gt; d[FIXTURE: SEC_150]         0      0.00      0.00         1         0         0</span>
<span class="co">#&gt; d[FIXTURE: SEC_300]         0      0.24      0.75         0         0         0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-1 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;        2    0.73 0.28   9.24 0.28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[UNCOVER-1: PBO]             0      0.00      0.00         0         0         1</span>
<span class="co">#&gt; d[UNCOVER-1: ETN]             0      0.00      0.00         0         1         0</span>
<span class="co">#&gt; d[UNCOVER-1: IXE_Q2W]         1      0.00      0.00         0         0         0</span>
<span class="co">#&gt; d[UNCOVER-1: IXE_Q4W]         0      0.76      0.24         0         0         0</span>
<span class="co">#&gt; d[UNCOVER-1: SEC_150]         0      0.00      0.00         1         0         0</span>
<span class="co">#&gt; d[UNCOVER-1: SEC_300]         0      0.24      0.75         0         0         0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-2 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.87    0.64 0.27   9.17 0.24</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[UNCOVER-2: PBO]             0      0.00      0.00         0         0         1</span>
<span class="co">#&gt; d[UNCOVER-2: ETN]             0      0.00      0.00         0         1         0</span>
<span class="co">#&gt; d[UNCOVER-2: IXE_Q2W]         1      0.00      0.00         0         0         0</span>
<span class="co">#&gt; d[UNCOVER-2: IXE_Q4W]         0      0.76      0.24         0         0         0</span>
<span class="co">#&gt; d[UNCOVER-2: SEC_150]         0      0.00      0.00         1         0         0</span>
<span class="co">#&gt; d[UNCOVER-2: SEC_300]         0      0.24      0.75         0         0         0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-3 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight psa</span>
<span class="co">#&gt;     1.78    0.59 0.28   9.01 0.2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[UNCOVER-3: PBO]             0      0.00      0.00         0         0         1</span>
<span class="co">#&gt; d[UNCOVER-3: ETN]             0      0.00      0.00         0         1         0</span>
<span class="co">#&gt; d[UNCOVER-3: IXE_Q2W]         1      0.00      0.00         0         0         0</span>
<span class="co">#&gt; d[UNCOVER-3: IXE_Q4W]         0      0.76      0.24         0         0         0</span>
<span class="co">#&gt; d[UNCOVER-3: SEC_150]         0      0.00      0.00         1         0         0</span>
<span class="co">#&gt; d[UNCOVER-3: SEC_300]         0      0.24      0.75         0         0         0</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pso_rankprobs_FE</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_rankprobs_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_cumrankprobs_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_ranks.html">posterior_rank_probs</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, lower_better <span class="op">=</span> <span class="cn">FALSE</span>, cumulative <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ---------------------------------------------------------------- Study: FIXTURE ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.65    0.64 0.34   8.32 0.15</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                     p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[FIXTURE: PBO]             0      0.00         0         0         0         1</span>
<span class="co">#&gt; d[FIXTURE: ETN]             0      0.00         0         0         1         1</span>
<span class="co">#&gt; d[FIXTURE: IXE_Q2W]         1      1.00         1         1         1         1</span>
<span class="co">#&gt; d[FIXTURE: IXE_Q4W]         0      0.76         1         1         1         1</span>
<span class="co">#&gt; d[FIXTURE: SEC_150]         0      0.00         0         1         1         1</span>
<span class="co">#&gt; d[FIXTURE: SEC_300]         0      0.24         1         1         1         1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-1 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;        2    0.73 0.28   9.24 0.28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[UNCOVER-1: PBO]             0      0.00         0         0         0         1</span>
<span class="co">#&gt; d[UNCOVER-1: ETN]             0      0.00         0         0         1         1</span>
<span class="co">#&gt; d[UNCOVER-1: IXE_Q2W]         1      1.00         1         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-1: IXE_Q4W]         0      0.76         1         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-1: SEC_150]         0      0.00         0         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-1: SEC_300]         0      0.24         1         1         1         1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-2 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span>
<span class="co">#&gt;     1.87    0.64 0.27   9.17 0.24</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[UNCOVER-2: PBO]             0      0.00         0         0         0         1</span>
<span class="co">#&gt; d[UNCOVER-2: ETN]             0      0.00         0         0         1         1</span>
<span class="co">#&gt; d[UNCOVER-2: IXE_Q2W]         1      1.00         1         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-2: IXE_Q4W]         0      0.76         1         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-2: SEC_150]         0      0.00         0         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-2: SEC_300]         0      0.24         1         1         1         1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: UNCOVER-3 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys  bsa weight psa</span>
<span class="co">#&gt;     1.78    0.59 0.28   9.01 0.2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span>
<span class="co">#&gt; d[UNCOVER-3: PBO]             0      0.00         0         0         0         1</span>
<span class="co">#&gt; d[UNCOVER-3: ETN]             0      0.00         0         0         1         1</span>
<span class="co">#&gt; d[UNCOVER-3: IXE_Q2W]         1      1.00         1         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-3: IXE_Q4W]         0      0.76         1         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-3: SEC_150]         0      0.00         0         1         1         1</span>
<span class="co">#&gt; d[UNCOVER-3: SEC_300]         0      0.24         1         1         1         1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pso_cumrankprobs_FE</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_cumrankprobs_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<p>All of the above estimates (relative effects, predictions, rankings) can also be produced for a specific target population or populations by providing a suitable <code>newdata</code> argument to for function (and a <code>baseline</code> distribution for <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code>).</p>
<p>To produce population-adjusted relative effects (and corresponding rankings) for a chosen target population, we require only the mean covariate values in that population. For example, <code>newdata</code> could provide the following mean covariate values:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_agd_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
  bsa <span class="op">=</span> <span class="fl">0.6</span>,
  prevsys <span class="op">=</span> <span class="fl">0.1</span>,
  psa <span class="op">=</span> <span class="fl">0.2</span>,
  weight <span class="op">=</span> <span class="fl">10</span>,
  durnpso <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p>Population-adjusted relative effects in this target population are then calculated using the <code><a href="../reference/relative_effects.html">relative_effects()</a></code> function, and can be plotted with the corresponding <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> method:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_releff_FE_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relative_effects.html">relative_effects</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, newdata <span class="op">=</span> <span class="va">new_agd_means</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ------------------------------------------------------------------ Study: New 1 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  durnpso prevsys bsa weight psa</span>
<span class="co">#&gt;        3     0.1 0.6     10 0.2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                   mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; d[New 1: ETN]     1.25 0.22 0.82 1.10 1.24 1.40  1.71     7043     2931    1</span>
<span class="co">#&gt; d[New 1: IXE_Q2W] 2.88 0.22 2.46 2.73 2.88 3.03  3.33     7523     3290    1</span>
<span class="co">#&gt; d[New 1: IXE_Q4W] 2.47 0.22 2.04 2.32 2.47 2.62  2.91     8028     3356    1</span>
<span class="co">#&gt; d[New 1: SEC_150] 2.07 0.22 1.65 1.92 2.07 2.22  2.53     7418     3142    1</span>
<span class="co">#&gt; d[New 1: SEC_300] 2.38 0.22 1.95 2.23 2.37 2.53  2.84     7411     3169    1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pso_releff_FE_new</span>, ref_line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_releff_FE_new-1.png" width="700" style="display: block; margin: auto;"></p>
<p>For absolute predictions, we require information about the full covariate distribution in the target population, not just the mean values. If IPD are available for the target population, <code>newdata</code> is simply a data frame of the IPD. If AgD are available for the target population, <code>newdata</code> must be a data frame with added integration points created using the <code><a href="../reference/add_integration.html">add_integration()</a></code> function.</p>
<p>For example, suppose the aggregate target population introduced above had the following covariate means and standard deviations (for continuous covariates) or proportions (for discrete covariates):</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_agd_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
  bsa_mean <span class="op">=</span> <span class="fl">0.6</span>,
  bsa_sd <span class="op">=</span> <span class="fl">0.3</span>,
  prevsys <span class="op">=</span> <span class="fl">0.1</span>,
  psa <span class="op">=</span> <span class="fl">0.2</span>,
  weight_mean <span class="op">=</span> <span class="fl">10</span>,
  weight_sd <span class="op">=</span> <span class="fl">1</span>,
  durnpso_mean <span class="op">=</span> <span class="fl">3</span>,
  durnpso_sd <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span></code></pre></div>
<p>We add integration points to this data frame in a similar manner to before. Again, we need to supply a correlation matrix for the joint covariate distribution; we use the same weighted mean correlation matrix computed earlier from the IPD in the network, which is stored in the network object as <code>int_cor</code>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_agd_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_integration.html">add_integration</a></span><span class="op">(</span><span class="va">new_agd_int</span>,
  durnpso <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">durnpso_mean</span>, sd <span class="op">=</span> <span class="va">durnpso_sd</span><span class="op">)</span>,
  prevsys <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">prevsys</span><span class="op">)</span>,
  bsa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qlogitnorm</span>, mean <span class="op">=</span> <span class="va">bsa_mean</span>, sd <span class="op">=</span> <span class="va">bsa_sd</span><span class="op">)</span>,
  weight <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">weight_mean</span>, sd <span class="op">=</span> <span class="va">weight_sd</span><span class="op">)</span>,
  psa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">psa</span><span class="op">)</span>,
  cor <span class="op">=</span> <span class="va">pso_net</span><span class="op">$</span><span class="va">int_cor</span>,
  n_int <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code></pre></div>
<p>Predicted probabilities of achieving PASI 75 in this target population, given a <span class="math inline">\(N(-1.75, 0.08^2)\)</span> distribution on the baseline probit-probability of response on Placebo (at the reference levels of the covariates), are then produced using the <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> method:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">pso_pred_FE_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, 
                            type <span class="op">=</span> <span class="st">"response"</span>,
                            newdata <span class="op">=</span> <span class="va">new_agd_int</span>,
                            baseline <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qnorm</span>, <span class="op">-</span><span class="fl">1.75</span>, <span class="fl">0.08</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ------------------------------------------------------------------ Study: New 1 ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                      mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; pred[New 1: PBO]     0.06 0.03 0.03 0.04 0.06 0.07  0.12     5709     3373    1</span>
<span class="co">#&gt; pred[New 1: ETN]     0.37 0.06 0.26 0.33 0.37 0.41  0.48     6565     3584    1</span>
<span class="co">#&gt; pred[New 1: IXE_Q2W] 0.90 0.03 0.84 0.88 0.90 0.92  0.94     6588     3498    1</span>
<span class="co">#&gt; pred[New 1: IXE_Q4W] 0.81 0.04 0.72 0.78 0.81 0.83  0.87     5894     3633    1</span>
<span class="co">#&gt; pred[New 1: SEC_150] 0.68 0.06 0.56 0.64 0.68 0.72  0.79     6255     3230    1</span>
<span class="co">#&gt; pred[New 1: SEC_300] 0.78 0.05 0.67 0.75 0.78 0.81  0.86     6573     3405    1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pso_pred_FE_new</span>, ref_line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_pred_FE_new-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Caflisch1998">
<p>Caflisch, R. E. 1998. “Monte Carlo and Quasi-Monte Carlo Methods.” <em>Acta Numerica</em> 7: 1–49. <a href="https://doi.org/10.1017/S0962492900002804">https://doi.org/10.1017/S0962492900002804</a>.</p>
</div>
<div id="ref-Gordon2016">
<p>Gordon, K. B., A. Blauvelt, K. A. Papp, R. G. Langley, T. Luger, M. Ohtsuki, K. Reich, et al. 2016. “Phase 3 Trials of Ixekizumab in Moderate-to-Severe Plaque Psoriasis.” <em>New England Journal of Medicine</em> 375 (4): 345–56. <a href="https://doi.org/10.1056/nejmoa1512711">https://doi.org/10.1056/nejmoa1512711</a>.</p>
</div>
<div id="ref-Griffiths2015">
<p>Griffiths, C. E. M., K. Reich, M. Lebwohl, P. van de Kerkhof, C. Paul, A. Menter, G. S. Cameron, et al. 2015. “Comparison of Ixekizumab with Etanercept or Placebo in Moderate-to-Severe Psoriasis (UNCOVER-2 and UNCOVER-3): Results from Two Phase 3 Randomised Trials.” <em>The Lancet</em> 386 (9993): 541–51. <a href="https://doi.org/10.1016/s0140-6736(15)60125-8">https://doi.org/10.1016/s0140-6736(15)60125-8</a>.</p>
</div>
<div id="ref-Langley2014">
<p>Langley, R. G., B. E. Elewski, M. Lebwohl, K. Reich, C. E. M. Griffiths, K. Papp, L. Puig, et al. 2014. “Secukinumab in Plaque Psoriasis — Results of Two Phase 3 Trials.” <em>New England Journal of Medicine</em> 371 (4): 326–38. <a href="https://doi.org/10.1056/nejmoa1314258">https://doi.org/10.1056/nejmoa1314258</a>.</p>
</div>
<div id="ref-Niederreiter1978">
<p>Niederreiter, H. 1978. “Quasi-Monte Carlo Methods and Pseudo-Random Numbers.” <em>Bulletin of the American Mathematical Society</em> 84 (6): 957–1041. <a href="https://doi.org/10.1090/S0002-9904-1978-14532-7">https://doi.org/10.1090/S0002-9904-1978-14532-7</a>.</p>
</div>
<div id="ref-Phillippo_thesis">
<p>Phillippo, D. M. 2019. “Calibration of Treatment Effects in Network Meta-Analysis Using Individual Patient Data.” PhD thesis, University of Bristol.</p>
</div>
<div id="ref-methods_paper">
<p>Phillippo, D. M., S. Dias, A. E. Ades, M. Belger, A. Brnabic, A. Schacht, D. Saure, Z. Kadziola, and N. J. Welton. 2020. “Multilevel Network Meta-Regression for Population-Adjusted Treatment Comparisons.” <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em> 183 (3): 1189–1210. <a href="https://doi.org/10.1111/rssa.12579">https://doi.org/10.1111/rssa.12579</a>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>The convergence rate of QMC is typically <span class="math inline">\(\mathcal{O}(1/n)\)</span>, whereas the expected convergence rate of standard MC is <span class="math inline">\(\mathcal{O}(1/n^\frac{1}{2})\)</span> <span class="citation">(Caflisch 1998; Niederreiter 1978)</span>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by David M. Phillippo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
