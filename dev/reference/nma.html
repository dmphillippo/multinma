<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Network meta-analysis models — nma • multinma</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Network meta-analysis models — nma"><meta name="description" content="The nma function fits network meta-analysis and (multilevel) network
meta-regression models in Stan."><meta property="og:description" content="The nma function fits network meta-analysis and (multilevel) network
meta-regression models in Stan."><meta property="og:image" content="https://dmphillippo.github.io/multinma/logo.svg"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multinma</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.7.2.9004</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vignette_overview.html">Overview of Examples</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Examples</h6></li>
    <li><a class="dropdown-item" href="../articles/example_atrial_fibrillation.html">Example: Atrial fibrillation</a></li>
    <li><a class="dropdown-item" href="../articles/example_bcg_vaccine.html">Example: BCG vaccine for tuberculosis</a></li>
    <li><a class="dropdown-item" href="../articles/example_blocker.html">Example: Beta blockers</a></li>
    <li><a class="dropdown-item" href="../articles/example_diabetes.html">Example: Diabetes</a></li>
    <li><a class="dropdown-item" href="../articles/example_dietary_fat.html">Example: Dietary fat</a></li>
    <li><a class="dropdown-item" href="../articles/example_hta_psoriasis.html">Example: Plaque psoriasis HTA report</a></li>
    <li><a class="dropdown-item" href="../articles/example_ndmm.html">Example: Newly diagnosed multiple myeloma</a></li>
    <li><a class="dropdown-item" href="../articles/example_parkinsons.html">Example: Parkinson's disease</a></li>
    <li><a class="dropdown-item" href="../articles/example_plaque_psoriasis.html">Example: Plaque psoriasis ML-NMR</a></li>
    <li><a class="dropdown-item" href="../articles/example_smoking.html">Example: Smoking cessation</a></li>
    <li><a class="dropdown-item" href="../articles/example_statins.html">Example: Statins for cholesterol lowering</a></li>
    <li><a class="dropdown-item" href="../articles/example_thrombolytics.html">Example: Thrombolytic treatments</a></li>
    <li><a class="dropdown-item" href="../articles/example_transfusion.html">Example: White blood cell transfusion</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dmphillippo/multinma/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Network meta-analysis models</h1>
      <small class="dont-index">Source: <a href="https://github.com/dmphillippo/multinma/blob/develop/R/nma.R" class="external-link"><code>R/nma.R</code></a></small>
      <div class="d-none name"><code>nma.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>nma</code> function fits network meta-analysis and (multilevel) network
meta-regression models in Stan.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nma</span><span class="op">(</span></span>
<span>  <span class="va">network</span>,</span>
<span>  consistency <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"consistency"</span>, <span class="st">"ume"</span>, <span class="st">"nodesplit"</span><span class="op">)</span>,</span>
<span>  trt_effects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fixed"</span>, <span class="st">"random"</span><span class="op">)</span>,</span>
<span>  regression <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  class_interactions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"common"</span>, <span class="st">"exchangeable"</span>, <span class="st">"independent"</span><span class="op">)</span>,</span>
<span>  likelihood <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  link <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  nodesplit <span class="op">=</span> <span class="fu"><a href="get_nodesplits.html">get_nodesplits</a></span><span class="op">(</span><span class="va">network</span>, include_consistency <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  prior_intercept <span class="op">=</span> <span class="fu"><a href="default_values.html">.default</a></span><span class="op">(</span><span class="fu"><a href="priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prior_trt <span class="op">=</span> <span class="fu"><a href="default_values.html">.default</a></span><span class="op">(</span><span class="fu"><a href="priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prior_het <span class="op">=</span> <span class="fu"><a href="default_values.html">.default</a></span><span class="op">(</span><span class="fu"><a href="priors.html">half_normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prior_het_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sd"</span>, <span class="st">"var"</span>, <span class="st">"prec"</span><span class="op">)</span>,</span>
<span>  prior_reg <span class="op">=</span> <span class="fu"><a href="default_values.html">.default</a></span><span class="op">(</span><span class="fu"><a href="priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prior_aux <span class="op">=</span> <span class="fu"><a href="default_values.html">.default</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  prior_aux_reg <span class="op">=</span> <span class="fu"><a href="default_values.html">.default</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  aux_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  aux_regression <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  QR <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  adapt_delta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  int_thin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  int_check <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mspline_degree <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_knots <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  knots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mspline_basis <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-network">network<a class="anchor" aria-label="anchor" href="#arg-network"></a></dt>
<dd><p>An <code>nma_data</code> object, as created by the functions <code>set_*()</code>,
<code><a href="combine_network.html">combine_network()</a></code>, or <code><a href="add_integration.html">add_integration()</a></code></p></dd>


<dt id="arg-consistency">consistency<a class="anchor" aria-label="anchor" href="#arg-consistency"></a></dt>
<dd><p>Character string specifying the type of (in)consistency
model to fit, either <code>"consistency"</code>, <code>"ume"</code>, or <code>"nodesplit"</code></p></dd>


<dt id="arg-trt-effects">trt_effects<a class="anchor" aria-label="anchor" href="#arg-trt-effects"></a></dt>
<dd><p>Character string specifying either <code>"fixed"</code> or <code>"random"</code>
effects</p></dd>


<dt id="arg-regression">regression<a class="anchor" aria-label="anchor" href="#arg-regression"></a></dt>
<dd><p>A one-sided model formula, specifying the prognostic and
effect-modifying terms for a regression model. Any references to treatment
should use the <code>.trt</code> special variable, for example specifying effect
modifier interactions as <code>variable:.trt</code> (see details).</p></dd>


<dt id="arg-class-interactions">class_interactions<a class="anchor" aria-label="anchor" href="#arg-class-interactions"></a></dt>
<dd><p>Character string specifying whether effect modifier
interactions are specified as <code>"common"</code>, <code>"exchangeable"</code>, or
<code>"independent"</code>.</p></dd>


<dt id="arg-likelihood">likelihood<a class="anchor" aria-label="anchor" href="#arg-likelihood"></a></dt>
<dd><p>Character string specifying a likelihood, if unspecified
will be inferred from the data (see details)</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>Character string specifying a link function, if unspecified will
default to the canonical link (see details)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to
<code>sampling()</code>, such as <code>iter</code>,
<code>chains</code>, <code>cores</code>, etc.</p></dd>


<dt id="arg-nodesplit">nodesplit<a class="anchor" aria-label="anchor" href="#arg-nodesplit"></a></dt>
<dd><p>For <code>consistency = "nodesplit"</code>, the comparison(s) to split
in the node-splitting model(s). Either a length 2 vector giving the
treatments in a single comparison, or a 2 column data frame listing
multiple treatment comparisons to split in turn. By default, all possible
comparisons will be chosen (see <code><a href="get_nodesplits.html">get_nodesplits()</a></code>).</p></dd>


<dt id="arg-prior-intercept">prior_intercept<a class="anchor" aria-label="anchor" href="#arg-prior-intercept"></a></dt>
<dd><p>Specification of prior distribution for the intercept</p></dd>


<dt id="arg-prior-trt">prior_trt<a class="anchor" aria-label="anchor" href="#arg-prior-trt"></a></dt>
<dd><p>Specification of prior distribution for the treatment
effects</p></dd>


<dt id="arg-prior-het">prior_het<a class="anchor" aria-label="anchor" href="#arg-prior-het"></a></dt>
<dd><p>Specification of prior distribution for the heterogeneity
(if <code>trt_effects = "random"</code>)</p></dd>


<dt id="arg-prior-het-type">prior_het_type<a class="anchor" aria-label="anchor" href="#arg-prior-het-type"></a></dt>
<dd><p>Character string specifying whether the prior
distribution <code>prior_het</code> is placed on the heterogeneity standard deviation
\(\tau\) (<code>"sd"</code>, the default), variance \(\tau^2\) (<code>"var"</code>), or
precision \(1/\tau^2\) (<code>"prec"</code>).</p></dd>


<dt id="arg-prior-reg">prior_reg<a class="anchor" aria-label="anchor" href="#arg-prior-reg"></a></dt>
<dd><p>Specification of prior distribution for the regression
coefficients (if <code>regression</code> formula specified)</p></dd>


<dt id="arg-prior-aux">prior_aux<a class="anchor" aria-label="anchor" href="#arg-prior-aux"></a></dt>
<dd><p>Specification of prior distribution for the auxiliary
parameter, if applicable (see details). For <code>likelihood = "gengamma"</code> this
should be a list of prior distributions with elements <code>sigma</code> and <code>k</code>.</p></dd>


<dt id="arg-prior-aux-reg">prior_aux_reg<a class="anchor" aria-label="anchor" href="#arg-prior-aux-reg"></a></dt>
<dd><p>Specification of prior distribution for the auxiliary
regression parameters, if <code>aux_regression</code> is specified (see details).</p></dd>


<dt id="arg-aux-by">aux_by<a class="anchor" aria-label="anchor" href="#arg-aux-by"></a></dt>
<dd><p>Vector of variable names listing the variables to stratify the
auxiliary parameters by. Currently only used for survival models, see
details. Cannot be used with <code>aux_regression</code>.</p></dd>


<dt id="arg-aux-regression">aux_regression<a class="anchor" aria-label="anchor" href="#arg-aux-regression"></a></dt>
<dd><p>A one-sided model formula giving a regression model for
the auxiliary parameters. Currently only used for survival models, see
details. Cannot be used with <code>aux_by</code>.</p></dd>


<dt id="arg-qr">QR<a class="anchor" aria-label="anchor" href="#arg-qr"></a></dt>
<dd><p>Logical scalar (default <code>FALSE</code>), whether to apply a QR
decomposition to the model design matrix</p></dd>


<dt id="arg-center">center<a class="anchor" aria-label="anchor" href="#arg-center"></a></dt>
<dd><p>Logical scalar (default <code>TRUE</code>), whether to center the
(numeric) regression terms about the overall means</p></dd>


<dt id="arg-adapt-delta">adapt_delta<a class="anchor" aria-label="anchor" href="#arg-adapt-delta"></a></dt>
<dd><p>See <a href="adapt_delta.html">adapt_delta</a> for details</p></dd>


<dt id="arg-int-thin">int_thin<a class="anchor" aria-label="anchor" href="#arg-int-thin"></a></dt>
<dd><p>A single integer value, the thinning factor for returning
cumulative estimates of integration error. Saving cumulative estimates is
disabled by <code>int_thin = 0</code>, which is the default.</p></dd>


<dt id="arg-int-check">int_check<a class="anchor" aria-label="anchor" href="#arg-int-check"></a></dt>
<dd><p>Logical, check sufficient accuracy of numerical integration
by fitting half of the chains with <code>n_int/2</code>? When <code>TRUE</code>, <code>Rhat</code> and
<code>n_eff</code> diagnostic warnings will be given if numerical integration has not
sufficiently converged (suggesting increasing <code>n_int</code> in
<code><a href="add_integration.html">add_integration()</a></code>). Default <code>TRUE</code>, but disabled (<code>FALSE</code>) when
<code>int_thin &gt; 0</code>.</p></dd>


<dt id="arg-mspline-degree">mspline_degree<a class="anchor" aria-label="anchor" href="#arg-mspline-degree"></a></dt>
<dd><p>Non-negative integer giving the degree of the M-spline
polynomial for <code>likelihood = "mspline"</code>. Piecewise exponential hazards
(<code>likelihood = "pexp"</code>) are a special case with <code>mspline_degree = 0</code>.</p></dd>


<dt id="arg-n-knots">n_knots<a class="anchor" aria-label="anchor" href="#arg-n-knots"></a></dt>
<dd><p>For <code>mspline</code> and <code>pexp</code> likelihoods, a non-negative integer
giving the number of internal knots for partitioning the baseline hazard
into intervals. The knot locations within each study will be determined by
the corresponding quantiles of the observed event times, plus boundary
knots at the earliest entry time (0 with no delayed entry) and the maximum
event/censoring time. For example, with <code>n_knots = 3</code>, the internal knot
locations will be at the 25%, 50%, and 75% quantiles of the observed event
times. The default is <code>n_knots = 7</code>; overfitting is avoided by shrinking
towards a constant hazard with a random walk prior (see details). If
<code>aux_regression</code> is specified then a single set of knot locations will be
calculated across all studies in the network. See <code><a href="make_knots.html">make_knots()</a></code> for more
details on the knot positioning algorithms. Ignored when <code>knots</code> is
specified.</p></dd>


<dt id="arg-knots">knots<a class="anchor" aria-label="anchor" href="#arg-knots"></a></dt>
<dd><p>For <code>mspline</code> and <code>pexp</code> likelihoods, a named list of numeric
vectors of knot locations (including boundary knots) for each of the
studies in the network. Currently, each vector must have the same length
(i.e. each study must use the same number of knots). Alternatively, a
single numeric vector of knot locations can be provided which will be
shared across all studies in the network. If unspecified (the default), the
knots will be chosen based on <code>n_knots</code> as described above. If
<code>aux_regression</code> is specified then <code>knots</code> should be a single numeric
vector of knot locations which will be shared across all studies in the
network. <code><a href="make_knots.html">make_knots()</a></code> can be used to help specify <code>knots</code> directly, or to
investigate knot placement prior to model fitting.</p></dd>


<dt id="arg-mspline-basis">mspline_basis<a class="anchor" aria-label="anchor" href="#arg-mspline-basis"></a></dt>
<dd><p>Instead of specifying <code>mspline_degree</code> and <code>n_knots</code> or
<code>knots</code>, a named list of M-spline bases (one for each study) can be
provided with <code>mspline_basis</code> which will be used directly. In this case,
all other M-spline options will be ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>nma()</code> returns a <a href="stan_nma-class.html">stan_nma</a> object, except when <code>consistency = "nodesplit"</code> when a <a href="nma_nodesplit-class.html">nma_nodesplit</a> or <a href="nma_nodesplit-class.html">nma_nodesplit_df</a> object is
returned. <code>nma.fit()</code> returns a <code><a href="https://mc-stan.org/rstan/reference/stanfit-class.html" class="external-link">stanfit</a></code>
object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When specifying a model formula in the <code>regression</code> argument, the
usual formula syntax is available (as interpreted by <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code>). The
only additional requirement here is that the special variable <code>.trt</code> should
be used to refer to treatment. For example, effect modifier interactions
should be specified as <code>variable:.trt</code>. Prognostic (main) effects and
interactions can be included together compactly as <code>variable*.trt</code>, which
expands to <code>variable + variable:.trt</code> (plus <code>.trt</code>, which is already in the
NMA model).</p>
<p>For the advanced user, the additional specials <code>.study</code> and <code>.trtclass</code> are
also available, and refer to studies and (if specified) treatment classes
respectively. When node-splitting models are fitted (<code>consistency = "nodesplit"</code>) the special <code>.omega</code> is available, indicating the arms to
which the node-splitting inconsistency factor is added.</p>
<p>See <code><a href="priors.html">?priors</a></code> for details on prior
specification. Default prior distributions are available, but may not be
appropriate for the particular setting and will raise a warning if used. No
attempt is made to tailor these defaults to the data provided. Please
consider appropriate prior distributions for the particular setting,
accounting for the scales of outcomes and covariates, etc. The function
<code><a href="plot_prior_posterior.html">plot_prior_posterior()</a></code> may be useful in examining the influence of the
chosen prior distributions on the posterior distributions, and the
<code><a href="summary.nma_prior.html">summary()</a></code> method for <code>nma_prior</code>
objects prints prior intervals.</p>
    </div>
    <div class="section level2">
    <h2 id="likelihoods-and-link-functions">Likelihoods and link functions<a class="anchor" aria-label="anchor" href="#likelihoods-and-link-functions"></a></h2>


<p>Currently, the following likelihoods and link functions are supported for
each data type:</p><table class="table table"><tr><td><strong>Data type</strong></td><td><strong>Likelihood</strong></td><td><strong>Link function</strong></td></tr><tr><td><strong>Binary</strong></td><td><code>bernoulli</code>, <code>bernoulli2</code></td><td><code>logit</code>, <code>probit</code>, <code>cloglog</code></td></tr><tr><td><strong>Count</strong></td><td><code>binomial</code>, <code>binomial2</code></td><td><code>logit</code>, <code>probit</code>, <code>cloglog</code></td></tr><tr><td><strong>Rate</strong></td><td><code>poisson</code></td><td><code>log</code></td></tr><tr><td><strong>Continuous</strong></td><td><code>normal</code></td><td><code>identity</code>, <code>log</code></td></tr><tr><td><strong>Ordered</strong></td><td><code>ordered</code></td><td><code>logit</code>, <code>probit</code>, <code>cloglog</code></td></tr><tr><td><strong>Survival</strong></td><td><code>exponential</code>, <code>weibull</code>, <code>gompertz</code>, <code>exponential-aft</code>, <code>weibull-aft</code>, <code>lognormal</code>, <code>loglogistic</code>, <code>gamma</code>, <code>gengamma</code>, <code>mspline</code>, <code>pexp</code></td><td><code>log</code></td></tr></table><p>The <code>bernoulli2</code> and <code>binomial2</code> likelihoods correspond to a two-parameter
Binomial likelihood for arm-based AgD, which more closely matches the
underlying Poisson Binomial distribution for the summarised aggregate
outcomes in a ML-NMR model than the typical (one parameter) Binomial
distribution @see @methods_papermultinma.</p>
<p>When a <code>cloglog</code> link is used, including an offset for log follow-up time
(i.e. <code>regression = ~offset(log(time))</code>) results in a model on the log
hazard @see @TSD2multinma.</p>
<p>For survival data, all accelerated failure time models (<code>exponential-aft</code>,
<code>weibull-aft</code>, <code>lognormal</code>, <code>loglogistic</code>, <code>gamma</code>, <code>gengamma</code>) are
parameterised so that the treatment effects and any regression parameters
are log Survival Time Ratios (i.e. a coefficient of \(\log(2)\) means
that the treatment or covariate is associated with a doubling of expected
survival time). These can be converted to log Acceleration Factors using
the relation \(\log(\mathrm{AF}) = -\log(\mathrm{STR})\) (or equivalently
\(\mathrm{AF} = 1/\mathrm{STR}\)).</p>
<p>Further details on each likelihood and link function are given by
TSD2;textualmultinma.</p>
    </div>
    <div class="section level2">
    <h2 id="auxiliary-parameters">Auxiliary parameters<a class="anchor" aria-label="anchor" href="#auxiliary-parameters"></a></h2>


<p>Auxiliary parameters are only present in the following models.</p><div class="section">
<h3 id="normal-likelihood-with-ipd">Normal likelihood with IPD<a class="anchor" aria-label="anchor" href="#normal-likelihood-with-ipd"></a></h3>


<p>When a Normal likelihood is fitted to IPD, the auxiliary parameters are the
arm-level standard deviations \(\sigma_{jk}\) on treatment \(k\) in
study \(j\).</p>
</div>

<div class="section">
<h3 id="ordered-multinomial-likelihood">Ordered multinomial likelihood<a class="anchor" aria-label="anchor" href="#ordered-multinomial-likelihood"></a></h3>


<p>When fitting a model to \(M\) ordered outcomes, the auxiliary parameters
are the latent cutoffs between each category, \(c_0 &lt; c_1 &lt; \dots &lt;
  c_M\). Only \(c_2\) to \(c_{M-1}\) are estimated; we fix \(c_0 =
  -\infty\), \(c_1 = 0\), and \(c_M = \infty\). When specifying priors for
these latent cutoffs, we choose to specify priors on the <em>differences</em>
\(c_{m+1} - c_m\). Stan automatically truncates any priors so that the
ordering constraints are satisfied.</p>
</div>

<div class="section">
<h3 id="survival-time-to-event-likelihoods">Survival (time-to-event) likelihoods<a class="anchor" aria-label="anchor" href="#survival-time-to-event-likelihoods"></a></h3>


<p>All survival likelihoods except the <code>exponential</code> and <code>exponential-aft</code>
likelihoods have auxiliary parameters. These are typically study-specific
shape parameters \(\gamma_j&gt;0\), except for the <code>lognormal</code> likelihood
where the auxiliary parameters are study-specific standard deviations on
the log scale \(\sigma_j&gt;0\).</p>
<p>The <code>gengamma</code> likelihood has two sets of auxiliary parameters,
study-specific scale parameters \(\sigma_j&gt;0\) and shape parameters
\(k_j\), following the parameterisation of
Lawless1980;textualmultinma, which permits a range of
behaviours for the baseline hazard including increasing, decreasing,
bathtub and arc-shaped hazards. This parameterisation is related to that
discussed by Cox2007;textualmultinma and implemented in the
<code>flexsurv</code> package with \(Q = k^{-0.5}\). The parameterisation used here
effectively bounds the shape parameter \(k\) away from numerical
instabilities as \(k \rightarrow \infty\) (i.e. away from \(Q
  \rightarrow 0\), the log-Normal distribution) via the prior distribution.
Implicitly, this parameterisation is restricted to \(Q &gt; 0\) and so
certain survival distributions like the inverse-Gamma and inverse-Weibull
are not part of the parameter space; however, \(Q &gt; 0\) still encompasses
the other survival distributions implemented in this package.</p>
<p>For the <code>mspline</code> and <code>pexp</code> likelihoods, the auxiliary parameters are the
spline coefficients for each study. These form a unit simplex (i.e. lie
between 0 and 1, and sum to 1), and are given a random walk prior
distribution. <code>prior_aux</code> specifies the hyperprior on the random walk
standard deviation \(\sigma\) which controls the level of smoothing of
the baseline hazard, with \(\sigma = 0\) corresponding to a constant
baseline hazard.</p>
<p>The auxiliary parameters can be stratified by additional factors through
the <code>aux_by</code> argument. For example, to allow the shape of the baseline
hazard to vary between treatment arms as well as studies, use <code>aux_by = c(".study", ".trt")</code>. (Technically, <code>.study</code> is always included in the
stratification even if omitted from <code>aux_by</code>, but we choose here to make
the stratification explicit.) This is a common way of relaxing the
proportional hazards assumption. The default is equivalent to <code>aux_by = ".study"</code> which stratifies the auxiliary parameters by study, as described
above.</p>
<p>A regression model may be specified on the auxiliary parameters using
<code>aux_regression</code>. This is useful if we wish to model departures from
non-proportionality, rather than allowing the baseline hazards to be
completely independent using <code>aux_by</code>. This is necessary if absolute
predictions (e.g. survival curves) are required in a population for
unobserved combinations of covariates; for example, if <code>aux_by = .trt</code> then
absolute predictions may only be produced for the observed treatment arms
in each study population, whereas if <code>aux_regression = ~.trt</code> then absolute
predictions can be produced for all treatments in any population. For
<code>mspline</code> and <code>pexp</code> likelihoods, the regression coefficients are smoothed
over time using a random walk prior to avoid overfitting: <code>prior_aux_reg</code>
specifies the hyperprior for the random walk standard deviation. For other
parametric likelihoods, <code>prior_aux_reg</code> specifies the prior for the
auxiliary regression coefficients.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>

    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David M. Phillippo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>



  <script data-goatcounter="https://multinma.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></body></html>

