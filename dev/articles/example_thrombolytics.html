<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example: Thrombolytic treatments • multinma</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Example: Thrombolytic treatments">
<meta property="og:description" content="multinma">
<meta property="og:image" content="https://dmphillippo.github.io/multinma/logo.svg">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multinma</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette_overview.html">Overview of Examples</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Examples</li>
    <li>
      <a href="../articles/example_atrial_fibrillation.html">Example: Atrial fibrillation</a>
    </li>
    <li>
      <a href="../articles/example_bcg_vaccine.html">Example: BCG vaccine for tuberculosis</a>
    </li>
    <li>
      <a href="../articles/example_blocker.html">Example: Beta blockers</a>
    </li>
    <li>
      <a href="../articles/example_diabetes.html">Example: Diabetes</a>
    </li>
    <li>
      <a href="../articles/example_dietary_fat.html">Example: Dietary fat</a>
    </li>
    <li>
      <a href="../articles/example_hta_psoriasis.html">Example: Plaque psoriasis HTA report</a>
    </li>
    <li>
      <a href="../articles/example_parkinsons.html">Example: Parkinson's disease</a>
    </li>
    <li>
      <a href="../articles/example_plaque_psoriasis.html">Example: Plaque psoriasis ML-NMR</a>
    </li>
    <li>
      <a href="../articles/example_smoking.html">Example: Smoking cessation</a>
    </li>
    <li>
      <a href="../articles/example_statins.html">Example: Statins for cholesterol lowering</a>
    </li>
    <li>
      <a href="../articles/example_thrombolytics.html">Example: Thrombolytic treatments</a>
    </li>
    <li>
      <a href="../articles/example_transfusion.html">Example: White blood cell transfusion</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dmphillippo/multinma/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="example_thrombolytics_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example: Thrombolytic treatments</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dmphillippo/multinma/blob/HEAD/vignettes/example_thrombolytics.Rmd" class="external-link"><code>vignettes/example_thrombolytics.Rmd</code></a></small>
      <div class="hidden name"><code>example_thrombolytics.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dmphillippo.github.io/multinma/">multinma</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">#&gt; For execution on a local, multicore CPU with excess RAM we recommend calling</span>
<span class="co">#&gt; options(mc.cores = parallel::detectCores())</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'multinma'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     dgamma, pgamma, qgamma</span></code></pre>
<p>This vignette describes the analysis of 50 trials of 8 thrombolytic drugs (streptokinase, SK; alteplase, t-PA; accelerated alteplase, Acc t-PA; streptokinase plus alteplase, SK+tPA; reteplase, r-PA; tenocteplase, TNK; urokinase, UK; anistreptilase, ASPAC) plus per-cutaneous transluminal coronary angioplasty (PTCA) <span class="citation">(Boland et al. 2003; Lu and Ades 2006; Dias et al. 2011)</span>. The number of deaths in 30 or 35 days following acute myocardial infarction are recorded. The data are available in this package as <code>thrombolytics</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">thrombolytics</span><span class="op">)</span>
<span class="co">#&gt;   studyn trtn      trtc    r     n</span>
<span class="co">#&gt; 1      1    1        SK 1472 20251</span>
<span class="co">#&gt; 2      1    3  Acc t-PA  652 10396</span>
<span class="co">#&gt; 3      1    4 SK + t-PA  723 10374</span>
<span class="co">#&gt; 4      2    1        SK    9   130</span>
<span class="co">#&gt; 5      2    2      t-PA    6   123</span>
<span class="co">#&gt; 6      3    1        SK    5    63</span></code></pre></div>
<div class="section level3">
<h3 id="setting-up-the-network">Setting up the network<a class="anchor" aria-label="anchor" href="#setting-up-the-network"></a>
</h3>
<p>We begin by setting up the network. We have arm-level count data giving the number of deaths (<code>r</code>) out of the total (<code>n</code>) in each arm, so we use the function <code><a href="../reference/set_agd_arm.html">set_agd_arm()</a></code>. By default, SK is set as the network reference treatment.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">thrombo_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_agd_arm.html">set_agd_arm</a></span><span class="op">(</span><span class="va">thrombolytics</span>, 
                           study <span class="op">=</span> <span class="va">studyn</span>,
                           trt <span class="op">=</span> <span class="va">trtc</span>,
                           r <span class="op">=</span> <span class="va">r</span>, 
                           n <span class="op">=</span> <span class="va">n</span><span class="op">)</span>
<span class="va">thrombo_net</span>
<span class="co">#&gt; A network with 50 AgD studies (arm-based).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;">-------------------------------------------------------</span> <span style="font-weight: bold;">AgD studies (arm-based)</span> <span style="color: #555555;">----</span> </span>
<span class="co">#&gt;  Study Treatments                  </span>
<span class="co">#&gt;  1     3: SK | Acc t-PA | SK + t-PA</span>
<span class="co">#&gt;  2     2: SK | t-PA                </span>
<span class="co">#&gt;  3     2: SK | t-PA                </span>
<span class="co">#&gt;  4     2: SK | t-PA                </span>
<span class="co">#&gt;  5     2: SK | t-PA                </span>
<span class="co">#&gt;  6     3: SK | t-PA | ASPAC        </span>
<span class="co">#&gt;  7     2: SK | t-PA                </span>
<span class="co">#&gt;  8     2: SK | t-PA                </span>
<span class="co">#&gt;  9     2: SK | t-PA                </span>
<span class="co">#&gt;  10    2: SK | SK + t-PA           </span>
<span class="co">#&gt; <span style="color: #555555;"> ... plus 40 more studies</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Outcome type: count</span>
<span class="co">#&gt; <span style="color: #555555;">------------------------------------------------------------------------------------</span></span>
<span class="co">#&gt; Total number of treatments: 9</span>
<span class="co">#&gt; Total number of studies: 50</span>
<span class="co">#&gt; Reference treatment is: SK</span>
<span class="co">#&gt; Network is <span style="color: #00BB00;">connected</span></span></code></pre></div>
<p>Plot the network structure.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">thrombo_net</span>, weight_edges <span class="op">=</span> <span class="cn">TRUE</span>, weight_nodes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="example_thrombolytics_files/figure-html/thrombo_net_plot-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="fixed-effects-nma">Fixed effects NMA<a class="anchor" aria-label="anchor" href="#fixed-effects-nma"></a>
</h3>
<p>Following TSD 4 <span class="citation">(Dias et al. 2011)</span>, we fit a fixed effects NMA model, using the <code><a href="../reference/nma.html">nma()</a></code> function with <code>trt_effects = "fixed"</code>. We use <span class="math inline">\(\mathrm{N}(0, 100^2)\)</span> prior distributions for the treatment effects <span class="math inline">\(d_k\)</span> and study-specific intercepts <span class="math inline">\(\mu_j\)</span>. We can examine the range of parameter values implied by these prior distributions with the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; A Normal prior distribution: location = 0, scale = 100.</span>
<span class="co">#&gt; 50% of the prior density lies between -67.45 and 67.45.</span>
<span class="co">#&gt; 95% of the prior density lies between -196 and 196.</span></code></pre></div>
<p>The model is fitted using the <code><a href="../reference/nma.html">nma()</a></code> function. By default, this will use a Binomial likelihood and a logit link function, auto-detected from the data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">thrombo_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">thrombo_net</span>, 
                   trt_effects <span class="op">=</span> <span class="st">"fixed"</span>,
                   prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,
                   prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Note: Setting "SK" as the network reference treatment.</span></code></pre></div>
<p>Basic parameter summaries are given by the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">thrombo_fit</span>
<span class="co">#&gt; A fixed effects NMA with a binomial likelihood (logit link).</span>
<span class="co">#&gt; Inference for Stan model: binomial_1par.</span>
<span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span>
<span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                   mean se_mean   sd      2.5%       25%       50%       75%     97.5% n_eff Rhat</span>
<span class="co">#&gt; d[Acc t-PA]      -0.18    0.00 0.04     -0.26     -0.21     -0.18     -0.15     -0.09  2473    1</span>
<span class="co">#&gt; d[ASPAC]          0.02    0.00 0.04     -0.06     -0.01      0.02      0.04      0.09  4088    1</span>
<span class="co">#&gt; d[PTCA]          -0.47    0.00 0.10     -0.67     -0.54     -0.47     -0.41     -0.28  3691    1</span>
<span class="co">#&gt; d[r-PA]          -0.12    0.00 0.06     -0.24     -0.16     -0.12     -0.08      0.00  3704    1</span>
<span class="co">#&gt; d[SK + t-PA]     -0.05    0.00 0.05     -0.14     -0.08     -0.05     -0.02      0.04  5451    1</span>
<span class="co">#&gt; d[t-PA]           0.00    0.00 0.03     -0.06     -0.02      0.00      0.02      0.06  4404    1</span>
<span class="co">#&gt; d[TNK]           -0.17    0.00 0.08     -0.32     -0.22     -0.17     -0.12     -0.02  4047    1</span>
<span class="co">#&gt; d[UK]            -0.20    0.00 0.22     -0.62     -0.35     -0.20     -0.05      0.22  4367    1</span>
<span class="co">#&gt; lp__         -43042.79    0.13 5.35 -43054.22 -43046.27 -43042.37 -43038.99 -43033.31  1604    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Tue Dec  7 11:13:42 2021.</span>
<span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span>
<span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span>
<span class="co">#&gt; convergence, Rhat=1).</span></code></pre></div>
<p>By default, summaries of the study-specific intercepts <span class="math inline">\(\mu_j\)</span> are hidden, but could be examined by changing the <code>pars</code> argument:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Not run</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">thrombo_fit</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"mu"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The prior and posterior distributions can be compared visually using the <code><a href="../reference/plot_prior_posterior.html">plot_prior_posterior()</a></code> function:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_prior_posterior.html">plot_prior_posterior</a></span><span class="op">(</span><span class="va">thrombo_fit</span>, prior <span class="op">=</span> <span class="st">"trt"</span><span class="op">)</span></code></pre></div>
<p><img src="example_thrombolytics_files/figure-html/thrombo_pp_plot-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Model fit can be checked using the <code><a href="../reference/dic.html">dic()</a></code> function</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">dic_consistency</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">thrombo_fit</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Residual deviance: 105.8<span style="color: #555555;"> (on 102 data points)</span></span>
<span class="co">#&gt;                pD: 58.6</span>
<span class="co">#&gt;               DIC: 164.3</span></code></pre></div>
<p>and the residual deviance contributions examined with the corresponding <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dic_consistency</span><span class="op">)</span></code></pre></div>
<p><img src="example_thrombolytics_files/figure-html/thrombo_resdev_plot-1.png" width="1152" style="display: block; margin: auto;"></p>
<p>There are a number of points which are not very well fit by the model, having posterior mean residual deviance contributions greater than 1.</p>
</div>
<div class="section level3">
<h3 id="checking-for-inconsistency">Checking for inconsistency<a class="anchor" aria-label="anchor" href="#checking-for-inconsistency"></a>
</h3>
<p>We fit an unrelated mean effects (UME) model <span class="citation">(Dias et al. 2011)</span> to assess the consistency assumption. Again, we use the function <code><a href="../reference/nma.html">nma()</a></code>, but now with the argument <code>consistency = "ume"</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">thrombo_fit_ume</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">thrombo_net</span>, 
                  consistency <span class="op">=</span> <span class="st">"ume"</span>,
                  trt_effects <span class="op">=</span> <span class="st">"fixed"</span>,
                  prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,
                  prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Note: Setting "SK" as the network reference treatment.</span>
<span class="va">thrombo_fit_ume</span>
<span class="co">#&gt; A fixed effects NMA with a binomial likelihood (logit link).</span>
<span class="co">#&gt; An inconsistency model ('ume') was fitted.</span>
<span class="co">#&gt; Inference for Stan model: binomial_1par.</span>
<span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span>
<span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                            mean se_mean   sd      2.5%       25%       50%       75%     97.5%</span>
<span class="co">#&gt; d[Acc t-PA vs. SK]        -0.16    0.00 0.05     -0.25     -0.19     -0.16     -0.13     -0.06</span>
<span class="co">#&gt; d[ASPAC vs. SK]            0.01    0.00 0.04     -0.07     -0.02      0.00      0.03      0.08</span>
<span class="co">#&gt; d[PTCA vs. SK]            -0.66    0.00 0.18     -1.01     -0.79     -0.66     -0.54     -0.31</span>
<span class="co">#&gt; d[r-PA vs. SK]            -0.06    0.00 0.09     -0.24     -0.12     -0.06      0.00      0.13</span>
<span class="co">#&gt; d[SK + t-PA vs. SK]       -0.04    0.00 0.05     -0.13     -0.07     -0.04     -0.01      0.05</span>
<span class="co">#&gt; d[t-PA vs. SK]             0.00    0.00 0.03     -0.06     -0.02      0.00      0.02      0.06</span>
<span class="co">#&gt; d[UK vs. SK]              -0.36    0.01 0.54     -1.43     -0.71     -0.37      0.02      0.68</span>
<span class="co">#&gt; d[ASPAC vs. Acc t-PA]      1.40    0.01 0.42      0.63      1.12      1.40      1.67      2.29</span>
<span class="co">#&gt; d[PTCA vs. Acc t-PA]      -0.21    0.00 0.12     -0.44     -0.29     -0.21     -0.13      0.02</span>
<span class="co">#&gt; d[r-PA vs. Acc t-PA]       0.02    0.00 0.07     -0.11     -0.03      0.02      0.06      0.15</span>
<span class="co">#&gt; d[TNK vs. Acc t-PA]        0.01    0.00 0.06     -0.12     -0.04      0.01      0.05      0.12</span>
<span class="co">#&gt; d[UK vs. Acc t-PA]         0.15    0.01 0.37     -0.55     -0.09      0.14      0.39      0.87</span>
<span class="co">#&gt; d[t-PA vs. ASPAC]          0.29    0.01 0.35     -0.40      0.05      0.29      0.52      0.97</span>
<span class="co">#&gt; d[t-PA vs. PTCA]           0.54    0.01 0.42     -0.25      0.25      0.54      0.83      1.37</span>
<span class="co">#&gt; d[UK vs. t-PA]            -0.29    0.00 0.33     -0.94     -0.52     -0.29     -0.07      0.39</span>
<span class="co">#&gt; lp__                  -43039.72    0.15 5.67 -43051.52 -43043.31 -43039.37 -43035.76 -43029.65</span>
<span class="co">#&gt;                       n_eff Rhat</span>
<span class="co">#&gt; d[Acc t-PA vs. SK]     6611    1</span>
<span class="co">#&gt; d[ASPAC vs. SK]        5616    1</span>
<span class="co">#&gt; d[PTCA vs. SK]         5413    1</span>
<span class="co">#&gt; d[r-PA vs. SK]         5405    1</span>
<span class="co">#&gt; d[SK + t-PA vs. SK]    5628    1</span>
<span class="co">#&gt; d[t-PA vs. SK]         4503    1</span>
<span class="co">#&gt; d[UK vs. SK]           6389    1</span>
<span class="co">#&gt; d[ASPAC vs. Acc t-PA]  3560    1</span>
<span class="co">#&gt; d[PTCA vs. Acc t-PA]   4368    1</span>
<span class="co">#&gt; d[r-PA vs. Acc t-PA]   5567    1</span>
<span class="co">#&gt; d[TNK vs. Acc t-PA]    5955    1</span>
<span class="co">#&gt; d[UK vs. Acc t-PA]     4259    1</span>
<span class="co">#&gt; d[t-PA vs. ASPAC]      4025    1</span>
<span class="co">#&gt; d[t-PA vs. PTCA]       4213    1</span>
<span class="co">#&gt; d[UK vs. t-PA]         4806    1</span>
<span class="co">#&gt; lp__                   1461    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Tue Dec  7 11:13:56 2021.</span>
<span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span>
<span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span>
<span class="co">#&gt; convergence, Rhat=1).</span></code></pre></div>
<p>Comparing the model fit statistics</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dic_consistency</span>
<span class="co">#&gt; Residual deviance: 105.8<span style="color: #555555;"> (on 102 data points)</span></span>
<span class="co">#&gt;                pD: 58.6</span>
<span class="co">#&gt;               DIC: 164.3</span>
<span class="op">(</span><span class="va">dic_ume</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">thrombo_fit_ume</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Residual deviance: 99.6<span style="color: #555555;"> (on 102 data points)</span></span>
<span class="co">#&gt;                pD: 65.9</span>
<span class="co">#&gt;               DIC: 165.5</span></code></pre></div>
<p>Whilst the UME model fits the data better, having a lower residual deviance, the additional parameters in the UME model mean that the DIC is very similar between both models. However, it is also important to examine the individual contributions to model fit of each data point under the two models (a so-called “dev-dev” plot). Passing two <code>nma_dic</code> objects produced by the <code><a href="../reference/dic.html">dic()</a></code> function to the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method produces this dev-dev plot:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dic_consistency</span>, <span class="va">dic_ume</span>, show_uncertainty <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="example_thrombolytics_files/figure-html/thrombo_devdev_plot-1.png" width="700" style="display: block; margin: auto;"></p>
<p>The four points lying in the lower right corner of the plot have much lower posterior mean residual deviance under the UME model, indicating that these data are potentially inconsistent. These points correspond to trials 44 and 45, the only two trials comparing Acc t-PA to ASPAC. The ASPAC vs. Acc t-PA estimates are very different under the consistency model and inconsistency (UME) model, suggesting that these two trials may be systematically different from the others in the network.</p>
</div>
<div class="section level3">
<h3 id="further-results">Further results<a class="anchor" aria-label="anchor" href="#further-results"></a>
</h3>
<p>Relative effects for all pairwise contrasts between treatments can be produced using the <code><a href="../reference/relative_effects.html">relative_effects()</a></code> function, with <code>all_contrasts = TRUE</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">thrombo_releff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relative_effects.html">relative_effects</a></span><span class="op">(</span><span class="va">thrombo_fit</span>, all_contrasts <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;                            mean   sd  2.5%   25%   50%   75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; d[Acc t-PA vs. SK]        -0.18 0.04 -0.26 -0.21 -0.18 -0.15 -0.09     2502     3132    1</span>
<span class="co">#&gt; d[ASPAC vs. SK]            0.02 0.04 -0.06 -0.01  0.02  0.04  0.09     4054     3511    1</span>
<span class="co">#&gt; d[PTCA vs. SK]            -0.47 0.10 -0.67 -0.54 -0.47 -0.41 -0.28     3739     3304    1</span>
<span class="co">#&gt; d[r-PA vs. SK]            -0.12 0.06 -0.24 -0.16 -0.12 -0.08  0.00     3742     3023    1</span>
<span class="co">#&gt; d[SK + t-PA vs. SK]       -0.05 0.05 -0.14 -0.08 -0.05 -0.02  0.04     5384     3457    1</span>
<span class="co">#&gt; d[t-PA vs. SK]             0.00 0.03 -0.06 -0.02  0.00  0.02  0.06     4441     3614    1</span>
<span class="co">#&gt; d[TNK vs. SK]             -0.17 0.08 -0.32 -0.22 -0.17 -0.12 -0.02     4061     3543    1</span>
<span class="co">#&gt; d[UK vs. SK]              -0.20 0.22 -0.62 -0.35 -0.20 -0.05  0.22     4377     3747    1</span>
<span class="co">#&gt; d[ASPAC vs. Acc t-PA]      0.19 0.05  0.09  0.16  0.19  0.23  0.30     3411     3542    1</span>
<span class="co">#&gt; d[PTCA vs. Acc t-PA]      -0.30 0.09 -0.49 -0.36 -0.29 -0.23 -0.11     4783     3521    1</span>
<span class="co">#&gt; d[r-PA vs. Acc t-PA]       0.05 0.06 -0.05  0.02  0.05  0.09  0.16     5733     3487    1</span>
<span class="co">#&gt; d[SK + t-PA vs. Acc t-PA]  0.13 0.05  0.02  0.09  0.13  0.16  0.23     5439     3336    1</span>
<span class="co">#&gt; d[t-PA vs. Acc t-PA]       0.18 0.05  0.08  0.14  0.18  0.21  0.28     3091     3248    1</span>
<span class="co">#&gt; d[TNK vs. Acc t-PA]        0.01 0.06 -0.12 -0.04  0.01  0.05  0.14     5684     3898    1</span>
<span class="co">#&gt; d[UK vs. Acc t-PA]        -0.02 0.22 -0.43 -0.18 -0.02  0.12  0.40     4580     3685    1</span>
<span class="co">#&gt; d[PTCA vs. ASPAC]         -0.49 0.10 -0.70 -0.56 -0.49 -0.42 -0.29     3868     3326    1</span>
<span class="co">#&gt; d[r-PA vs. ASPAC]         -0.14 0.07 -0.28 -0.19 -0.14 -0.09  0.00     4257     3701    1</span>
<span class="co">#&gt; d[SK + t-PA vs. ASPAC]    -0.07 0.06 -0.18 -0.10 -0.06 -0.03  0.05     4754     3612    1</span>
<span class="co">#&gt; d[t-PA vs. ASPAC]         -0.01 0.04 -0.08 -0.04 -0.01  0.01  0.06     6399     3132    1</span>
<span class="co">#&gt; d[TNK vs. ASPAC]          -0.19 0.08 -0.35 -0.24 -0.19 -0.13 -0.02     4167     3143    1</span>
<span class="co">#&gt; d[UK vs. ASPAC]           -0.22 0.22 -0.64 -0.37 -0.21 -0.07  0.21     4572     3827    1</span>
<span class="co">#&gt; d[r-PA vs. PTCA]           0.35 0.11  0.14  0.28  0.35  0.42  0.57     5152     3383    1</span>
<span class="co">#&gt; d[SK + t-PA vs. PTCA]      0.42 0.10  0.23  0.35  0.42  0.49  0.63     4467     3370    1</span>
<span class="co">#&gt; d[t-PA vs. PTCA]           0.48 0.10  0.28  0.41  0.47  0.55  0.68     3829     3273    1</span>
<span class="co">#&gt; d[TNK vs. PTCA]            0.30 0.11  0.08  0.22  0.30  0.38  0.53     5718     3173    1</span>
<span class="co">#&gt; d[UK vs. PTCA]             0.27 0.23 -0.18  0.11  0.27  0.43  0.73     4500     3212    1</span>
<span class="co">#&gt; d[SK + t-PA vs. r-PA]      0.07 0.07 -0.07  0.03  0.07  0.12  0.22     5984     2537    1</span>
<span class="co">#&gt; d[t-PA vs. r-PA]           0.13 0.07 -0.01  0.08  0.13  0.17  0.25     3941     3183    1</span>
<span class="co">#&gt; d[TNK vs. r-PA]           -0.05 0.09 -0.22 -0.10 -0.05  0.01  0.12     6862     2926    1</span>
<span class="co">#&gt; d[UK vs. r-PA]            -0.08 0.22 -0.50 -0.23 -0.08  0.08  0.36     4732     3677    1</span>
<span class="co">#&gt; d[t-PA vs. SK + t-PA]      0.05 0.05 -0.05  0.02  0.05  0.09  0.16     5114     3677    1</span>
<span class="co">#&gt; d[TNK vs. SK + t-PA]      -0.12 0.08 -0.28 -0.18 -0.12 -0.07  0.04     6365     3237    1</span>
<span class="co">#&gt; d[UK vs. SK + t-PA]       -0.15 0.22 -0.58 -0.30 -0.15  0.00  0.27     4557     3576    1</span>
<span class="co">#&gt; d[TNK vs. t-PA]           -0.17 0.08 -0.33 -0.23 -0.17 -0.12 -0.01     4253     3242    1</span>
<span class="co">#&gt; d[UK vs. t-PA]            -0.20 0.22 -0.62 -0.35 -0.20 -0.06  0.23     4558     3746    1</span>
<span class="co">#&gt; d[UK vs. TNK]             -0.03 0.23 -0.46 -0.19 -0.03  0.12  0.41     4548     3273    1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">thrombo_releff</span>, ref_line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p><img src="example_thrombolytics_files/figure-html/thrombo_releff-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Treatment rankings, rank probabilities, and cumulative rank probabilities.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">thrombo_ranks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_ranks.html">posterior_ranks</a></span><span class="op">(</span><span class="va">thrombo_fit</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;                 mean   sd 2.5% 25% 50% 75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; rank[SK]        7.44 0.98    6   7   7   8     9     3173       NA    1</span>
<span class="co">#&gt; rank[Acc t-PA]  3.18 0.80    2   3   3   4     5     4364     3875    1</span>
<span class="co">#&gt; rank[ASPAC]     7.99 1.10    6   7   8   9     9     4511       NA    1</span>
<span class="co">#&gt; rank[PTCA]      1.13 0.34    1   1   1   1     2     3991     3984    1</span>
<span class="co">#&gt; rank[r-PA]      4.41 1.17    2   4   5   5     7     5286     3415    1</span>
<span class="co">#&gt; rank[SK + t-PA] 5.97 1.23    4   5   6   6     9     4620       NA    1</span>
<span class="co">#&gt; rank[t-PA]      7.48 1.10    5   7   8   8     9     4636       NA    1</span>
<span class="co">#&gt; rank[TNK]       3.48 1.26    2   3   3   4     6     4551     3582    1</span>
<span class="co">#&gt; rank[UK]        3.93 2.70    1   2   3   5     9     4520       NA    1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">thrombo_ranks</span><span class="op">)</span></code></pre></div>
<p><img src="example_thrombolytics_files/figure-html/thrombo_ranks-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">thrombo_rankprobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_ranks.html">posterior_rank_probs</a></span><span class="op">(</span><span class="va">thrombo_fit</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;              p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6] p_rank[7] p_rank[8]</span>
<span class="co">#&gt; d[SK]             0.00      0.00      0.00      0.00      0.02      0.14      0.38      0.30</span>
<span class="co">#&gt; d[Acc t-PA]       0.00      0.20      0.46      0.30      0.04      0.00      0.00      0.00</span>
<span class="co">#&gt; d[ASPAC]          0.00      0.00      0.00      0.00      0.02      0.09      0.19      0.26</span>
<span class="co">#&gt; d[PTCA]           0.87      0.12      0.00      0.00      0.00      0.00      0.00      0.00</span>
<span class="co">#&gt; d[r-PA]           0.00      0.06      0.13      0.30      0.39      0.08      0.02      0.01</span>
<span class="co">#&gt; d[SK + t-PA]      0.00      0.00      0.01      0.06      0.25      0.46      0.09      0.06</span>
<span class="co">#&gt; d[t-PA]           0.00      0.00      0.00      0.01      0.04      0.14      0.29      0.33</span>
<span class="co">#&gt; d[TNK]            0.00      0.24      0.32      0.24      0.14      0.04      0.01      0.00</span>
<span class="co">#&gt; d[UK]             0.12      0.37      0.07      0.09      0.10      0.05      0.02      0.03</span>
<span class="co">#&gt;              p_rank[9]</span>
<span class="co">#&gt; d[SK]             0.16</span>
<span class="co">#&gt; d[Acc t-PA]       0.00</span>
<span class="co">#&gt; d[ASPAC]          0.43</span>
<span class="co">#&gt; d[PTCA]           0.00</span>
<span class="co">#&gt; d[r-PA]           0.01</span>
<span class="co">#&gt; d[SK + t-PA]      0.06</span>
<span class="co">#&gt; d[t-PA]           0.19</span>
<span class="co">#&gt; d[TNK]            0.01</span>
<span class="co">#&gt; d[UK]             0.15</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">thrombo_rankprobs</span><span class="op">)</span></code></pre></div>
<p><img src="example_thrombolytics_files/figure-html/thrombo_rankprobs-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">thrombo_cumrankprobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_ranks.html">posterior_rank_probs</a></span><span class="op">(</span><span class="va">thrombo_fit</span>, cumulative <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;              p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6] p_rank[7] p_rank[8]</span>
<span class="co">#&gt; d[SK]             0.00      0.00      0.00      0.00      0.02      0.16      0.54      0.84</span>
<span class="co">#&gt; d[Acc t-PA]       0.00      0.20      0.66      0.96      1.00      1.00      1.00      1.00</span>
<span class="co">#&gt; d[ASPAC]          0.00      0.00      0.00      0.00      0.02      0.11      0.31      0.57</span>
<span class="co">#&gt; d[PTCA]           0.87      1.00      1.00      1.00      1.00      1.00      1.00      1.00</span>
<span class="co">#&gt; d[r-PA]           0.00      0.06      0.20      0.50      0.89      0.97      0.98      0.99</span>
<span class="co">#&gt; d[SK + t-PA]      0.00      0.00      0.02      0.08      0.33      0.79      0.88      0.94</span>
<span class="co">#&gt; d[t-PA]           0.00      0.00      0.00      0.01      0.04      0.19      0.47      0.81</span>
<span class="co">#&gt; d[TNK]            0.00      0.24      0.56      0.80      0.94      0.98      0.99      0.99</span>
<span class="co">#&gt; d[UK]             0.12      0.49      0.56      0.65      0.75      0.80      0.82      0.85</span>
<span class="co">#&gt;              p_rank[9]</span>
<span class="co">#&gt; d[SK]                1</span>
<span class="co">#&gt; d[Acc t-PA]          1</span>
<span class="co">#&gt; d[ASPAC]             1</span>
<span class="co">#&gt; d[PTCA]              1</span>
<span class="co">#&gt; d[r-PA]              1</span>
<span class="co">#&gt; d[SK + t-PA]         1</span>
<span class="co">#&gt; d[t-PA]              1</span>
<span class="co">#&gt; d[TNK]               1</span>
<span class="co">#&gt; d[UK]                1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">thrombo_cumrankprobs</span><span class="op">)</span></code></pre></div>
<p><img src="example_thrombolytics_files/figure-html/thrombo_cumrankprobs-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-Boland2003">
<p>Boland, A., Y. Dundar, A. Bagust, A. Haycox, R. Hill, R. Mujica Mota, T. Walley, and R. Dickson. 2003. “Early Thrombolysis for the Treatment of Acute Myocardial Infarction: A Systematic Review and Economic Evaluation.” <em>Health Technology Assessment</em> 7 (15). <a href="https://doi.org/10.3310/hta7150" class="external-link">https://doi.org/10.3310/hta7150</a>.</p>
</div>
<div id="ref-TSD4">
<p>Dias, S., N. J. Welton, A. J. Sutton, D. M. Caldwell, G. Lu, and A. E. Ades. 2011. “NICE DSU Technical Support Document 4: Inconsistency in Networks of Evidence Based on Randomised Controlled Trials.” National Institute for Health and Care Excellence. <a href="http://nicedsu.org.uk/" class="external-link">http://nicedsu.org.uk/</a>.</p>
</div>
<div id="ref-Lu2006">
<p>Lu, G. B., and A. E. Ades. 2006. “Assessing Evidence Inconsistency in Mixed Treatment Comparisons.” <em>Journal of the American Statistical Association</em> 101 (474): 447–59. <a href="https://doi.org/10.1198/016214505000001302" class="external-link">https://doi.org/10.1198/016214505000001302</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David M. Phillippo.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
