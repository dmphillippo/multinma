<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="multinma">
<title>Example: Plaque psoriasis ML-NMR • multinma</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.2/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Example: Plaque psoriasis ML-NMR">
<meta property="og:description" content="multinma">
<meta property="og:image" content="https://dmphillippo.github.io/multinma/logo.svg">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">multinma</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.4.2.9004</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vignette_overview.html">Overview of Examples</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Examples</h6>
    <a class="dropdown-item" href="../articles/example_atrial_fibrillation.html">Example: Atrial fibrillation</a>
    <a class="dropdown-item" href="../articles/example_bcg_vaccine.html">Example: BCG vaccine for tuberculosis</a>
    <a class="dropdown-item" href="../articles/example_blocker.html">Example: Beta blockers</a>
    <a class="dropdown-item" href="../articles/example_diabetes.html">Example: Diabetes</a>
    <a class="dropdown-item" href="../articles/example_dietary_fat.html">Example: Dietary fat</a>
    <a class="dropdown-item" href="../articles/example_hta_psoriasis.html">Example: Plaque psoriasis HTA report</a>
    <a class="dropdown-item" href="../articles/example_parkinsons.html">Example: Parkinson's disease</a>
    <a class="dropdown-item" href="../articles/example_plaque_psoriasis.html">Example: Plaque psoriasis ML-NMR</a>
    <a class="dropdown-item" href="../articles/example_smoking.html">Example: Smoking cessation</a>
    <a class="dropdown-item" href="../articles/example_statins.html">Example: Statins for cholesterol lowering</a>
    <a class="dropdown-item" href="../articles/example_thrombolytics.html">Example: Thrombolytic treatments</a>
    <a class="dropdown-item" href="../articles/example_transfusion.html">Example: White blood cell transfusion</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dmphillippo/multinma/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Example: Plaque psoriasis ML-NMR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dmphillippo/multinma/blob/HEAD/vignettes/example_plaque_psoriasis.Rmd" class="external-link"><code>vignettes/example_plaque_psoriasis.Rmd</code></a></small>
      <div class="d-none name"><code>example_plaque_psoriasis.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dmphillippo.github.io/multinma/">multinma</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; For execution on a local, multicore CPU with excess RAM we recommend calling</span></span>
<span><span class="co">#&gt; options(mc.cores = parallel::detectCores())</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'multinma'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     dgamma, pgamma, qgamma</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>      <span class="co"># dplyr and tidyr for data manipulation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>    <span class="co"># ggplot2 for plotting covariate distributions</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Simulated individual patient data (IPD) from trials comparing treatments for plaque psoriasis are found in the data set <code>plaque_psoriasis_ipd</code>. Aggregate data (AgD) are available on a further set of trials, found in the data set <code>plaque_psoriasis_agd</code>. In this vignette, we recreate the multilevel network meta-regression (ML-NMR) analyses performed by <span class="citation">Phillippo et al. (<a href="#ref-methods_paper" role="doc-biblioref">2020</a>)</span> and <span class="citation">Phillippo et al. (<a href="#ref-Phillippo2022" role="doc-biblioref">2022</a>; see also <a href="#ref-Phillippo_thesis" role="doc-biblioref">Phillippo 2019</a>)</span>.</p>
<p>In the <a href="#initial_analysis">first analysis</a> <span class="citation">(<a href="#ref-methods_paper" role="doc-biblioref">Phillippo et al. 2020</a>)</span>, we consider a network of four studies with a binary outcome (success/failure to achieve a 75% reduction on the psoriasis area and severity index, PASI 75).</p>
<p>In the <a href="#extended_analysis">second analysis</a> <span class="citation">(<a href="#ref-Phillippo2022" role="doc-biblioref">Phillippo et al. 2022</a>)</span>, we extend this network with a further five studies and demonstrate how the key assumptions of population adjustment can be assessed in this larger network. We also demonstrate how to produce estimates for three external target populations, and fit a multinomial model to incorporate ordered categorical outcomes (PASI 75, PASI 90, and PASI 100).</p>
<div class="section level2">
<h2 id="initial_analysis">Initial analysis<a class="anchor" aria-label="anchor" href="#initial_analysis"></a>
</h2>
<p>We start by recreating the analysis presented by <span class="citation">Phillippo et al. (<a href="#ref-methods_paper" role="doc-biblioref">2020</a>)</span>. We will analyse IPD from three studies, UNCOVER-1, UNCOVER-2, and UNCOVER-3 <span class="citation">(<a href="#ref-Griffiths2015" role="doc-biblioref">Griffiths et al. 2015</a>; <a href="#ref-Gordon2016" role="doc-biblioref">Gordon et al. 2016</a>)</span>, and AgD from one study, FIXTURE <span class="citation">(<a href="#ref-Langley2014" role="doc-biblioref">Langley et al. 2014</a>)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_ipd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plaque_psoriasis_ipd</span>,</span>
<span>                  <span class="va">studyc</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UNCOVER-1"</span>, <span class="st">"UNCOVER-2"</span>, <span class="st">"UNCOVER-3"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pso_agd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plaque_psoriasis_agd</span>,</span>
<span>                  <span class="va">studyc</span> <span class="op">==</span> <span class="st">"FIXTURE"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pso_ipd</span><span class="op">)</span></span>
<span><span class="co">#&gt;      studyc      trtc_long    trtc trtn pasi75 pasi90 pasi100 age  bmi pasi_w0  male bsa</span></span>
<span><span class="co">#&gt; 1 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      0      0       0  34 32.2    18.2  TRUE  18</span></span>
<span><span class="co">#&gt; 2 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      1      0       0  64 41.9    23.4  TRUE  33</span></span>
<span><span class="co">#&gt; 3 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      1      1       0  42 26.2    12.8  TRUE  33</span></span>
<span><span class="co">#&gt; 4 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      0      0       0  45 52.9    36.0 FALSE  50</span></span>
<span><span class="co">#&gt; 5 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      1      0       0  67 22.9    20.9 FALSE  35</span></span>
<span><span class="co">#&gt; 6 UNCOVER-1 Ixekizumab Q2W IXE_Q2W    2      1      1       1  57 22.4    18.2  TRUE  29</span></span>
<span><span class="co">#&gt;   weight durnpso prevsys   psa</span></span>
<span><span class="co">#&gt; 1   98.1     6.7    TRUE  TRUE</span></span>
<span><span class="co">#&gt; 2  129.6    14.5   FALSE  TRUE</span></span>
<span><span class="co">#&gt; 3   78.0    26.5    TRUE FALSE</span></span>
<span><span class="co">#&gt; 4  139.9    25.0    TRUE  TRUE</span></span>
<span><span class="co">#&gt; 5   54.2    11.9    TRUE FALSE</span></span>
<span><span class="co">#&gt; 6   67.5    15.2    TRUE FALSE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pso_agd</span><span class="op">)</span></span>
<span><span class="co">#&gt;    studyc          trtc_long    trtc trtn pasi75_r pasi75_n pasi90_r pasi90_n pasi100_r</span></span>
<span><span class="co">#&gt; 1 FIXTURE         Etanercept     ETN    4      142      323       67      323        14</span></span>
<span><span class="co">#&gt; 2 FIXTURE            Placebo     PBO    1       16      324        5      324         0</span></span>
<span><span class="co">#&gt; 3 FIXTURE Secukinumab 150 mg SEC_150    5      219      327      137      327        47</span></span>
<span><span class="co">#&gt; 4 FIXTURE Secukinumab 300 mg SEC_300    6      249      323      175      323        78</span></span>
<span><span class="co">#&gt;   pasi100_n sample_size_w0 age_mean age_sd bmi_mean bmi_sd pasi_w0_mean pasi_w0_sd male</span></span>
<span><span class="co">#&gt; 1       323            326     43.8   13.0     28.7    5.9         23.2        9.8 71.2</span></span>
<span><span class="co">#&gt; 2       324            326     44.1   12.6     27.9    6.1         24.1       10.5 72.7</span></span>
<span><span class="co">#&gt; 3       327            327     45.4   12.9     28.4    5.9         23.7       10.5 72.2</span></span>
<span><span class="co">#&gt; 4       323            327     44.5   13.2     28.4    6.4         23.9        9.9 68.5</span></span>
<span><span class="co">#&gt;   bsa_mean bsa_sd weight_mean weight_sd durnpso_mean durnpso_sd prevsys  psa</span></span>
<span><span class="co">#&gt; 1     33.6   18.0        84.6      20.5         16.4       12.0    65.6 13.5</span></span>
<span><span class="co">#&gt; 2     35.2   19.1        82.0      20.4         16.6       11.6    62.6 15.0</span></span>
<span><span class="co">#&gt; 3     34.5   19.4        83.6      20.8         17.3       12.2    64.8 15.0</span></span>
<span><span class="co">#&gt; 4     34.3   19.2        83.0      21.6         15.8       12.3    63.0 15.3</span></span></code></pre></div>
<p>We consider running a ML-NMR adjusting for five potential effect-modifying covariates: duration of psoriasis <code>durnpso</code>, weight <code>weight</code>, previous systemic treatment <code>prevsys</code>, body surface area <code>bsa</code>, and psoriatic arthritis <code>psa</code>.</p>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<div class="section level4">
<h4 id="preparing-the-data">Preparing the data<a class="anchor" aria-label="anchor" href="#preparing-the-data"></a>
</h4>
<p>We need to prepare the data so that it is in an acceptable format to run a ML-NMR model. Firstly, we need to handle the binary covariates <code>prevsys</code> and <code>psa</code>. In the IPD, these are coded as <code>TRUE</code> or <code>FALSE</code>, but in the AgD these are coded as percentages (out of 100). We need these to transform both of these sets of variables so that they are numeric and lie in the interval <span class="math inline">\([0,1]\)</span>, so that the variables are compatible across the data sources. Whilst we are here, we also transform body surface area <code>bsa</code> (a percentage) to lie in <span class="math inline">\([0,1]\)</span>, since that will make specifying an appropriate marginal distribution easier later, and rescale <code>weight</code> and <code>duration</code> to aid interpretation of the regression coefficients (in terms of 10 kilos and 10 years respectively). We also add in a <code>trtclass</code> variable, indicating which treatments belong to which classes. Finally, we check for missing values in the IPD.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_ipd</span> <span class="op">&lt;-</span> <span class="va">pso_ipd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="co"># Variable transformations</span></span>
<span>         bsa <span class="op">=</span> <span class="va">bsa</span> <span class="op">/</span> <span class="fl">100</span>,</span>
<span>         prevsys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">prevsys</span><span class="op">)</span>,</span>
<span>         psa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">psa</span><span class="op">)</span>,</span>
<span>         weight <span class="op">=</span> <span class="va">weight</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>         durnpso <span class="op">=</span> <span class="va">durnpso</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>         <span class="co"># Treatment classes</span></span>
<span>         trtclass <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">trtn</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Placebo"</span>,</span>
<span>                              <span class="va">trtn</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">~</span> <span class="st">"IL blocker"</span>,</span>
<span>                              <span class="va">trtn</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"TNFa blocker"</span><span class="op">)</span>,</span>
<span>         <span class="co"># Check complete cases for covariates of interest</span></span>
<span>         complete <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">durnpso</span>, <span class="va">prevsys</span>, <span class="va">bsa</span>, <span class="va">weight</span>, <span class="va">psa</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">pso_agd</span> <span class="op">&lt;-</span> <span class="va">pso_agd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Variable transformations</span></span>
<span>    bsa_mean <span class="op">=</span> <span class="va">bsa_mean</span> <span class="op">/</span> <span class="fl">100</span>,</span>
<span>    bsa_sd <span class="op">=</span> <span class="va">bsa_sd</span> <span class="op">/</span> <span class="fl">100</span>,</span>
<span>    prevsys <span class="op">=</span> <span class="va">prevsys</span> <span class="op">/</span> <span class="fl">100</span>,</span>
<span>    psa <span class="op">=</span> <span class="va">psa</span> <span class="op">/</span> <span class="fl">100</span>,</span>
<span>    weight_mean <span class="op">=</span> <span class="va">weight_mean</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>    weight_sd <span class="op">=</span> <span class="va">weight_sd</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>    durnpso_mean <span class="op">=</span> <span class="va">durnpso_mean</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>    durnpso_sd <span class="op">=</span> <span class="va">durnpso_sd</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>    <span class="co"># Treatment classes</span></span>
<span>    trtclass <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">trtn</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Placebo"</span>,</span>
<span>                              <span class="va">trtn</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">~</span> <span class="st">"IL blocker"</span>,</span>
<span>                              <span class="va">trtn</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"TNFa blocker"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>A small number of individuals have missing covariates:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">pso_ipd</span><span class="op">$</span><span class="va">complete</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">!</span><span class="va">pso_ipd</span><span class="op">$</span><span class="va">complete</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001036807</span></span></code></pre></div>
<p>Since the proportion of missing data is so small, we will simply exclude these individuals from the analysis.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_ipd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pso_ipd</span>, <span class="va">complete</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="creating-the-network">Creating the network<a class="anchor" aria-label="anchor" href="#creating-the-network"></a>
</h4>
<p>Set up the network, setting the IPD with <code><a href="../reference/set_ipd.html">set_ipd()</a></code>, AgD (arm-based) with <code><a href="../reference/set_agd_arm.html">set_agd_arm()</a></code>, and combining together using <code><a href="../reference/combine_network.html">combine_network()</a></code>. We specify the binary <code>pasi75</code> outcome as <code>r</code> in the IPD, and the count outcome <code>pasi75_r</code> and denominator <code>pasi75_n</code> as <code>r</code> and <code>n</code> in the AgD. We specify the treatment classes with <code>trt_class = trtclass</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_network.html">combine_network</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/set_ipd.html">set_ipd</a></span><span class="op">(</span><span class="va">pso_ipd</span>, </span>
<span>          study <span class="op">=</span> <span class="va">studyc</span>, </span>
<span>          trt <span class="op">=</span> <span class="va">trtc</span>, </span>
<span>          r <span class="op">=</span> <span class="va">pasi75</span>,</span>
<span>          trt_class <span class="op">=</span> <span class="va">trtclass</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/set_agd_arm.html">set_agd_arm</a></span><span class="op">(</span><span class="va">pso_agd</span>, </span>
<span>              study <span class="op">=</span> <span class="va">studyc</span>, </span>
<span>              trt <span class="op">=</span> <span class="va">trtc</span>, </span>
<span>              r <span class="op">=</span> <span class="va">pasi75_r</span>, </span>
<span>              n <span class="op">=</span> <span class="va">pasi75_n</span>,</span>
<span>              trt_class <span class="op">=</span> <span class="va">trtclass</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pso_net</span></span>
<span><span class="co">#&gt; A network with 3 IPD studies, and 1 AgD study (arm-based).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">-------------------------------------------------------------------</span> <span style="font-weight: bold;">IPD studies</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt;  Study     Treatment arms                  </span></span>
<span><span class="co">#&gt;  UNCOVER-1 3: IXE_Q2W | IXE_Q4W | PBO      </span></span>
<span><span class="co">#&gt;  UNCOVER-2 4: ETN | IXE_Q2W | IXE_Q4W | PBO</span></span>
<span><span class="co">#&gt;  UNCOVER-3 4: ETN | IXE_Q2W | IXE_Q4W | PBO</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Outcome type: binary</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">-------------------------------------------------------</span> <span style="font-weight: bold;">AgD studies (arm-based)</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt;  Study   Treatment arms                  </span></span>
<span><span class="co">#&gt;  FIXTURE 4: PBO | ETN | SEC_150 | SEC_300</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Outcome type: count</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">------------------------------------------------------------------------------------</span></span></span>
<span><span class="co">#&gt; Total number of treatments: 6, in 3 classes</span></span>
<span><span class="co">#&gt; Total number of studies: 4</span></span>
<span><span class="co">#&gt; Reference treatment is: PBO</span></span>
<span><span class="co">#&gt; Network is <span style="color: #00BB00;">connected</span></span></span></code></pre></div>
<p>We can produce a network plot with the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_net</span>, weight_nodes <span class="op">=</span> <span class="cn">TRUE</span>, weight_edges <span class="op">=</span> <span class="cn">TRUE</span>, show_trt_class <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.box <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_network_plot-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="numerical-integration-for-ml-nmr">Numerical integration for ML-NMR<a class="anchor" aria-label="anchor" href="#numerical-integration-for-ml-nmr"></a>
</h4>
<p>ML-NMR models define the meta-regression model at the individual level, in exactly the same manner as a full-IPD meta-regression. ML-NMR then incorporates the AgD into the model by integrating this individual-level model over the covariate distribution in each AgD study <span class="citation">(<a href="#ref-methods_paper" role="doc-biblioref">Phillippo et al. 2020</a>; <a href="#ref-Phillippo_thesis" role="doc-biblioref">Phillippo 2019</a>)</span>. Using integration, instead of simply “plugging-in” mean covariate values for the AgD studies, avoids aggregation bias when the link function is not the identity function.</p>
<p>This package utilises numerical integration to incorporate the aggregate data - specifically, quasi-Monte Carlo (QMC) integration with a Gaussian copula <span class="citation">(<a href="#ref-methods_paper" role="doc-biblioref">Phillippo et al. 2020</a>; <a href="#ref-Phillippo_thesis" role="doc-biblioref">Phillippo 2019</a>)</span>. QMC integration is a very general and flexible integration approach, which typically requires far fewer integration points than standard (pseudo-random) Monte-Carlo integration to achieve the same numerical accuracy.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The convergence rate of QMC is typically &lt;span class="math inline"&gt;\(\mathcal{O}(1/n)\)&lt;/span&gt;, whereas the expected convergence rate of standard MC is &lt;span class="math inline"&gt;\(\mathcal{O}(1/n^\frac{1}{2})\)&lt;/span&gt; &lt;span class="citation"&gt;(&lt;a href="#ref-Caflisch1998" role="doc-biblioref"&gt;Caflisch 1998&lt;/a&gt;; &lt;a href="#ref-Niederreiter1978" role="doc-biblioref"&gt;Niederreiter 1978&lt;/a&gt;)&lt;/span&gt;.&lt;/p&gt;'><sup>1</sup></a> A Gaussian copula allows us to account for correlations between covariates, which may have any specified marginal distributions.</p>
<p>We now set up the numerical integration for the network. The five covariates that we will consider adjusting for are body surface area <code>bsa</code>, duration of psoriasis <code>durnpso</code>, previous systemic treatment <code>prevsys</code>, psoriatic arthritis <code>psa</code>, and weight <code>weight</code>. We need to choose suitable marginal distributions for these covariates to draw the integration points from. <code>prevsys</code> and <code>psa</code> are binary covariates, so these are given a Bernoulli distribution. <code>bsa</code> is a percentage, so we choose a logit-Normal distribution (note, this requires the <code>logitnorm</code> package to be installed). We choose Gamma distributions for <code>durnpso</code> and <code>weight</code> to account for skewness. These choices seem to match well the marginal distributions observed in the IPD:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get mean and sd of covariates in each study</span></span>
<span><span class="va">ipd_summary</span> <span class="op">&lt;-</span> <span class="va">pso_ipd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">studyc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarise_at</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">weight</span>, <span class="va">durnpso</span>, <span class="va">bsa</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span>, min <span class="op">=</span> <span class="va">min</span>, max <span class="op">=</span> <span class="va">max</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">weight_mean</span><span class="op">:</span><span class="va">bsa_max</span>, names_sep <span class="op">=</span> <span class="st">"_"</span>, names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covariate"</span>, <span class="st">".value"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># Assign distributions</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">covariate</span>,</span>
<span>                       bsa <span class="op">=</span> <span class="st">"dlogitnorm"</span>,</span>
<span>                       durnpso <span class="op">=</span> <span class="st">"dgamma"</span>,</span>
<span>                       weight <span class="op">=</span> <span class="st">"dgamma"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># Compute density curves</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">studyc</span>, <span class="va">covariate</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"dlogitnorm"</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">101</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">min</span><span class="op">*</span><span class="fl">0.8</span>, <span class="va">max</span><span class="op">*</span><span class="fl">1.2</span>, length.out <span class="op">=</span> <span class="fl">101</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html" class="external-link">call</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">first</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">value</span>, mean <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">first</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">first</a></span><span class="op">(</span><span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot histograms and assumed densities</span></span>
<span><span class="va">pso_ipd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">weight</span>, <span class="va">durnpso</span>, <span class="va">bsa</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"covariate"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                 binwidth <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/nclass.html" class="external-link">nclass.Sturges</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 boundary <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                 fill <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">dens</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">ipd_summary</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"darkred"</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">studyc</span> <span class="op">+</span> <span class="va">covariate</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_multinma.html">theme_multinma</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_covariate_plot-1.png" width="700" style="display: block; margin: auto;"></p>
<p>We add integration points to the AgD studies in the network using the <code><a href="../reference/add_integration.html">add_integration()</a></code> function. Marginal distributions for each covariate are specified using the <code><a href="../reference/distr.html">distr()</a></code> function, which takes a cumulative distribution function corresponding to the chosen marginal distribution, and arguments to that distribution as column names in the aggregate data. Since we do not know the correlations between covariates in the AgD studies, we impute these with the weighted mean of the correlations in the IPD studies (the default option).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_integration.html">add_integration</a></span><span class="op">(</span><span class="va">pso_net</span>,</span>
<span>  durnpso <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">durnpso_mean</span>, sd <span class="op">=</span> <span class="va">durnpso_sd</span><span class="op">)</span>,</span>
<span>  prevsys <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">prevsys</span><span class="op">)</span>,</span>
<span>  bsa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qlogitnorm</span>, mean <span class="op">=</span> <span class="va">bsa_mean</span>, sd <span class="op">=</span> <span class="va">bsa_sd</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">weight_mean</span>, sd <span class="op">=</span> <span class="va">weight_sd</span><span class="op">)</span>,</span>
<span>  psa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">psa</span><span class="op">)</span>,</span>
<span>  n_int <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Using weighted average correlation matrix computed from IPD studies.</span></span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> This package provides several convenience functions for specifying these distributions, including <code><a href="../reference/GammaDist.html">qgamma()</a></code> which allows for a parameterisation of the Gamma distribution in terms of mean and standard deviation, <code><a href="../reference/Bernoulli.html">qbern()</a></code> which provides the Bernoulli distribution, and <code><a href="../reference/logitNormal.html">qlogitnorm()</a></code> which provides the logit-Normal distribution allowing for a parameterisation in terms of mean and standard deviation (requires the <code>logitnorm</code> package to be installed).</p>
</blockquote>
</div>
</div>
<div class="section level3">
<h3 id="ml-nmr-models">ML-NMR models<a class="anchor" aria-label="anchor" href="#ml-nmr-models"></a>
</h3>
<p>We fit both fixed effect (FE) and random effects (RE) ML-NMR models.</p>
<div class="section level4">
<h4 id="fixed-effect-ml-nmr">Fixed effect ML-NMR<a class="anchor" aria-label="anchor" href="#fixed-effect-ml-nmr"></a>
</h4>
<p>First, we fit a FE ML-NMR model using the function <code><a href="../reference/nma.html">nma()</a></code>. Following <span class="citation">(<a href="#ref-methods_paper" role="doc-biblioref">Phillippo et al. 2020</a>)</span> we specify weakly-informative <span class="math inline">\(N(0, 10^2)\)</span> priors on each parameter. The range of parameter values implied by these prior distributions can be checked using the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; A Normal prior distribution: location = 0, scale = 10.</span></span>
<span><span class="co">#&gt; 50% of the prior density lies between -6.74 and 6.74.</span></span>
<span><span class="co">#&gt; 95% of the prior density lies between -19.6 and 19.6.</span></span></code></pre></div>
<p>The regression model is specified with <code>regression = ~(durnpso + prevsys + bsa + weight + psa)*.trt</code>, which will include the main (prognostic) effects of each covariate as well as interactions with treatment. We use a probit link function (<code>link = "probit"</code>), and specify that the two-parameter Binomial approximation for the aggregate-level likelihood should be used (<code>likelihood = "bernoulli2"</code>, where “bernoulli” refers to the individual-level likelihood, and “2” denotes the two-parameter adjustment to the aggregate-level likelihood) <span class="citation">(<a href="#ref-methods_paper" role="doc-biblioref">Phillippo et al. 2020</a>)</span>. We utilise the shared effect modifier assumption to help identify the model, setting treatment-covariate interactions to be equal within each class (<code>class_interactions = "common"</code>). We narrow the possible range for random initial values with <code>init_r = 0.1</code> (the default is <code>init_r = 2</code>), since probit models in particular are often hard to initialise. Using the QR decomposition (<code>QR = TRUE</code>) greatly improves sampling efficiency here, as is often the case for regression models.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_fit_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">pso_net</span>, </span>
<span>                  trt_effects <span class="op">=</span> <span class="st">"fixed"</span>,</span>
<span>                  link <span class="op">=</span> <span class="st">"probit"</span>, </span>
<span>                  likelihood <span class="op">=</span> <span class="st">"bernoulli2"</span>,</span>
<span>                  regression <span class="op">=</span> <span class="op">~</span><span class="op">(</span><span class="va">durnpso</span> <span class="op">+</span> <span class="va">prevsys</span> <span class="op">+</span> <span class="va">bsa</span> <span class="op">+</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">psa</span><span class="op">)</span><span class="op">*</span><span class="va">.trt</span>,</span>
<span>                  class_interactions <span class="op">=</span> <span class="st">"common"</span>,</span>
<span>                  prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                  prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                  prior_reg <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                  init_r <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                  QR <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: Setting "PBO" as the network reference treatment.</span></span></code></pre></div>
<p>Basic parameter summaries are given by the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pso_fit_FE</span><span class="op">)</span></span>
<span><span class="co">#&gt; A fixed effects ML-NMR with a bernoulli2 likelihood (probit link).</span></span>
<span><span class="co">#&gt; Regression model: ~(durnpso + prevsys + bsa + weight + psa) * .trt.</span></span>
<span><span class="co">#&gt; Centred covariates at the following overall mean values:</span></span>
<span><span class="co">#&gt;   durnpso   prevsys       bsa    weight       psa </span></span>
<span><span class="co">#&gt; 1.8259772 0.6496080 0.2917665 8.9328237 0.2167777 </span></span>
<span><span class="co">#&gt; Inference for Stan model: binomial_2par.</span></span>
<span><span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span></span>
<span><span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                         mean se_mean   sd     2.5%      25%      50%      75%</span></span>
<span><span class="co">#&gt; beta[durnpso]                           0.04    0.00 0.06    -0.08     0.00     0.04     0.09</span></span>
<span><span class="co">#&gt; beta[prevsys]                          -0.14    0.00 0.16    -0.45    -0.24    -0.14    -0.03</span></span>
<span><span class="co">#&gt; beta[bsa]                              -0.06    0.01 0.44    -0.99    -0.35    -0.07     0.24</span></span>
<span><span class="co">#&gt; beta[weight]                            0.04    0.00 0.03    -0.02     0.02     0.04     0.06</span></span>
<span><span class="co">#&gt; beta[psa]                              -0.08    0.00 0.17    -0.41    -0.19    -0.07     0.04</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]    -0.03    0.00 0.07    -0.17    -0.08    -0.03     0.02</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL blocker]      -0.01    0.00 0.07    -0.14    -0.06    -0.01     0.03</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]     0.19    0.00 0.19    -0.18     0.06     0.19     0.32</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL blocker]       0.06    0.00 0.18    -0.29    -0.06     0.06     0.18</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]         0.05    0.01 0.52    -0.93    -0.30     0.05     0.38</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL blocker]           0.29    0.01 0.49    -0.64    -0.04     0.29     0.60</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassTNFa blocker]     -0.17    0.00 0.04    -0.24    -0.19    -0.17    -0.14</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL blocker]       -0.10    0.00 0.03    -0.16    -0.12    -0.10    -0.08</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassTNFa blocker]        -0.06    0.00 0.21    -0.45    -0.20    -0.06     0.08</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL blocker]           0.01    0.00 0.19    -0.36    -0.12     0.01     0.13</span></span>
<span><span class="co">#&gt; d[ETN]                                  1.55    0.00 0.08     1.40     1.50     1.55     1.61</span></span>
<span><span class="co">#&gt; d[IXE_Q2W]                              2.95    0.00 0.09     2.79     2.90     2.95     3.01</span></span>
<span><span class="co">#&gt; d[IXE_Q4W]                              2.54    0.00 0.08     2.38     2.48     2.54     2.59</span></span>
<span><span class="co">#&gt; d[SEC_150]                              2.14    0.00 0.12     1.92     2.07     2.15     2.22</span></span>
<span><span class="co">#&gt; d[SEC_300]                              2.45    0.00 0.12     2.21     2.37     2.45     2.54</span></span>
<span><span class="co">#&gt; lp__                                -1576.51    0.09 3.55 -1584.53 -1578.70 -1576.10 -1573.98</span></span>
<span><span class="co">#&gt;                                        97.5% n_eff Rhat</span></span>
<span><span class="co">#&gt; beta[durnpso]                           0.17  5420    1</span></span>
<span><span class="co">#&gt; beta[prevsys]                           0.18  5285    1</span></span>
<span><span class="co">#&gt; beta[bsa]                               0.78  3988    1</span></span>
<span><span class="co">#&gt; beta[weight]                            0.10  4484    1</span></span>
<span><span class="co">#&gt; beta[psa]                               0.24  5700    1</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]     0.12  5365    1</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL blocker]       0.12  6426    1</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]     0.56  5502    1</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL blocker]       0.40  6958    1</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]         1.10  4940    1</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL blocker]           1.27  5461    1</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassTNFa blocker]     -0.10  5209    1</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL blocker]       -0.03  5711    1</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassTNFa blocker]         0.35  5933    1</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL blocker]           0.37  7246    1</span></span>
<span><span class="co">#&gt; d[ETN]                                  1.71  4345    1</span></span>
<span><span class="co">#&gt; d[IXE_Q2W]                              3.13  4977    1</span></span>
<span><span class="co">#&gt; d[IXE_Q4W]                              2.71  4809    1</span></span>
<span><span class="co">#&gt; d[SEC_150]                              2.36  5605    1</span></span>
<span><span class="co">#&gt; d[SEC_300]                              2.70  6451    1</span></span>
<span><span class="co">#&gt; lp__                                -1570.56  1509    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Mon Aug 29 15:12:23 2022.</span></span>
<span><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span><span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span></span>
<span><span class="co">#&gt; convergence, Rhat=1).</span></span></code></pre></div>
<p>By default, summaries of the study-specific intercepts <span class="math inline">\(\mu_j\)</span> are hidden, but could be examined by changing the <code>pars</code> argument:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Not run</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"beta"</span>, <span class="st">"mu"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The prior and posterior distributions can be compared visually using the <code><a href="../reference/plot_prior_posterior.html">plot_prior_posterior()</a></code> function:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_prior_posterior.html">plot_prior_posterior</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intercept"</span>, <span class="st">"trt"</span>, <span class="st">"reg"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_FE_pp_plot-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Plots of estimated numerical integration error are produced using the <code><a href="../reference/plot_integration_error.html">plot_integration_error()</a></code> function:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_integration_error.html">plot_integration_error</a></span><span class="op">(</span><span class="va">pso_fit_FE</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_FE_cumint-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="random-effects-ml-nmr">Random effects ML-NMR<a class="anchor" aria-label="anchor" href="#random-effects-ml-nmr"></a>
</h4>
<p>We now fit a RE model. Again, we specify weakly-informative <span class="math inline">\(N(0, 10^2)\)</span> priors on each parameter, and now specify a <span class="math inline">\(\textrm{half-N}(0, 2.5^2)\)</span> prior for the heterogeneity standard deviation <span class="math inline">\(\tau\)</span>. The range of parameter values implied by these prior distributions can be checked using the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; A Normal prior distribution: location = 0, scale = 10.</span></span>
<span><span class="co">#&gt; 50% of the prior density lies between -6.74 and 6.74.</span></span>
<span><span class="co">#&gt; 95% of the prior density lies between -19.6 and 19.6.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">half_normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; A half-Normal prior distribution: location = 0, scale = 2.5.</span></span>
<span><span class="co">#&gt; 50% of the prior density lies between 0 and 1.69.</span></span>
<span><span class="co">#&gt; 95% of the prior density lies between 0 and 4.9.</span></span></code></pre></div>
<p>Fitting the model uses the same call to <code><a href="../reference/nma.html">nma()</a></code> as before, except now with <code>trt_effects = "random"</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_fit_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">pso_net</span>, </span>
<span>                  trt_effects <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>                  link <span class="op">=</span> <span class="st">"probit"</span>, </span>
<span>                  likelihood <span class="op">=</span> <span class="st">"bernoulli2"</span>,</span>
<span>                  regression <span class="op">=</span> <span class="op">~</span><span class="op">(</span><span class="va">durnpso</span> <span class="op">+</span> <span class="va">prevsys</span> <span class="op">+</span> <span class="va">bsa</span> <span class="op">+</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">psa</span><span class="op">)</span><span class="op">*</span><span class="va">.trt</span>,</span>
<span>                  class_interactions <span class="op">=</span> <span class="st">"common"</span>,</span>
<span>                  prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                  prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                  prior_reg <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                  prior_het <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">half_normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>                  init_r <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                  QR <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: Setting "PBO" as the network reference treatment.</span></span>
<span><span class="co">#&gt; Warning: There were 11 divergent transitions after warmup. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span></span>
<span><span class="co">#&gt; to find out why this is a problem and how to eliminate them.</span></span>
<span><span class="co">#&gt; Warning: Examine the pairs() plot to diagnose sampling problems</span></span></code></pre></div>
<p>Basic parameter summaries are given by the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pso_fit_RE</span><span class="op">)</span></span>
<span><span class="co">#&gt; A random effects ML-NMR with a bernoulli2 likelihood (probit link).</span></span>
<span><span class="co">#&gt; Regression model: ~(durnpso + prevsys + bsa + weight + psa) * .trt.</span></span>
<span><span class="co">#&gt; Centred covariates at the following overall mean values:</span></span>
<span><span class="co">#&gt;   durnpso   prevsys       bsa    weight       psa </span></span>
<span><span class="co">#&gt; 1.8259772 0.6496080 0.2917665 8.9328237 0.2167777 </span></span>
<span><span class="co">#&gt; Inference for Stan model: binomial_2par.</span></span>
<span><span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span></span>
<span><span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                         mean se_mean   sd     2.5%      25%      50%      75%</span></span>
<span><span class="co">#&gt; beta[durnpso]                           0.05    0.00 0.06    -0.07     0.01     0.05     0.09</span></span>
<span><span class="co">#&gt; beta[prevsys]                          -0.12    0.00 0.16    -0.43    -0.23    -0.12    -0.02</span></span>
<span><span class="co">#&gt; beta[bsa]                              -0.10    0.01 0.46    -1.05    -0.39    -0.09     0.21</span></span>
<span><span class="co">#&gt; beta[weight]                            0.04    0.00 0.03    -0.01     0.02     0.04     0.06</span></span>
<span><span class="co">#&gt; beta[psa]                              -0.06    0.00 0.17    -0.40    -0.17    -0.06     0.06</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]    -0.04    0.00 0.07    -0.18    -0.08    -0.04     0.01</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL blocker]      -0.02    0.00 0.07    -0.15    -0.06    -0.02     0.03</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]     0.18    0.00 0.19    -0.20     0.05     0.18     0.31</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL blocker]       0.05    0.00 0.17    -0.28    -0.07     0.05     0.17</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]         0.09    0.01 0.53    -0.93    -0.26     0.08     0.42</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL blocker]           0.34    0.01 0.51    -0.62     0.00     0.31     0.67</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassTNFa blocker]     -0.17    0.00 0.04    -0.24    -0.20    -0.17    -0.15</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL blocker]       -0.10    0.00 0.03    -0.16    -0.13    -0.10    -0.08</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassTNFa blocker]        -0.07    0.00 0.21    -0.47    -0.21    -0.08     0.06</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL blocker]          -0.01    0.00 0.19    -0.38    -0.14    -0.02     0.11</span></span>
<span><span class="co">#&gt; d[ETN]                                  1.55    0.00 0.14     1.27     1.47     1.55     1.64</span></span>
<span><span class="co">#&gt; d[IXE_Q2W]                              2.97    0.00 0.15     2.68     2.89     2.97     3.05</span></span>
<span><span class="co">#&gt; d[IXE_Q4W]                              2.56    0.00 0.14     2.28     2.47     2.56     2.65</span></span>
<span><span class="co">#&gt; d[SEC_150]                              2.13    0.01 0.24     1.67     2.00     2.12     2.25</span></span>
<span><span class="co">#&gt; d[SEC_300]                              2.44    0.00 0.22     2.01     2.31     2.44     2.57</span></span>
<span><span class="co">#&gt; lp__                                -1580.69    0.15 4.77 -1590.76 -1583.73 -1580.37 -1577.34</span></span>
<span><span class="co">#&gt; tau                                     0.18    0.00 0.12     0.01     0.10     0.16     0.24</span></span>
<span><span class="co">#&gt;                                        97.5% n_eff Rhat</span></span>
<span><span class="co">#&gt; beta[durnpso]                           0.17  4266 1.00</span></span>
<span><span class="co">#&gt; beta[prevsys]                           0.20  4221 1.00</span></span>
<span><span class="co">#&gt; beta[bsa]                               0.76  3569 1.00</span></span>
<span><span class="co">#&gt; beta[weight]                            0.10  3720 1.00</span></span>
<span><span class="co">#&gt; beta[psa]                               0.27  4721 1.00</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]     0.11  4934 1.00</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL blocker]       0.12  5306 1.00</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]     0.54  4881 1.00</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL blocker]       0.39  4913 1.00</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]         1.16  3821 1.00</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL blocker]           1.38  4335 1.00</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassTNFa blocker]     -0.10  3955 1.00</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL blocker]       -0.04  4278 1.00</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassTNFa blocker]         0.33  5386 1.00</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL blocker]           0.36  5874 1.00</span></span>
<span><span class="co">#&gt; d[ETN]                                  1.85  1844 1.00</span></span>
<span><span class="co">#&gt; d[IXE_Q2W]                              3.28  1789 1.00</span></span>
<span><span class="co">#&gt; d[IXE_Q4W]                              2.86  1810 1.00</span></span>
<span><span class="co">#&gt; d[SEC_150]                              2.60  1647 1.00</span></span>
<span><span class="co">#&gt; d[SEC_300]                              2.90  2361 1.00</span></span>
<span><span class="co">#&gt; lp__                                -1572.07  1046 1.01</span></span>
<span><span class="co">#&gt; tau                                     0.45   557 1.01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Mon Aug 29 15:21:46 2022.</span></span>
<span><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span><span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span></span>
<span><span class="co">#&gt; convergence, Rhat=1).</span></span></code></pre></div>
<p>By default, summaries of the study-specific intercepts <span class="math inline">\(\mu_j\)</span> and study-specific relative effects <span class="math inline">\(\delta_{jk}\)</span> are hidden, but could be examined by changing the <code>pars</code> argument:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Not run</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pso_fit_RE</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"beta"</span>, <span class="st">"tau"</span>, <span class="st">"mu"</span>, <span class="st">"delta"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>There are a number of divergent transitions, which we can investigate using the <code><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs()</a></code> method:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">pso_fit_RE</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"delta[UNCOVER-2: ETN]"</span>, <span class="st">"d[ETN]"</span>, <span class="st">"tau"</span>, <span class="st">"lp__"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_RE_pairs-1.png" width="700" style="display: block; margin: auto;"></p>
<p>The divergent transition errors (red crosses) seem to be concentrated in the upper tail of the heterogeneity standard deviation parameter. This suggests that the information to identify the heterogeneity parameter is weak - we have only four studies in the network - and that a more informative prior distribution might aid estimation.</p>
<p>The prior and posterior distributions can be compared visually using the <code><a href="../reference/plot_prior_posterior.html">plot_prior_posterior()</a></code> function:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_prior_posterior.html">plot_prior_posterior</a></span><span class="op">(</span><span class="va">pso_fit_RE</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intercept"</span>, <span class="st">"trt"</span>, <span class="st">"reg"</span>, <span class="st">"het"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_RE_pp_plot-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Plots of estimated numerical integration error are produced using the <code><a href="../reference/plot_integration_error.html">plot_integration_error()</a></code> function:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_integration_error.html">plot_integration_error</a></span><span class="op">(</span><span class="va">pso_fit_RE</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_RE_cumint-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="model-comparison">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h3>
<p>The model fit under the FE and RE models can be checked using the <code><a href="../reference/dic.html">dic()</a></code> function.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_dic_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">pso_fit_FE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Residual deviance: 3129.8<span style="color: #555555;"> (on 3858 data points)</span></span></span>
<span><span class="co">#&gt;                pD: 24.5</span></span>
<span><span class="co">#&gt;               DIC: 3154.3</span></span>
<span><span class="op">(</span><span class="va">pso_dic_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">pso_fit_RE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Residual deviance: 3124.1<span style="color: #555555;"> (on 3858 data points)</span></span></span>
<span><span class="co">#&gt;                pD: 28.4</span></span>
<span><span class="co">#&gt;               DIC: 3152.5</span></span></code></pre></div>
<p>The DIC is similar between the FE and RE models, suggesting that there is little evidence for any residual heterogeneity.</p>
</div>
<div class="section level3">
<h3 id="producing-relative-effects-and-event-probabilities">Producing relative effects and event probabilities<a class="anchor" aria-label="anchor" href="#producing-relative-effects-and-event-probabilities"></a>
</h3>
<p>Parameter estimates can be plotted using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method, for example to examine the estimated regression coefficients:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>,</span>
<span>     pars <span class="op">=</span> <span class="st">"beta"</span>,</span>
<span>     stat <span class="op">=</span> <span class="st">"halfeye"</span>,</span>
<span>     ref_line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/unnamed-chunk-20-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Plots of posterior summaries are based on the <code>ggdist</code> package, which allows a great degree of flexibility, and can be further customised using <code>ggplot2</code> commands. In the above command we specify a <code>"halfeye"</code> plot, which shows the posterior density along with posterior medians (points) and 95% Credible Intervals (thin line) with 66% inner bands (thicker line) by default. For more details on the plotting options see <code><a href="../reference/plot.nma_summary.html">?plot.nma_summary</a></code>.</p>
<p>We can produce population-adjusted relative effects for each study population in the network using the <code><a href="../reference/relative_effects.html">relative_effects()</a></code> function.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_releff_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relative_effects.html">relative_effects</a></span><span class="op">(</span><span class="va">pso_fit_FE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">----------------------------------------------------------------</span> <span style="font-weight: bold;">Study: FIXTURE</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span></span>
<span><span class="co">#&gt;     1.65    0.64 0.34   8.32 0.15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; d[FIXTURE: ETN]     1.66 0.09 1.49 1.60 1.66 1.72  1.85     3645     2837    1</span></span>
<span><span class="co">#&gt; d[FIXTURE: IXE_Q2W] 3.03 0.10 2.83 2.96 3.03 3.09  3.24     4231     2744    1</span></span>
<span><span class="co">#&gt; d[FIXTURE: IXE_Q4W] 2.62 0.10 2.44 2.55 2.61 2.68  2.81     4252     2782    1</span></span>
<span><span class="co">#&gt; d[FIXTURE: SEC_150] 2.22 0.12 1.99 2.14 2.22 2.30  2.45     4956     3081    1</span></span>
<span><span class="co">#&gt; d[FIXTURE: SEC_300] 2.53 0.13 2.29 2.44 2.53 2.61  2.78     5889     3369    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-1</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span></span>
<span><span class="co">#&gt;        2    0.73 0.28   9.24 0.28</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                       mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: ETN]     1.51 0.08 1.34 1.45 1.50 1.56  1.67     5008     3257    1</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: IXE_Q2W] 2.92 0.09 2.75 2.86 2.92 2.98  3.10     5610     3217    1</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: IXE_Q4W] 2.51 0.08 2.35 2.45 2.51 2.56  2.68     5646     3270    1</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: SEC_150] 2.11 0.12 1.88 2.03 2.11 2.19  2.34     6073     3228    1</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: SEC_300] 2.42 0.13 2.17 2.33 2.42 2.51  2.68     6784     3151    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-2</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span></span>
<span><span class="co">#&gt;     1.87    0.64 0.27   9.17 0.24</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                       mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: ETN]     1.51 0.08 1.35 1.45 1.51 1.56  1.66     5032     3512    1</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: IXE_Q2W] 2.92 0.09 2.76 2.86 2.92 2.98  3.09     5595     3228    1</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: IXE_Q4W] 2.51 0.08 2.35 2.45 2.51 2.56  2.67     5518     3175    1</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: SEC_150] 2.11 0.12 1.88 2.03 2.11 2.19  2.34     6122     3285    1</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: SEC_300] 2.42 0.13 2.17 2.33 2.42 2.51  2.67     6898     3146    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-3</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight psa</span></span>
<span><span class="co">#&gt;     1.78    0.59 0.28   9.01 0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                       mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: ETN]     1.53 0.08 1.38 1.47 1.53 1.58  1.69     4654     3397    1</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: IXE_Q2W] 2.94 0.09 2.77 2.88 2.94 3.00  3.11     5265     3256    1</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: IXE_Q4W] 2.53 0.08 2.37 2.47 2.53 2.58  2.69     5099     3173    1</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: SEC_150] 2.13 0.12 1.91 2.05 2.13 2.21  2.35     5916     3274    1</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: SEC_300] 2.44 0.12 2.20 2.35 2.44 2.52  2.68     6864     3283    1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_releff_FE</span>, ref_line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_releff_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Predicted probabilities of achieving PASI 75 in each study population on each treatment are produced using the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method. The argument <code>type = "reponse"</code> specifies that we want predicted probabilities, rather than probit probabilities.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_pred_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">----------------------------------------------------------------</span> <span style="font-weight: bold;">Study: FIXTURE</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                        mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; pred[FIXTURE: PBO]     0.04 0.01 0.03 0.04 0.04 0.05  0.06     4320     3250    1</span></span>
<span><span class="co">#&gt; pred[FIXTURE: ETN]     0.46 0.03 0.41 0.44 0.46 0.47  0.51     6534     3395    1</span></span>
<span><span class="co">#&gt; pred[FIXTURE: IXE_Q2W] 0.89 0.02 0.85 0.88 0.89 0.90  0.92     7427     2989    1</span></span>
<span><span class="co">#&gt; pred[FIXTURE: IXE_Q4W] 0.80 0.03 0.74 0.78 0.80 0.81  0.84     6828     3404    1</span></span>
<span><span class="co">#&gt; pred[FIXTURE: SEC_150] 0.67 0.03 0.62 0.65 0.67 0.69  0.72     9243     3090    1</span></span>
<span><span class="co">#&gt; pred[FIXTURE: SEC_300] 0.77 0.02 0.72 0.76 0.77 0.79  0.81     8733     3226    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-1</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; pred[UNCOVER-1: PBO]     0.06 0.01 0.04 0.05 0.06 0.06  0.08     6193     2469    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-1: ETN]     0.46 0.03 0.40 0.44 0.46 0.48  0.52     8332     3239    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-1: IXE_Q2W] 0.90 0.01 0.88 0.89 0.90 0.91  0.92     9881     3242    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-1: IXE_Q4W] 0.81 0.01 0.78 0.80 0.81 0.82  0.84     8096     3321    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-1: SEC_150] 0.69 0.04 0.60 0.66 0.69 0.72  0.76     6291     3295    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-1: SEC_300] 0.79 0.04 0.71 0.76 0.79 0.81  0.85     6632     3270    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-2</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; pred[UNCOVER-2: PBO]     0.05 0.01 0.03 0.04 0.05 0.05  0.06     5817     3182    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-2: ETN]     0.42 0.02 0.38 0.41 0.42 0.43  0.46     8654     2897    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-2: IXE_Q2W] 0.88 0.01 0.86 0.87 0.88 0.89  0.90     8553     2887    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-2: IXE_Q4W] 0.78 0.02 0.75 0.77 0.78 0.79  0.81     8751     2993    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-2: SEC_150] 0.65 0.04 0.57 0.62 0.65 0.68  0.73     7336     2966    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-2: SEC_300] 0.75 0.04 0.68 0.73 0.76 0.78  0.82     6856     3472    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-3</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; pred[UNCOVER-3: PBO]     0.08 0.01 0.06 0.07 0.08 0.08  0.10     5634     2802    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-3: ETN]     0.53 0.02 0.49 0.52 0.53 0.54  0.57     8077     3160    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-3: IXE_Q2W] 0.93 0.01 0.91 0.92 0.93 0.93  0.94     7899     2823    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-3: IXE_Q4W] 0.85 0.01 0.83 0.85 0.85 0.86  0.88     8756     3310    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-3: SEC_150] 0.75 0.03 0.68 0.72 0.75 0.77  0.81     6432     3246    1</span></span>
<span><span class="co">#&gt; pred[UNCOVER-3: SEC_300] 0.83 0.03 0.77 0.81 0.83 0.85  0.88     6701     3447    1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_pred_FE</span>, ref_line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_pred_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<p>We can produce population-adjusted ranks, rank probabilities, and cumulative rank probabilities in each study population using the <code><a href="../reference/posterior_ranks.html">posterior_ranks()</a></code> and <code><a href="../reference/posterior_ranks.html">posterior_rank_probs()</a></code> functions (although here the ranks are unchanged between populations, as the distributions of effect modifiers are similar). We specify <code>lower_better = FALSE</code>, since a higher outcome is better (higher chance of achieving PASI 75).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_ranks_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_ranks.html">posterior_ranks</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, lower_better <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">----------------------------------------------------------------</span> <span style="font-weight: bold;">Study: FIXTURE</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span></span>
<span><span class="co">#&gt;     1.65    0.64 0.34   8.32 0.15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                        mean   sd 2.5% 25% 50% 75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; rank[FIXTURE: PBO]     6.00 0.00    6   6   6   6     6       NA       NA   NA</span></span>
<span><span class="co">#&gt; rank[FIXTURE: ETN]     5.00 0.00    5   5   5   5     5       NA       NA   NA</span></span>
<span><span class="co">#&gt; rank[FIXTURE: IXE_Q2W] 1.00 0.00    1   1   1   1     1       NA       NA   NA</span></span>
<span><span class="co">#&gt; rank[FIXTURE: IXE_Q4W] 2.24 0.43    2   2   2   2     3     3844     3821    1</span></span>
<span><span class="co">#&gt; rank[FIXTURE: SEC_150] 4.00 0.05    4   4   4   4     4     3409       NA    1</span></span>
<span><span class="co">#&gt; rank[FIXTURE: SEC_300] 2.76 0.43    2   3   3   3     3     4011     3356    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-1</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span></span>
<span><span class="co">#&gt;        2    0.73 0.28   9.24 0.28</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          mean   sd 2.5% 25% 50% 75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; rank[UNCOVER-1: PBO]     6.00 0.00    6   6   6   6     6       NA       NA   NA</span></span>
<span><span class="co">#&gt; rank[UNCOVER-1: ETN]     5.00 0.00    5   5   5   5     5       NA       NA   NA</span></span>
<span><span class="co">#&gt; rank[UNCOVER-1: IXE_Q2W] 1.00 0.00    1   1   1   1     1       NA       NA   NA</span></span>
<span><span class="co">#&gt; rank[UNCOVER-1: IXE_Q4W] 2.24 0.43    2   2   2   2     3     3844     3821    1</span></span>
<span><span class="co">#&gt; rank[UNCOVER-1: SEC_150] 4.00 0.05    4   4   4   4     4     3409       NA    1</span></span>
<span><span class="co">#&gt; rank[UNCOVER-1: SEC_300] 2.76 0.43    2   3   3   3     3     4011     3356    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-2</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span></span>
<span><span class="co">#&gt;     1.87    0.64 0.27   9.17 0.24</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          mean   sd 2.5% 25% 50% 75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; rank[UNCOVER-2: PBO]     6.00 0.00    6   6   6   6     6       NA       NA   NA</span></span>
<span><span class="co">#&gt; rank[UNCOVER-2: ETN]     5.00 0.00    5   5   5   5     5       NA       NA   NA</span></span>
<span><span class="co">#&gt; rank[UNCOVER-2: IXE_Q2W] 1.00 0.00    1   1   1   1     1       NA       NA   NA</span></span>
<span><span class="co">#&gt; rank[UNCOVER-2: IXE_Q4W] 2.24 0.43    2   2   2   2     3     3844     3821    1</span></span>
<span><span class="co">#&gt; rank[UNCOVER-2: SEC_150] 4.00 0.05    4   4   4   4     4     3409       NA    1</span></span>
<span><span class="co">#&gt; rank[UNCOVER-2: SEC_300] 2.76 0.43    2   3   3   3     3     4011     3356    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-3</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight psa</span></span>
<span><span class="co">#&gt;     1.78    0.59 0.28   9.01 0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          mean   sd 2.5% 25% 50% 75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; rank[UNCOVER-3: PBO]     6.00 0.00    6   6   6   6     6       NA       NA   NA</span></span>
<span><span class="co">#&gt; rank[UNCOVER-3: ETN]     5.00 0.00    5   5   5   5     5       NA       NA   NA</span></span>
<span><span class="co">#&gt; rank[UNCOVER-3: IXE_Q2W] 1.00 0.00    1   1   1   1     1       NA       NA   NA</span></span>
<span><span class="co">#&gt; rank[UNCOVER-3: IXE_Q4W] 2.24 0.43    2   2   2   2     3     3844     3821    1</span></span>
<span><span class="co">#&gt; rank[UNCOVER-3: SEC_150] 4.00 0.05    4   4   4   4     4     3409       NA    1</span></span>
<span><span class="co">#&gt; rank[UNCOVER-3: SEC_300] 2.76 0.43    2   3   3   3     3     4011     3356    1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_ranks_FE</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_ranks_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_rankprobs_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_ranks.html">posterior_rank_probs</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, lower_better <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">----------------------------------------------------------------</span> <span style="font-weight: bold;">Study: FIXTURE</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span></span>
<span><span class="co">#&gt;     1.65    0.64 0.34   8.32 0.15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span></span>
<span><span class="co">#&gt; d[FIXTURE: PBO]             0      0.00      0.00         0         0         1</span></span>
<span><span class="co">#&gt; d[FIXTURE: ETN]             0      0.00      0.00         0         1         0</span></span>
<span><span class="co">#&gt; d[FIXTURE: IXE_Q2W]         1      0.00      0.00         0         0         0</span></span>
<span><span class="co">#&gt; d[FIXTURE: IXE_Q4W]         0      0.76      0.24         0         0         0</span></span>
<span><span class="co">#&gt; d[FIXTURE: SEC_150]         0      0.00      0.00         1         0         0</span></span>
<span><span class="co">#&gt; d[FIXTURE: SEC_300]         0      0.24      0.76         0         0         0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-1</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span></span>
<span><span class="co">#&gt;        2    0.73 0.28   9.24 0.28</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: PBO]             0      0.00      0.00         0         0         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: ETN]             0      0.00      0.00         0         1         0</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: IXE_Q2W]         1      0.00      0.00         0         0         0</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: IXE_Q4W]         0      0.76      0.24         0         0         0</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: SEC_150]         0      0.00      0.00         1         0         0</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: SEC_300]         0      0.24      0.76         0         0         0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-2</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span></span>
<span><span class="co">#&gt;     1.87    0.64 0.27   9.17 0.24</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: PBO]             0      0.00      0.00         0         0         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: ETN]             0      0.00      0.00         0         1         0</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: IXE_Q2W]         1      0.00      0.00         0         0         0</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: IXE_Q4W]         0      0.76      0.24         0         0         0</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: SEC_150]         0      0.00      0.00         1         0         0</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: SEC_300]         0      0.24      0.76         0         0         0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-3</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight psa</span></span>
<span><span class="co">#&gt;     1.78    0.59 0.28   9.01 0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: PBO]             0      0.00      0.00         0         0         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: ETN]             0      0.00      0.00         0         1         0</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: IXE_Q2W]         1      0.00      0.00         0         0         0</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: IXE_Q4W]         0      0.76      0.24         0         0         0</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: SEC_150]         0      0.00      0.00         1         0         0</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: SEC_300]         0      0.24      0.76         0         0         0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_rankprobs_FE</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_rankprobs_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_cumrankprobs_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_ranks.html">posterior_rank_probs</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, lower_better <span class="op">=</span> <span class="cn">FALSE</span>, cumulative <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">----------------------------------------------------------------</span> <span style="font-weight: bold;">Study: FIXTURE</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span></span>
<span><span class="co">#&gt;     1.65    0.64 0.34   8.32 0.15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span></span>
<span><span class="co">#&gt; d[FIXTURE: PBO]             0      0.00         0         0         0         1</span></span>
<span><span class="co">#&gt; d[FIXTURE: ETN]             0      0.00         0         0         1         1</span></span>
<span><span class="co">#&gt; d[FIXTURE: IXE_Q2W]         1      1.00         1         1         1         1</span></span>
<span><span class="co">#&gt; d[FIXTURE: IXE_Q4W]         0      0.76         1         1         1         1</span></span>
<span><span class="co">#&gt; d[FIXTURE: SEC_150]         0      0.00         0         1         1         1</span></span>
<span><span class="co">#&gt; d[FIXTURE: SEC_300]         0      0.24         1         1         1         1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-1</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span></span>
<span><span class="co">#&gt;        2    0.73 0.28   9.24 0.28</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: PBO]             0      0.00         0         0         0         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: ETN]             0      0.00         0         0         1         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: IXE_Q2W]         1      1.00         1         1         1         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: IXE_Q4W]         0      0.76         1         1         1         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: SEC_150]         0      0.00         0         1         1         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-1: SEC_300]         0      0.24         1         1         1         1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-2</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span></span>
<span><span class="co">#&gt;     1.87    0.64 0.27   9.17 0.24</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: PBO]             0      0.00         0         0         0         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: ETN]             0      0.00         0         0         1         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: IXE_Q2W]         1      1.00         1         1         1         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: IXE_Q4W]         0      0.76         1         1         1         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: SEC_150]         0      0.00         0         1         1         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-2: SEC_300]         0      0.24         1         1         1         1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">--------------------------------------------------------------</span> <span style="font-weight: bold;">Study: UNCOVER-3</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight psa</span></span>
<span><span class="co">#&gt;     1.78    0.59 0.28   9.01 0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                       p_rank[1] p_rank[2] p_rank[3] p_rank[4] p_rank[5] p_rank[6]</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: PBO]             0      0.00         0         0         0         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: ETN]             0      0.00         0         0         1         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: IXE_Q2W]         1      1.00         1         1         1         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: IXE_Q4W]         0      0.76         1         1         1         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: SEC_150]         0      0.00         0         1         1         1</span></span>
<span><span class="co">#&gt; d[UNCOVER-3: SEC_300]         0      0.24         1         1         1         1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_cumrankprobs_FE</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_cumrankprobs_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<p>All of the above estimates (relative effects, predictions, rankings) can also be produced for a specific target population or populations by providing a suitable <code>newdata</code> argument to for function (and a <code>baseline</code> distribution for <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>).</p>
<p>To produce population-adjusted relative effects (and corresponding rankings) for a chosen target population, we require only the mean covariate values in that population. For example, <code>newdata</code> could provide the following mean covariate values:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_agd_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  bsa <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  prevsys <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  psa <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  weight <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  durnpso <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>Population-adjusted relative effects in this target population are then calculated using the <code><a href="../reference/relative_effects.html">relative_effects()</a></code> function, and can be plotted with the corresponding <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_releff_FE_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relative_effects.html">relative_effects</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, newdata <span class="op">=</span> <span class="va">new_agd_means</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">------------------------------------------------------------------</span> <span style="font-weight: bold;">Study: New 1</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys bsa weight psa</span></span>
<span><span class="co">#&gt;        3     0.1 0.6     10 0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                   mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; d[New 1: ETN]     1.25 0.23 0.80 1.09 1.25 1.41  1.71     5264     3083    1</span></span>
<span><span class="co">#&gt; d[New 1: IXE_Q2W] 2.89 0.23 2.45 2.73 2.88 3.04  3.35     6086     2948    1</span></span>
<span><span class="co">#&gt; d[New 1: IXE_Q4W] 2.48 0.22 2.05 2.32 2.47 2.63  2.93     5824     2877    1</span></span>
<span><span class="co">#&gt; d[New 1: SEC_150] 2.08 0.23 1.64 1.92 2.08 2.23  2.55     6056     2883    1</span></span>
<span><span class="co">#&gt; d[New 1: SEC_300] 2.39 0.23 1.94 2.23 2.38 2.54  2.86     5885     3060    1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_releff_FE_new</span>, ref_line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_releff_FE_new-1.png" width="700" style="display: block; margin: auto;"></p>
<p>For absolute predictions, we require information about the full covariate distribution in the target population, not just the mean values. If IPD are available for the target population, <code>newdata</code> is simply a data frame of the IPD. If AgD are available for the target population, <code>newdata</code> must be a data frame with added integration points created using the <code><a href="../reference/add_integration.html">add_integration()</a></code> function.</p>
<p>For example, suppose the aggregate target population introduced above had the following covariate means and standard deviations (for continuous covariates) or proportions (for discrete covariates):</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_agd_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  bsa_mean <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  bsa_sd <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  prevsys <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  psa <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  weight_mean <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  weight_sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  durnpso_mean <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  durnpso_sd <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We add integration points to this data frame in a similar manner to before. Again, we need to supply a correlation matrix for the joint covariate distribution; we use the same weighted mean correlation matrix computed earlier from the IPD in the network, which is stored in the network object as <code>int_cor</code>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_agd_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_integration.html">add_integration</a></span><span class="op">(</span><span class="va">new_agd_int</span>,</span>
<span>  durnpso <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">durnpso_mean</span>, sd <span class="op">=</span> <span class="va">durnpso_sd</span><span class="op">)</span>,</span>
<span>  prevsys <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">prevsys</span><span class="op">)</span>,</span>
<span>  bsa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qlogitnorm</span>, mean <span class="op">=</span> <span class="va">bsa_mean</span>, sd <span class="op">=</span> <span class="va">bsa_sd</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">weight_mean</span>, sd <span class="op">=</span> <span class="va">weight_sd</span><span class="op">)</span>,</span>
<span>  psa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">psa</span><span class="op">)</span>,</span>
<span>  cor <span class="op">=</span> <span class="va">pso_net</span><span class="op">$</span><span class="va">int_cor</span>,</span>
<span>  n_int <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>Predicted probabilities of achieving PASI 75 in this target population, given a <span class="math inline">\(N(-1.75, 0.08^2)\)</span> distribution on the baseline probit-probability of response on Placebo (at the reference levels of the covariates), are then produced using the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_pred_FE_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, </span>
<span>                            type <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>                            newdata <span class="op">=</span> <span class="va">new_agd_int</span>,</span>
<span>                            baseline <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qnorm</span>, <span class="op">-</span><span class="fl">1.75</span>, <span class="fl">0.08</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">------------------------------------------------------------------</span> <span style="font-weight: bold;">Study: New 1</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                      mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; pred[New 1: PBO]     0.06 0.02 0.03 0.04 0.06 0.08  0.12     4790     3256    1</span></span>
<span><span class="co">#&gt; pred[New 1: ETN]     0.37 0.06 0.26 0.33 0.36 0.41  0.49     6018     3609    1</span></span>
<span><span class="co">#&gt; pred[New 1: IXE_Q2W] 0.90 0.03 0.84 0.88 0.90 0.92  0.94     5387     3182    1</span></span>
<span><span class="co">#&gt; pred[New 1: IXE_Q4W] 0.81 0.04 0.72 0.78 0.81 0.83  0.87     5496     3571    1</span></span>
<span><span class="co">#&gt; pred[New 1: SEC_150] 0.68 0.06 0.57 0.64 0.68 0.72  0.78     5723     3384    1</span></span>
<span><span class="co">#&gt; pred[New 1: SEC_300] 0.78 0.05 0.68 0.75 0.78 0.81  0.86     5679     3447    1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_pred_FE_new</span>, ref_line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso_pred_FE_new-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="extended_analysis">Extended analysis<a class="anchor" aria-label="anchor" href="#extended_analysis"></a>
</h2>
<p>We now extend the network to include a further five studies (four AgD and one IPD), recreating the analysis of <span class="citation">Phillippo et al. (<a href="#ref-Phillippo2022" role="doc-biblioref">2022</a>)</span>. This larger network allows us to assess the key assumptions underlying population adjustment.</p>
<div class="section level3">
<h3 id="setup-1">Setup<a class="anchor" aria-label="anchor" href="#setup-1"></a>
</h3>
<div class="section level4">
<h4 id="preparing-the-data-1">Preparing the data<a class="anchor" aria-label="anchor" href="#preparing-the-data-1"></a>
</h4>
<p>We begin, as before, with some data transformations for each of the covariates and set up a treatment class variable <code>trtclass</code>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IPD studies</span></span>
<span><span class="va">pso_ipd</span> <span class="op">&lt;-</span> <span class="va">plaque_psoriasis_ipd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Variable transformations</span></span>
<span>    bsa <span class="op">=</span> <span class="va">bsa</span> <span class="op">/</span> <span class="fl">100</span>,</span>
<span>    weight <span class="op">=</span> <span class="va">weight</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>    durnpso <span class="op">=</span> <span class="va">durnpso</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>    prevsys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">prevsys</span><span class="op">)</span>,</span>
<span>    psa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">psa</span><span class="op">)</span>,</span>
<span>    <span class="co"># Treatment classes</span></span>
<span>    trtclass <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">trtn</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Placebo"</span>,</span>
<span>                         <span class="va">trtn</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">~</span> <span class="st">"IL-17 blocker"</span>,</span>
<span>                         <span class="va">trtn</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"TNFa blocker"</span>,</span>
<span>                         <span class="va">trtn</span> <span class="op">==</span> <span class="fl">7</span> <span class="op">~</span> <span class="st">"IL-12/23 blocker"</span><span class="op">)</span>,</span>
<span>    <span class="co"># Check complete cases for covariates of interest</span></span>
<span>    is_complete <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">durnpso</span>, <span class="va">prevsys</span>, <span class="va">bsa</span>, <span class="va">weight</span>, <span class="va">psa</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">studyc</span>, <span class="va">trtn</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># AgD studies</span></span>
<span><span class="va">pso_agd</span> <span class="op">&lt;-</span> <span class="va">plaque_psoriasis_agd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Variable transformations</span></span>
<span>    bsa_mean <span class="op">=</span> <span class="va">bsa_mean</span> <span class="op">/</span> <span class="fl">100</span>, </span>
<span>    bsa_sd <span class="op">=</span> <span class="va">bsa_sd</span> <span class="op">/</span> <span class="fl">100</span>,</span>
<span>    weight_mean <span class="op">=</span> <span class="va">weight_mean</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>    weight_sd <span class="op">=</span> <span class="va">weight_sd</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>    durnpso_mean <span class="op">=</span> <span class="va">durnpso_mean</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>    durnpso_sd <span class="op">=</span> <span class="va">durnpso_sd</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>    prevsys <span class="op">=</span> <span class="va">prevsys</span> <span class="op">/</span> <span class="fl">100</span>,</span>
<span>    psa <span class="op">=</span> <span class="va">psa</span> <span class="op">/</span> <span class="fl">100</span>,</span>
<span>    <span class="co"># Treatment classes</span></span>
<span>    trtclass <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">trtn</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Placebo"</span>,</span>
<span>                         <span class="va">trtn</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">~</span> <span class="st">"IL-17 blocker"</span>,</span>
<span>                         <span class="va">trtn</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"TNFa blocker"</span>,</span>
<span>                         <span class="va">trtn</span> <span class="op">==</span> <span class="fl">7</span> <span class="op">~</span> <span class="st">"IL-12/23 blocker"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">studyc</span>, <span class="va">trtn</span><span class="op">)</span></span></code></pre></div>
<p>There are a very small number of individuals with missing values in the IPD, which we simply exclude from the analysis.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_ipd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">studyc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n_total <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            n_missing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">is_complete</span><span class="op">)</span>, </span>
<span>            pct_missing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">!</span><span class="va">is_complete</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;   studyc    n_total n_missing pct_missing</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> IXORA-S       260         0       0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> UNCOVER-1    <span style="text-decoration: underline;">1</span>296         0       0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> UNCOVER-2    <span style="text-decoration: underline;">1</span>221         2       0.164</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> UNCOVER-3    <span style="text-decoration: underline;">1</span>341         2       0.149</span></span>
<span></span>
<span><span class="va">pso_ipd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pso_ipd</span>, <span class="va">is_complete</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="creating-the-network-1">Creating the network<a class="anchor" aria-label="anchor" href="#creating-the-network-1"></a>
</h4>
<p>Next we set up the network. We set the IPD with <code><a href="../reference/set_ipd.html">set_ipd()</a></code> and AgD (arm-based) with <code><a href="../reference/set_agd_arm.html">set_agd_arm()</a></code>, and combine these together using <code><a href="../reference/combine_network.html">combine_network()</a></code>. We specify an ordered categorical (multinomial) outcome using the <code><a href="../reference/multi.html">multi()</a></code> helper function. The outcome data are in “inclusive” format, i.e. the lowest category is the sample size (or 1 for IPD), the second category counts those achieving PASI 75 <em>or greater</em> (<span class="math inline">\(\ge 75\%\)</span> reduction in symptoms), the third counts those achieving PASI 90 <em>or greater</em> (<span class="math inline">\(\ge 90\%\)</span> reduction), and the final category counts those achieving PASI 100 (<span class="math inline">\(100\%\)</span> reduction).<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The alternative is “exclusive” format, where the lowest category counts those not achieving any higher outcomes (i.e. failure to achieve PASI 75, &lt;span class="math inline"&gt;\(&amp;lt;75\%\)&lt;/span&gt; reduction in symptoms), the second counts those achieving PASI 75 &lt;em&gt;but not PASI 90 or 100&lt;/em&gt; (&lt;span class="math inline"&gt;\(\ge 75\%\)&lt;/span&gt; and &lt;span class="math inline"&gt;\(&amp;lt;90\%\)&lt;/span&gt; reduction), the third counts those achieving PASI 90 &lt;em&gt;but not PASI 100&lt;/em&gt; (&lt;span class="math inline"&gt;\(\ge 90\%\)&lt;/span&gt; and &lt;span class="math inline"&gt;\(&amp;lt;100\%\)&lt;/span&gt; reduction), and the final category counts those achieving PASI 100 (&lt;span class="math inline"&gt;\(100\%\)&lt;/span&gt; reduction).&lt;/p&gt;'><sup>2</sup></a> We specify the treatment classes with <code>trt_class = trtclass</code>.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_network.html">combine_network</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/set_ipd.html">set_ipd</a></span><span class="op">(</span><span class="va">pso_ipd</span>,</span>
<span>    study <span class="op">=</span> <span class="va">studyc</span>,</span>
<span>    trt <span class="op">=</span> <span class="va">trtc</span>,</span>
<span>    r <span class="op">=</span> <span class="fu"><a href="../reference/multi.html">multi</a></span><span class="op">(</span>r0 <span class="op">=</span> <span class="fl">1</span>, </span>
<span>              PASI75 <span class="op">=</span> <span class="va">pasi75</span>,</span>
<span>              PASI90 <span class="op">=</span> <span class="va">pasi90</span>,</span>
<span>              PASI100 <span class="op">=</span> <span class="va">pasi100</span>,</span>
<span>              type <span class="op">=</span> <span class="st">"ordered"</span>, inclusive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    trt_class <span class="op">=</span> <span class="va">trtclass</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/set_agd_arm.html">set_agd_arm</a></span><span class="op">(</span><span class="va">pso_agd</span>,</span>
<span>    study <span class="op">=</span> <span class="va">studyc</span>,</span>
<span>    trt <span class="op">=</span> <span class="va">trtc</span>,</span>
<span>    r <span class="op">=</span> <span class="fu"><a href="../reference/multi.html">multi</a></span><span class="op">(</span>r0 <span class="op">=</span> <span class="va">pasi75_n</span>, </span>
<span>              PASI75 <span class="op">=</span> <span class="va">pasi75_r</span>,</span>
<span>              PASI90 <span class="op">=</span> <span class="va">pasi90_r</span>,</span>
<span>              PASI100 <span class="op">=</span> <span class="va">pasi100_r</span>,</span>
<span>              type <span class="op">=</span> <span class="st">"ordered"</span>, inclusive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    trt_class <span class="op">=</span> <span class="va">trtclass</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pso_net</span></span>
<span><span class="co">#&gt; A network with 4 IPD studies, and 5 AgD studies (arm-based).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;">-------------------------------------------------------------------</span> <span style="font-weight: bold;">IPD studies</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt;  Study     Treatment arms                  </span></span>
<span><span class="co">#&gt;  IXORA-S   2: IXE_Q2W | UST                </span></span>
<span><span class="co">#&gt;  UNCOVER-1 3: PBO | IXE_Q2W | IXE_Q4W      </span></span>
<span><span class="co">#&gt;  UNCOVER-2 4: PBO | IXE_Q2W | IXE_Q4W | ETN</span></span>
<span><span class="co">#&gt;  UNCOVER-3 4: PBO | IXE_Q2W | IXE_Q4W | ETN</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Outcome type: ordered (4 categories)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">-------------------------------------------------------</span> <span style="font-weight: bold;">AgD studies (arm-based)</span> <span style="color: #555555;">----</span> </span></span>
<span><span class="co">#&gt;  Study    Treatment arms                  </span></span>
<span><span class="co">#&gt;  CLEAR    2: SEC_300 | UST                </span></span>
<span><span class="co">#&gt;  ERASURE  3: PBO | SEC_150 | SEC_300      </span></span>
<span><span class="co">#&gt;  FEATURE  3: PBO | SEC_150 | SEC_300      </span></span>
<span><span class="co">#&gt;  FIXTURE  4: PBO | ETN | SEC_150 | SEC_300</span></span>
<span><span class="co">#&gt;  JUNCTURE 3: PBO | SEC_150 | SEC_300      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Outcome type: ordered (4 categories)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">------------------------------------------------------------------------------------</span></span></span>
<span><span class="co">#&gt; Total number of treatments: 7, in 4 classes</span></span>
<span><span class="co">#&gt; Total number of studies: 9</span></span>
<span><span class="co">#&gt; Reference treatment is: PBO</span></span>
<span><span class="co">#&gt; Network is <span style="color: #00BB00;">connected</span></span></span></code></pre></div>
<p>We create a network plot using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function applied to the <code>pso_net</code> network object, choosing to scale the edges and nodes by the number of studies/sample size (<code>weight_edges</code> and <code>weight_nodes = TRUE</code>), colour the treatment nodes by class (<code>show_trt_class = TRUE</code>), and nudge the treatment names away from the nodes (<code>nudge = 0.1</code>). We further customise the plot using ggplot syntax to alter the colour scheme.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">class_pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#D95F02"</span>, <span class="st">"#7570B3"</span>, <span class="st">"#E7298A"</span>, <span class="st">"#E6AB02"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_net</span>, weight_nodes <span class="op">=</span> <span class="cn">TRUE</span>, weight_edges <span class="op">=</span> <span class="cn">TRUE</span>, show_trt_class <span class="op">=</span> <span class="cn">TRUE</span>, nudge <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggraph</span><span class="fu">::</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/scale_edge_colour.html" class="external-link">scale_edge_colour_manual</a></span><span class="op">(</span><span class="st">"Data"</span>, </span>
<span>                                   values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AgD <span class="op">=</span> <span class="st">"#113259"</span>, IPD <span class="op">=</span> <span class="st">"#55A480"</span><span class="op">)</span>,</span>
<span>                                   guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>edge_width <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span><span class="st">"Treatment class"</span>, </span>
<span>                    values <span class="op">=</span> <span class="va">class_pal</span>,</span>
<span>                    aesthetics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fill"</span>, <span class="st">"colour"</span><span class="op">)</span>,</span>
<span>                    guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for 'edge_colour' is already present. Adding another scale for 'edge_colour', which</span></span>
<span><span class="co">#&gt; will replace the existing scale.</span></span>
<span><span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which will replace the</span></span>
<span><span class="co">#&gt; existing scale.</span></span>
<span><span class="co">#&gt; Warning: Duplicated override.aes is ignored.</span></span></code></pre></div>
<p><img src="example_plaque_psoriasis_files/figure-html/pso-full-network-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="numerical-integration-for-ml-nmr-models">Numerical integration for ML-NMR models<a class="anchor" aria-label="anchor" href="#numerical-integration-for-ml-nmr-models"></a>
</h4>
<p>We add integration points to the AgD studies in the network using the <code><a href="../reference/add_integration.html">add_integration()</a></code> function, specifying the chosen marginal distribution for each covariate using the <code><a href="../reference/distr.html">distr()</a></code> function. As before, we specify Gamma distributions for weight and duration of psoriasis, a logit-Normal distribution for body surface area, and Bernoulli distributions for previous systemic treatment and psoriatic arthritis as binary covariates. Since we do not know the correlations between covariates in the AgD studies, we once again impute these with the weighted mean of the correlations in the IPD studies (the default option).</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_integration.html">add_integration</a></span><span class="op">(</span><span class="va">pso_net</span>,</span>
<span>  durnpso <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">durnpso_mean</span>, sd <span class="op">=</span> <span class="va">durnpso_sd</span><span class="op">)</span>,</span>
<span>  prevsys <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">prevsys</span><span class="op">)</span>,</span>
<span>  bsa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qlogitnorm</span>, mean <span class="op">=</span> <span class="va">bsa_mean</span>, sd <span class="op">=</span> <span class="va">bsa_sd</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">weight_mean</span>, sd <span class="op">=</span> <span class="va">weight_sd</span><span class="op">)</span>,</span>
<span>  psa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">psa</span><span class="op">)</span>,</span>
<span>  n_int <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using weighted average correlation matrix computed from IPD studies.</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="ml-nmr-model">ML-NMR model<a class="anchor" aria-label="anchor" href="#ml-nmr-model"></a>
</h3>
<p>Using the <code><a href="../reference/nma.html">nma()</a></code> function, we fit a (fixed effect) ML-NMR model which includes main effects (prognostic terms) and covariate-treatment interactions (effect-modifying terms) for each of the five covariates. Ideally, we would fit independent interaction terms for each treatment; however, this requires either IPD or several AgD studies at a range of covariate values on each treatment. The data here are insufficient to fit independent interaction terms for each treatment, so we make the shared effect modifier assumption within each class of treatments <span class="citation">(<a href="#ref-TSD18" role="doc-biblioref">Phillippo et al. 2016</a>)</span> and specify common interaction terms within each treatment class (<code>class_interactions = "common"</code>). As before, we specify <span class="math inline">\(\mathrm{N}(0, 10^2)\)</span> prior distributions on the study-specific intercepts, treatment effects, and regression parameters. However, since we now have an ordered multinomial likelihood we also need to specify priors for the differences between the latent cutoffs for each outcome category; we choose an improper flat prior <span class="math inline">\(\mathrm{U}(-\infty,\infty)\)</span> which will automatically be truncated to meet the ordering constraints (<code>prior_aux = flat()</code>).</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_fit_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">pso_net</span>, </span>
<span>                  trt_effects <span class="op">=</span> <span class="st">"fixed"</span>,</span>
<span>                  link <span class="op">=</span> <span class="st">"probit"</span>, </span>
<span>                  regression <span class="op">=</span> <span class="op">~</span><span class="op">(</span><span class="va">durnpso</span> <span class="op">+</span> <span class="va">prevsys</span> <span class="op">+</span> <span class="va">bsa</span> <span class="op">+</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">psa</span><span class="op">)</span><span class="op">*</span><span class="va">.trt</span>,</span>
<span>                  class_interactions <span class="op">=</span> <span class="st">"common"</span>,</span>
<span>                  prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                  prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                  prior_reg <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                  prior_aux <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">flat</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  QR <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  init_r <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; Note: Setting "PBO" as the network reference treatment.</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_fit_FE</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; A fixed effects ML-NMR with a ordered likelihood (probit link).</span></span>
<span><span class="co">#&gt; Regression model: ~(durnpso + prevsys + bsa + weight + psa) * .trt.</span></span>
<span><span class="co">#&gt; Centred covariates at the following overall mean values:</span></span>
<span><span class="co">#&gt;   durnpso   prevsys       bsa    weight       psa </span></span>
<span><span class="co">#&gt; 1.8159830 0.6576489 0.2987820 8.9097263 0.2104826 </span></span>
<span><span class="co">#&gt; Inference for Stan model: ordered_multinomial.</span></span>
<span><span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span></span>
<span><span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                             mean se_mean   sd     2.5%      25%      50%      75%</span></span>
<span><span class="co">#&gt; beta[durnpso]                               0.03    0.00 0.06    -0.08    -0.01     0.03     0.08</span></span>
<span><span class="co">#&gt; beta[prevsys]                              -0.17    0.00 0.16    -0.49    -0.28    -0.17    -0.06</span></span>
<span><span class="co">#&gt; beta[bsa]                                  -0.10    0.01 0.45    -1.01    -0.40    -0.08     0.21</span></span>
<span><span class="co">#&gt; beta[weight]                                0.04    0.00 0.03    -0.01     0.02     0.04     0.06</span></span>
<span><span class="co">#&gt; beta[psa]                                  -0.08    0.00 0.17    -0.42    -0.20    -0.08     0.03</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]        -0.02    0.00 0.07    -0.16    -0.07    -0.02     0.03</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL-12/23 blocker]    -0.06    0.00 0.10    -0.26    -0.13    -0.07     0.00</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL-17 blocker]       -0.02    0.00 0.06    -0.14    -0.07    -0.02     0.02</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]         0.19    0.00 0.19    -0.18     0.07     0.19     0.32</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL-12/23 blocker]     0.45    0.01 0.34    -0.24     0.24     0.47     0.68</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL-17 blocker]        0.16    0.00 0.17    -0.17     0.05     0.16     0.28</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]             0.24    0.01 0.51    -0.73    -0.11     0.22     0.57</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL-12/23 blocker]         0.61    0.01 0.68    -0.71     0.14     0.61     1.07</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL-17 blocker]            0.27    0.01 0.47    -0.63    -0.06     0.26     0.58</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassTNFa blocker]         -0.16    0.00 0.03    -0.23    -0.18    -0.16    -0.14</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL-12/23 blocker]     -0.09    0.00 0.05    -0.18    -0.12    -0.09    -0.06</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL-17 blocker]        -0.13    0.00 0.03    -0.19    -0.15    -0.13    -0.11</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassTNFa blocker]            -0.05    0.00 0.20    -0.43    -0.18    -0.04     0.08</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL-12/23 blocker]         0.12    0.01 0.33    -0.51    -0.11     0.12     0.36</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL-17 blocker]            0.10    0.00 0.18    -0.24    -0.02     0.10     0.21</span></span>
<span><span class="co">#&gt; d[ETN]                                      1.58    0.00 0.07     1.44     1.53     1.58     1.63</span></span>
<span><span class="co">#&gt; d[IXE_Q2W]                                  2.91    0.00 0.07     2.76     2.86     2.91     2.96</span></span>
<span><span class="co">#&gt; d[IXE_Q4W]                                  2.69    0.00 0.08     2.54     2.64     2.69     2.74</span></span>
<span><span class="co">#&gt; d[SEC_150]                                  2.19    0.00 0.08     2.03     2.13     2.19     2.24</span></span>
<span><span class="co">#&gt; d[SEC_300]                                  2.60    0.00 0.08     2.45     2.54     2.60     2.65</span></span>
<span><span class="co">#&gt; d[UST]                                      2.13    0.00 0.11     1.91     2.06     2.13     2.20</span></span>
<span><span class="co">#&gt; lp__                                    -7640.27    0.11 4.31 -7649.63 -7642.96 -7639.97 -7637.16</span></span>
<span><span class="co">#&gt; cc[PASI75]                                  0.00     NaN 0.00     0.00     0.00     0.00     0.00</span></span>
<span><span class="co">#&gt; cc[PASI90]                                  0.69    0.00 0.02     0.65     0.68     0.69     0.70</span></span>
<span><span class="co">#&gt; cc[PASI100]                                 1.53    0.00 0.02     1.49     1.52     1.53     1.55</span></span>
<span><span class="co">#&gt;                                            97.5% n_eff Rhat</span></span>
<span><span class="co">#&gt; beta[durnpso]                               0.15  2512    1</span></span>
<span><span class="co">#&gt; beta[prevsys]                               0.14  2701    1</span></span>
<span><span class="co">#&gt; beta[bsa]                                   0.77  2254    1</span></span>
<span><span class="co">#&gt; beta[weight]                                0.10  2331    1</span></span>
<span><span class="co">#&gt; beta[psa]                                   0.24  3019    1</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]         0.12  2678    1</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL-12/23 blocker]     0.14  3490    1</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL-17 blocker]        0.10  2899    1</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]         0.55  2824    1</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL-12/23 blocker]     1.11  4293    1</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL-17 blocker]        0.48  3128    1</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]             1.27  2433    1</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL-12/23 blocker]         1.93  2921    1</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL-17 blocker]            1.25  2728    1</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassTNFa blocker]         -0.10  2590    1</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL-12/23 blocker]      0.01  3473    1</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL-17 blocker]        -0.07  2731    1</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassTNFa blocker]             0.33  2990    1</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL-12/23 blocker]         0.77  3967    1</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL-17 blocker]            0.46  3516    1</span></span>
<span><span class="co">#&gt; d[ETN]                                      1.72  1969    1</span></span>
<span><span class="co">#&gt; d[IXE_Q2W]                                  3.06  2104    1</span></span>
<span><span class="co">#&gt; d[IXE_Q4W]                                  2.84  2327    1</span></span>
<span><span class="co">#&gt; d[SEC_150]                                  2.36  2267    1</span></span>
<span><span class="co">#&gt; d[SEC_300]                                  2.76  2396    1</span></span>
<span><span class="co">#&gt; d[UST]                                      2.34  3215    1</span></span>
<span><span class="co">#&gt; lp__                                    -7632.94  1664    1</span></span>
<span><span class="co">#&gt; cc[PASI75]                                  0.00   NaN  NaN</span></span>
<span><span class="co">#&gt; cc[PASI90]                                  0.72  3323    1</span></span>
<span><span class="co">#&gt; cc[PASI100]                                 1.58  2862    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Sun Aug 28 12:56:36 2022.</span></span>
<span><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span><span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span></span>
<span><span class="co">#&gt; convergence, Rhat=1).</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="assessing-assumptions">Assessing assumptions<a class="anchor" aria-label="anchor" href="#assessing-assumptions"></a>
</h3>
<p>In the first analysis, the small network made assessing assumptions difficult. With this larger network (although still only nine studies) we have greater opportunity to assess the key assumptions.</p>
<p>The key assumption made by ML-NMR (and indeed all population adjustment methods in connected networks) is the conditional constancy of relative effects assumption <span class="citation">(<a href="#ref-TSD18" role="doc-biblioref">Phillippo et al. 2016</a>)</span>. This means that there are no unobserved effect modifiers, so that the relative effects are constant given the included effect-modifying covariates. This assumption implies that there is no residual heterogeneity or inconsistency, which can be assessed using standard network meta-analysis techniques. We assess residual heterogeneity using a random effects model, and residual inconsistency using an unrelated mean effects (UME) model.</p>
<div class="section level4">
<h4 id="assessing-residual-heterogeneity-with-a-random-effects-ml-nmr">Assessing residual heterogeneity with a random effects ML-NMR<a class="anchor" aria-label="anchor" href="#assessing-residual-heterogeneity-with-a-random-effects-ml-nmr"></a>
</h4>
<p>First, we fit a random effects model to assess residual heterogeneity. The call to the <code><a href="../reference/nma.html">nma()</a></code> function is identical to the fixed effect model above, except that now we specify <code>trt_effects = "random"</code> and need to provide a prior for the between-study heterogeneity (we choose a <span class="math inline">\(\textrm{half-N}(0, 2.5^2)\)</span> prior with <code>prior_het = half_normal(scale = 2.5)</code>.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_fit_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">pso_net</span>, </span>
<span>                  trt_effects <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>                  link <span class="op">=</span> <span class="st">"probit"</span>, </span>
<span>                  regression <span class="op">=</span> <span class="op">~</span><span class="op">(</span><span class="va">durnpso</span> <span class="op">+</span> <span class="va">prevsys</span> <span class="op">+</span> <span class="va">bsa</span> <span class="op">+</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">psa</span><span class="op">)</span><span class="op">*</span><span class="va">.trt</span>,</span>
<span>                  class_interactions <span class="op">=</span> <span class="st">"common"</span>,</span>
<span>                  prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                  prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                  prior_reg <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                  prior_aux <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">flat</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  prior_het <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">half_normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>                  QR <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  init_r <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; Note: Setting "PBO" as the network reference treatment.</span></span>
<span><span class="co">#&gt; Warning: There were 1 divergent transitions after warmup. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span></span>
<span><span class="co">#&gt; to find out why this is a problem and how to eliminate them.</span></span>
<span><span class="co">#&gt; Warning: Examine the pairs() plot to diagnose sampling problems</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_fit_RE</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; A random effects ML-NMR with a ordered likelihood (probit link).</span></span>
<span><span class="co">#&gt; Regression model: ~(durnpso + prevsys + bsa + weight + psa) * .trt.</span></span>
<span><span class="co">#&gt; Centred covariates at the following overall mean values:</span></span>
<span><span class="co">#&gt;   durnpso   prevsys       bsa    weight       psa </span></span>
<span><span class="co">#&gt; 1.8159830 0.6576489 0.2987820 8.9097263 0.2104826 </span></span>
<span><span class="co">#&gt; Inference for Stan model: ordered_multinomial.</span></span>
<span><span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span></span>
<span><span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                             mean se_mean   sd     2.5%      25%      50%      75%</span></span>
<span><span class="co">#&gt; beta[durnpso]                               0.04    0.00 0.06    -0.08    -0.01     0.04     0.08</span></span>
<span><span class="co">#&gt; beta[prevsys]                              -0.16    0.00 0.16    -0.46    -0.26    -0.15    -0.06</span></span>
<span><span class="co">#&gt; beta[bsa]                                  -0.14    0.01 0.46    -1.09    -0.45    -0.13     0.17</span></span>
<span><span class="co">#&gt; beta[weight]                                0.05    0.00 0.03    -0.01     0.03     0.05     0.07</span></span>
<span><span class="co">#&gt; beta[psa]                                  -0.07    0.00 0.17    -0.40    -0.18    -0.06     0.04</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]        -0.02    0.00 0.07    -0.17    -0.07    -0.02     0.03</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL-12/23 blocker]    -0.07    0.00 0.10    -0.27    -0.14    -0.07     0.01</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL-17 blocker]       -0.03    0.00 0.06    -0.15    -0.07    -0.02     0.02</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]         0.19    0.00 0.18    -0.17     0.07     0.19     0.31</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL-12/23 blocker]     0.43    0.00 0.35    -0.27     0.20     0.44     0.67</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL-17 blocker]        0.15    0.00 0.16    -0.18     0.04     0.15     0.26</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]             0.27    0.01 0.53    -0.73    -0.08     0.25     0.61</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL-12/23 blocker]         0.66    0.01 0.66    -0.65     0.21     0.67     1.09</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL-17 blocker]            0.32    0.01 0.48    -0.58    -0.01     0.31     0.63</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassTNFa blocker]         -0.16    0.00 0.03    -0.23    -0.19    -0.16    -0.14</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL-12/23 blocker]     -0.09    0.00 0.05    -0.18    -0.12    -0.09    -0.06</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL-17 blocker]        -0.13    0.00 0.03    -0.19    -0.15    -0.13    -0.11</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassTNFa blocker]            -0.06    0.00 0.20    -0.46    -0.20    -0.06     0.07</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL-12/23 blocker]         0.11    0.00 0.33    -0.53    -0.10     0.11     0.34</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL-17 blocker]            0.08    0.00 0.18    -0.27    -0.04     0.08     0.20</span></span>
<span><span class="co">#&gt; d[ETN]                                      1.59    0.00 0.11     1.38     1.52     1.59     1.66</span></span>
<span><span class="co">#&gt; d[IXE_Q2W]                                  2.93    0.00 0.11     2.73     2.86     2.93     3.00</span></span>
<span><span class="co">#&gt; d[IXE_Q4W]                                  2.71    0.00 0.12     2.49     2.64     2.71     2.78</span></span>
<span><span class="co">#&gt; d[SEC_150]                                  2.21    0.00 0.12     1.99     2.13     2.21     2.28</span></span>
<span><span class="co">#&gt; d[SEC_300]                                  2.64    0.00 0.12     2.42     2.56     2.63     2.71</span></span>
<span><span class="co">#&gt; d[UST]                                      2.17    0.00 0.17     1.85     2.06     2.16     2.27</span></span>
<span><span class="co">#&gt; lp__                                    -7646.77    0.21 6.32 -7660.09 -7650.88 -7646.44 -7642.40</span></span>
<span><span class="co">#&gt; tau                                         0.13    0.00 0.07     0.02     0.09     0.13     0.17</span></span>
<span><span class="co">#&gt; cc[PASI75]                                  0.00     NaN 0.00     0.00     0.00     0.00     0.00</span></span>
<span><span class="co">#&gt; cc[PASI90]                                  0.69    0.00 0.02     0.66     0.68     0.69     0.70</span></span>
<span><span class="co">#&gt; cc[PASI100]                                 1.53    0.00 0.02     1.49     1.52     1.53     1.55</span></span>
<span><span class="co">#&gt;                                            97.5% n_eff Rhat</span></span>
<span><span class="co">#&gt; beta[durnpso]                               0.16  3817    1</span></span>
<span><span class="co">#&gt; beta[prevsys]                               0.16  4212    1</span></span>
<span><span class="co">#&gt; beta[bsa]                                   0.73  3325    1</span></span>
<span><span class="co">#&gt; beta[weight]                                0.10  3585    1</span></span>
<span><span class="co">#&gt; beta[psa]                                   0.27  4167    1</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]         0.12  3797    1</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL-12/23 blocker]     0.13  5280    1</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL-17 blocker]        0.10  4181    1</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]         0.54  4064    1</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL-12/23 blocker]     1.06  5604    1</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL-17 blocker]        0.46  4509    1</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]             1.31  3573    1</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL-12/23 blocker]         1.98  4347    1</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL-17 blocker]            1.29  3634    1</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassTNFa blocker]         -0.10  3833    1</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL-12/23 blocker]      0.00  5021    1</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL-17 blocker]        -0.07  4493    1</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassTNFa blocker]             0.35  4225    1</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL-12/23 blocker]         0.75  6190    1</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL-17 blocker]            0.43  4403    1</span></span>
<span><span class="co">#&gt; d[ETN]                                      1.81  2805    1</span></span>
<span><span class="co">#&gt; d[IXE_Q2W]                                  3.15  3031    1</span></span>
<span><span class="co">#&gt; d[IXE_Q4W]                                  2.95  2966    1</span></span>
<span><span class="co">#&gt; d[SEC_150]                                  2.47  2726    1</span></span>
<span><span class="co">#&gt; d[SEC_300]                                  2.88  2575    1</span></span>
<span><span class="co">#&gt; d[UST]                                      2.52  2667    1</span></span>
<span><span class="co">#&gt; lp__                                    -7635.39   899    1</span></span>
<span><span class="co">#&gt; tau                                         0.29   620    1</span></span>
<span><span class="co">#&gt; cc[PASI75]                                  0.00   NaN  NaN</span></span>
<span><span class="co">#&gt; cc[PASI90]                                  0.72  5665    1</span></span>
<span><span class="co">#&gt; cc[PASI100]                                 1.58  6212    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Sun Aug 28 14:09:25 2022.</span></span>
<span><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span><span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span></span>
<span><span class="co">#&gt; convergence, Rhat=1).</span></span></code></pre></div>
<p>The estimated between-study heterogeneity standard deviation <code>tau</code> is small compared to the relative treatment effects. We compare the model fit using the DIC:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_dic_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">pso_fit_FE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; Residual deviance: 8811.4 (on 12387 data points)</span></span>
<span><span class="co">#&gt;                pD: 36</span></span>
<span><span class="co">#&gt;               DIC: 8847.4</span></span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_dic_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">pso_fit_RE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; Residual deviance: 8800.1 (on 12387 data points)</span></span>
<span><span class="co">#&gt;                pD: 42.3</span></span>
<span><span class="co">#&gt;               DIC: 8842.4</span></span></code></pre></div>
<p>The DIC is lower for the RE model, indicating that there may be residual heterogeneity in the network and that the conditional constancy of relative effects assumption may be invalid—there may be additional effect modifiers that we have not accounted for. This result is different to the actual analysis reported by <span class="citation">Phillippo et al. (<a href="#ref-Phillippo2022" role="doc-biblioref">2022</a>)</span>, since here we are using synthetic IPD that have been simulated to closely resemble the original IPD. In the actual analysis the DIC was similar between the FE and RE models, so we might choose the more parsimonious FE model based on DIC alone, and there was no evidence for residual heterogeneity in this network.</p>
</div>
<div class="section level4">
<h4 id="assessing-residual-inconsistency-with-an-unrelated-mean-effects-ml-nmr">Assessing residual inconsistency with an unrelated mean effects ML-NMR<a class="anchor" aria-label="anchor" href="#assessing-residual-inconsistency-with-an-unrelated-mean-effects-ml-nmr"></a>
</h4>
<p>We assess residual inconsistency using an unrelated mean effects model <span class="citation">(<a href="#ref-TSD4" role="doc-biblioref">Dias et al. 2011</a>)</span>. Again, the call to the <code><a href="../reference/nma.html">nma()</a></code> function is identical, except this time we specify <code>consistency = "ume"</code>. Node-splitting is also a possibility (with <code>consistency = "nodesplit"</code>), but this takes substantially longer since the model is re-run for each node-split comparison. Here we will proceed as in the analysis of <span class="citation">Phillippo et al. (<a href="#ref-Phillippo2022" role="doc-biblioref">2022</a>)</span> and fit a fixed effect UME model (since there was no evidence for heterogeneity in the actual analysis); however, in our recreated analysis using synthetic IPD there was evidence of heterogeneity and we should really fit a random effects UME model instead.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_fit_UME</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">pso_net</span>, </span>
<span>                   trt_effects <span class="op">=</span> <span class="st">"fixed"</span>,</span>
<span>                   consistency <span class="op">=</span> <span class="st">"ume"</span>,</span>
<span>                   link <span class="op">=</span> <span class="st">"probit"</span>, </span>
<span>                   regression <span class="op">=</span> <span class="op">~</span><span class="op">(</span><span class="va">durnpso</span> <span class="op">+</span> <span class="va">prevsys</span> <span class="op">+</span> <span class="va">bsa</span> <span class="op">+</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">psa</span><span class="op">)</span><span class="op">*</span><span class="va">.trt</span>,</span>
<span>                   class_interactions <span class="op">=</span> <span class="st">"common"</span>,</span>
<span>                   prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                   prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                   prior_reg <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                   prior_aux <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">flat</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                   QR <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   init_r <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; Note: Setting "PBO" as the network reference treatment.</span></span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_fit_UME</span></span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; A fixed effects ML-NMR with a ordered likelihood (probit link).</span></span>
<span><span class="co">#&gt; An inconsistency model ('ume') was fitted.</span></span>
<span><span class="co">#&gt; Regression model: ~(durnpso + prevsys + bsa + weight + psa) * .trt.</span></span>
<span><span class="co">#&gt; Centred covariates at the following overall mean values:</span></span>
<span><span class="co">#&gt;   durnpso   prevsys       bsa    weight       psa </span></span>
<span><span class="co">#&gt; 1.8159830 0.6576489 0.2987820 8.9097263 0.2104826 </span></span>
<span><span class="co">#&gt; Inference for Stan model: ordered_multinomial.</span></span>
<span><span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span></span>
<span><span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                             mean se_mean   sd     2.5%      25%      50%      75%</span></span>
<span><span class="co">#&gt; beta[durnpso]                               0.03    0.00 0.06    -0.09    -0.01     0.03     0.07</span></span>
<span><span class="co">#&gt; beta[prevsys]                              -0.17    0.00 0.16    -0.47    -0.27    -0.17    -0.06</span></span>
<span><span class="co">#&gt; beta[bsa]                                  -0.09    0.01 0.44    -0.98    -0.38    -0.08     0.21</span></span>
<span><span class="co">#&gt; beta[weight]                                0.04    0.00 0.03    -0.01     0.02     0.04     0.06</span></span>
<span><span class="co">#&gt; beta[psa]                                  -0.08    0.00 0.17    -0.42    -0.20    -0.08     0.03</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]        -0.02    0.00 0.07    -0.16    -0.07    -0.02     0.03</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL-12/23 blocker]    -0.06    0.00 0.10    -0.26    -0.13    -0.06     0.01</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL-17 blocker]       -0.02    0.00 0.06    -0.14    -0.06    -0.02     0.02</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]         0.19    0.00 0.18    -0.16     0.07     0.19     0.31</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL-12/23 blocker]     0.45    0.01 0.35    -0.24     0.21     0.46     0.70</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL-17 blocker]        0.16    0.00 0.16    -0.16     0.05     0.16     0.27</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]             0.22    0.01 0.50    -0.76    -0.12     0.20     0.56</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL-12/23 blocker]         0.59    0.01 0.67    -0.72     0.13     0.60     1.05</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL-17 blocker]            0.26    0.01 0.46    -0.64    -0.05     0.25     0.56</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassTNFa blocker]         -0.16    0.00 0.03    -0.23    -0.18    -0.16    -0.14</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL-12/23 blocker]     -0.09    0.00 0.05    -0.18    -0.12    -0.09    -0.06</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL-17 blocker]        -0.13    0.00 0.03    -0.19    -0.15    -0.13    -0.11</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassTNFa blocker]            -0.05    0.00 0.20    -0.44    -0.18    -0.05     0.09</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL-12/23 blocker]         0.12    0.01 0.35    -0.54    -0.12     0.12     0.36</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL-17 blocker]            0.10    0.00 0.18    -0.26    -0.03     0.09     0.22</span></span>
<span><span class="co">#&gt; d[ETN vs. PBO]                              1.58    0.00 0.07     1.44     1.53     1.58     1.63</span></span>
<span><span class="co">#&gt; d[IXE_Q2W vs. PBO]                          2.91    0.00 0.07     2.77     2.86     2.91     2.96</span></span>
<span><span class="co">#&gt; d[IXE_Q4W vs. PBO]                          2.69    0.00 0.07     2.54     2.64     2.69     2.74</span></span>
<span><span class="co">#&gt; d[SEC_150 vs. PBO]                          2.19    0.00 0.08     2.02     2.13     2.19     2.25</span></span>
<span><span class="co">#&gt; d[SEC_300 vs. PBO]                          2.60    0.00 0.08     2.44     2.54     2.60     2.65</span></span>
<span><span class="co">#&gt; d[UST vs. IXE_Q2W]                         -0.78    0.00 0.16    -1.09    -0.89    -0.78    -0.68</span></span>
<span><span class="co">#&gt; d[UST vs. SEC_300]                         -0.47    0.00 0.09    -0.65    -0.53    -0.47    -0.41</span></span>
<span><span class="co">#&gt; lp__                                    -7640.40    0.10 4.39 -7650.22 -7643.16 -7639.97 -7637.34</span></span>
<span><span class="co">#&gt; cc[PASI75]                                  0.00     NaN 0.00     0.00     0.00     0.00     0.00</span></span>
<span><span class="co">#&gt; cc[PASI90]                                  0.69    0.00 0.02     0.65     0.68     0.69     0.70</span></span>
<span><span class="co">#&gt; cc[PASI100]                                 1.53    0.00 0.02     1.49     1.52     1.53     1.55</span></span>
<span><span class="co">#&gt;                                            97.5% n_eff Rhat</span></span>
<span><span class="co">#&gt; beta[durnpso]                               0.15  2591    1</span></span>
<span><span class="co">#&gt; beta[prevsys]                               0.14  2698    1</span></span>
<span><span class="co">#&gt; beta[bsa]                                   0.74  2778    1</span></span>
<span><span class="co">#&gt; beta[weight]                                0.10  2854    1</span></span>
<span><span class="co">#&gt; beta[psa]                                   0.25  2997    1</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassTNFa blocker]         0.12  2850    1</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL-12/23 blocker]     0.13  3732    1</span></span>
<span><span class="co">#&gt; beta[durnpso:.trtclassIL-17 blocker]        0.11  3146    1</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassTNFa blocker]         0.54  2803    1</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL-12/23 blocker]     1.09  4034    1</span></span>
<span><span class="co">#&gt; beta[prevsys:.trtclassIL-17 blocker]        0.48  3191    1</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassTNFa blocker]             1.20  2846    1</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL-12/23 blocker]         1.91  3889    1</span></span>
<span><span class="co">#&gt; beta[bsa:.trtclassIL-17 blocker]            1.19  3282    1</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassTNFa blocker]         -0.09  3169    1</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL-12/23 blocker]      0.00  4218    1</span></span>
<span><span class="co">#&gt; beta[weight:.trtclassIL-17 blocker]        -0.07  3421    1</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassTNFa blocker]             0.35  3036    1</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL-12/23 blocker]         0.81  4680    1</span></span>
<span><span class="co">#&gt; beta[psa:.trtclassIL-17 blocker]            0.45  3454    1</span></span>
<span><span class="co">#&gt; d[ETN vs. PBO]                              1.73  2815    1</span></span>
<span><span class="co">#&gt; d[IXE_Q2W vs. PBO]                          3.05  2892    1</span></span>
<span><span class="co">#&gt; d[IXE_Q4W vs. PBO]                          2.84  3286    1</span></span>
<span><span class="co">#&gt; d[SEC_150 vs. PBO]                          2.36  2992    1</span></span>
<span><span class="co">#&gt; d[SEC_300 vs. PBO]                          2.76  3203    1</span></span>
<span><span class="co">#&gt; d[UST vs. IXE_Q2W]                         -0.47  4990    1</span></span>
<span><span class="co">#&gt; d[UST vs. SEC_300]                         -0.29  6387    1</span></span>
<span><span class="co">#&gt; lp__                                    -7633.00  1771    1</span></span>
<span><span class="co">#&gt; cc[PASI75]                                  0.00   NaN  NaN</span></span>
<span><span class="co">#&gt; cc[PASI90]                                  0.72  3712    1</span></span>
<span><span class="co">#&gt; cc[PASI100]                                 1.58  3257    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Sun Aug 28 14:26:48 2022.</span></span>
<span><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span><span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span></span>
<span><span class="co">#&gt; convergence, Rhat=1).</span></span></code></pre></div>
<p>We compare model fit to the FE ML-NMR model using the DIC.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_dic_FE</span></span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; Residual deviance: 8811.4 (on 12387 data points)</span></span>
<span><span class="co">#&gt;                pD: 36</span></span>
<span><span class="co">#&gt;               DIC: 8847.4</span></span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_dic_UME</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">pso_fit_UME</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; Residual deviance: 8811.7 (on 12387 data points)</span></span>
<span><span class="co">#&gt;                pD: 36.3</span></span>
<span><span class="co">#&gt;               DIC: 8848</span></span></code></pre></div>
<p>The DIC values are similar between the FE model (assuming consistency) and the UME (inconsistency) model, which suggests no evidence for inconsistency overall. It is also important to compare the residual deviance contributions under each model to see whether there are any points that fit better under the UME model, as this can also indicate inconsistency. Using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function produces a “dev-dev” plot of the residual deviance contributions under either model.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_dic_FE</span>, <span class="va">pso_dic_UME</span>, show_uncertainty <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Residual deviance - consistency model"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Residual deviance - inconsistency (UME) model"</span><span class="op">)</span></span></code></pre></div>
<p><img src="pso-full-dev-dev-1.png" title="plot of pso-full-dev-dev" alt="plot of chunk pso-full-dev-dev" style="display: block; margin: auto;"></p>
<p>All points lie on the line of equality, so there is no evidence of inconsistency. If random effects models had been fitted then the heterogeneity estimates should also be compared as a drop in <code>tau</code> for the UME model can also indicate inconsistency.</p>
</div>
<div class="section level4">
<h4 id="relaxing-the-shared-effect-modifier-assumption">Relaxing the shared effect modifier assumption<a class="anchor" aria-label="anchor" href="#relaxing-the-shared-effect-modifier-assumption"></a>
</h4>
<p>The treatment classes in the network are as follows:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>classes <span class="op">=</span> <span class="va">pso_net</span><span class="op">$</span><span class="va">classes</span>, treatments <span class="op">=</span> <span class="va">pso_net</span><span class="op">$</span><span class="va">treatments</span><span class="op">)</span></span>
<span><span class="co">#&gt;            classes treatments</span></span>
<span><span class="co">#&gt; 1          Placebo        PBO</span></span>
<span><span class="co">#&gt; 2     TNFa blocker        ETN</span></span>
<span><span class="co">#&gt; 3    IL-17 blocker    IXE_Q2W</span></span>
<span><span class="co">#&gt; 4    IL-17 blocker    IXE_Q4W</span></span>
<span><span class="co">#&gt; 5    IL-17 blocker    SEC_150</span></span>
<span><span class="co">#&gt; 6    IL-17 blocker    SEC_300</span></span>
<span><span class="co">#&gt; 7 IL-12/23 blocker        UST</span></span></code></pre></div>
<p>We fitted common interaction terms within each treatment class, under the shared effect modifier assumption, in order to make the model estimable with the available data. Note that only the interleukin-17 blocker class has more than one treatment; etanercept and ustekinumab are in classes of their own and so are unaffected by specifying <code>class_interactions = "common"</code>. To assess this assumption we cannot simply fit independent interaction terms for all treatments and all effect modifiers at once as we do not have sufficient data. Instead, we relax this assumption one covariate at a time, estimating independent interactions for one covariate whilst keeping the shared effect modifier assumption (common interactions within each treatment class) for the other covariates.</p>
<p>To specify these relaxed models, we need to somehow mix <code>class_interactions = "common"</code> and <code>class_interactions = "independent"</code> for different covariates. The way we do this is with the <code>.trt</code> and <code>.trtclass</code> specials when specifying the regression model. To see how this works, first note that the model making the shared effect modifiers assumption</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>regression <span class="ot">=</span> <span class="er">~</span>(durnpso <span class="sc">+</span> prevsys <span class="sc">+</span> bsa <span class="sc">+</span> weight <span class="sc">+</span> psa)<span class="sc">*</span>.trt,</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>class_interactions <span class="ot">=</span> <span class="st">"common"</span></span></code></pre></div>
<p>can be written equivalently using the <code>.trtclass</code> special as</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regression</span> <span class="op">=</span> <span class="op">~</span><span class="op">(</span><span class="va">durnpso</span> <span class="op">+</span> <span class="va">prevsys</span> <span class="op">+</span> <span class="va">bsa</span> <span class="op">+</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">psa</span><span class="op">)</span><span class="op">*</span><span class="va">.trtclass</span></span></code></pre></div>
<p>The <code>.trtclass</code> special is essentially a factor variable containing the treatment classes, and is available any time treatment classes have been specified in the network; this regression formula therefore has a single interaction term for each covariate within each treatment class (the same result as specifying <code>class_interactions = "common"</code> above). Finally, to fit independent interactions for a single covariate, say <code>durnpso</code>, we split these out using the <code>.trt</code> special with <code>class_interactions = "independent"</code> (i.e. telling the model not to combine interactions for <code>.trt</code> within classes):</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>regression <span class="ot">=</span> <span class="er">~</span>(prevsys <span class="sc">+</span> bsa <span class="sc">+</span> weight <span class="sc">+</span> psa)<span class="sc">*</span>.trtclass <span class="sc">+</span> durnpso<span class="sc">*</span>.trt,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>class_interactions <span class="ot">=</span> <span class="st">"independent"</span></span></code></pre></div>
<p>Since we are fitting several of these models, let us set up a list of model specifications and iterate over these.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>noSEM_mods <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">durnpso =</span> <span class="sc">~</span>(prevsys <span class="sc">+</span> bsa <span class="sc">+</span> weight <span class="sc">+</span> psa)<span class="sc">*</span>.trtclass <span class="sc">+</span> durnpso<span class="sc">*</span>.trt,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">prevsys =</span> <span class="sc">~</span>(durnpso <span class="sc">+</span> bsa <span class="sc">+</span> weight <span class="sc">+</span> psa)<span class="sc">*</span>.trtclass <span class="sc">+</span> prevsys<span class="sc">*</span>.trt,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">bsa =</span> <span class="sc">~</span>(durnpso <span class="sc">+</span> prevsys <span class="sc">+</span> weight <span class="sc">+</span> psa)<span class="sc">*</span>.trtclass <span class="sc">+</span> bsa<span class="sc">*</span>.trt,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="sc">~</span>(durnpso <span class="sc">+</span> prevsys <span class="sc">+</span> bsa <span class="sc">+</span> psa)<span class="sc">*</span>.trtclass <span class="sc">+</span> weight<span class="sc">*</span>.trt,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">psa =</span> <span class="sc">~</span>(durnpso <span class="sc">+</span> prevsys <span class="sc">+</span> bsa <span class="sc">+</span> weight)<span class="sc">*</span>.trtclass <span class="sc">+</span> ps<span class="sc">*</span><span class="er">:</span>.trt</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>noSEM_fits <span class="ot">&lt;-</span> noSEM_mods</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(noSEM_mods)) {</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Fitting model with independent interactions for"</span>, <span class="fu">names</span>(noSEM_mods)[m], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  noSEM_fits[[m]] <span class="ot">&lt;-</span> </span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nma</span>(pso_net, </span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">trt_effects =</span> <span class="st">"fixed"</span>,</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">link =</span> <span class="st">"probit"</span>, </span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">regression =</span> noSEM_mods[[m]],</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">class_interactions =</span> <span class="st">"independent"</span>,</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">prior_intercept =</span> <span class="fu">normal</span>(<span class="at">scale =</span> <span class="dv">10</span>),</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">prior_trt =</span> <span class="fu">normal</span>(<span class="at">scale =</span> <span class="dv">10</span>),</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">prior_reg =</span> <span class="fu">normal</span>(<span class="at">scale =</span> <span class="dv">10</span>),</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">prior_aux =</span> <span class="fu">flat</span>(),</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">QR =</span> <span class="cn">TRUE</span>,</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">init_r =</span> <span class="fl">0.5</span>,</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Using save_warmup = FALSE reduces memory footprint when </span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># fitting many models in one session</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">save_warmup =</span> <span class="cn">FALSE</span>)</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; Fitting model with independent interactions for durnpso</span></span>
<span><span class="co">#&gt; Note: Setting "PBO" as the network reference treatment.</span></span>
<span><span class="co">#&gt; Fitting model with independent interactions for prevsys</span></span>
<span><span class="co">#&gt; Note: Setting "PBO" as the network reference treatment.</span></span>
<span><span class="co">#&gt; Fitting model with independent interactions for bsa</span></span>
<span><span class="co">#&gt; Note: Setting "PBO" as the network reference treatment.</span></span>
<span><span class="co">#&gt; Fitting model with independent interactions for weight</span></span>
<span><span class="co">#&gt; Note: Setting "PBO" as the network reference treatment.</span></span>
<span><span class="co">#&gt; Fitting model with independent interactions for psa</span></span>
<span><span class="co">#&gt; Note: Setting "PBO" as the network reference treatment.</span></span></code></pre></div>
<p>Comparing model fit using the DIC</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pso_dic_FE</span></span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; Residual deviance: 8811.4 (on 12387 data points)</span></span>
<span><span class="co">#&gt;                pD: 36</span></span>
<span><span class="co">#&gt;               DIC: 8847.4</span></span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">noSEM_fits</span>, <span class="va">dic</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; $durnpso</span></span>
<span><span class="co">#&gt; Residual deviance: 8812.5 (on 12387 data points)</span></span>
<span><span class="co">#&gt;                pD: 37.7</span></span>
<span><span class="co">#&gt;               DIC: 8850.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prevsys</span></span>
<span><span class="co">#&gt; Residual deviance: 8813.4 (on 12387 data points)</span></span>
<span><span class="co">#&gt;                pD: 37.8</span></span>
<span><span class="co">#&gt;               DIC: 8851.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bsa</span></span>
<span><span class="co">#&gt; Residual deviance: 8813 (on 12387 data points)</span></span>
<span><span class="co">#&gt;                pD: 37.8</span></span>
<span><span class="co">#&gt;               DIC: 8850.8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weight</span></span>
<span><span class="co">#&gt; Residual deviance: 8807.5 (on 12387 data points)</span></span>
<span><span class="co">#&gt;                pD: 37.9</span></span>
<span><span class="co">#&gt;               DIC: 8845.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $psa</span></span>
<span><span class="co">#&gt; Residual deviance: 8812.2 (on 12387 data points)</span></span>
<span><span class="co">#&gt;                pD: 37.8</span></span>
<span><span class="co">#&gt;               DIC: 8850</span></span></code></pre></div>
<p>All of the models have similar or higher DIC to the original model making the shared effect modifier assumption for all covariates, with the only exception being the model with independent interactions for <code>weight</code> which has slightly lower DIC.</p>
<p>We also visually examine the differences between the estimated interaction terms under the original model (shared effect modifier assumption for all covariates) and the relaxed models (independent interactions, one covariate at a time).</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract draws from relaxed models</span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/imap.html" class="external-link">imap_dfr</a></span><span class="op">(</span><span class="va">noSEM_fits</span>,</span>
<span>        <span class="op">~</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">.x</span>, pars <span class="op">=</span> <span class="st">"beta"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>           <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"parameter"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">parameter</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"(IXE|SEC).+:"</span>, <span class="va">.y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">.y</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="co"># Add in draws from the original model</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, pars <span class="op">=</span> <span class="st">"beta"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"parameter"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">parameter</span>, <span class="st">":.+IL\\-17 blocker"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Rescale BSA to per 10% </span></span>
<span>    value <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">parameter</span>, <span class="st">"bsa"</span><span class="op">)</span>, <span class="va">value</span> <span class="op">/</span> <span class="fl">10</span>, <span class="va">value</span><span class="op">)</span>,</span>
<span>    <span class="co"># Create labels</span></span>
<span>    covariate <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="va">parameter</span>, <span class="st">"durnpso|prevsys|bsa|weight|psa"</span><span class="op">)</span>,</span>
<span>    covariatef <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode_factor</a></span><span class="op">(</span><span class="va">covariate</span>,</span>
<span>                               durnpso <span class="op">=</span> <span class="st">"Duration of psoriasis, per 10 years"</span>,</span>
<span>                               prevsys <span class="op">=</span> <span class="st">"Previous systemic use"</span>,</span>
<span>                               bsa <span class="op">=</span> <span class="st">"Body surface area, per 10%"</span>,</span>
<span>                               weight <span class="op">=</span> <span class="st">"Weight, per 10 kg"</span>,</span>
<span>                               psa <span class="op">=</span> <span class="st">"Psoriatic arthritis"</span><span class="op">)</span>,</span>
<span>    treatment <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="va">parameter</span>, <span class="st">"\\.trt(class)?.+?(?=[\\]:])"</span><span class="op">)</span>,</span>
<span>                           <span class="st">"\\.trt(class)?"</span><span class="op">)</span>,</span>
<span>    Interactions <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_collapse.html" class="external-link">fct_collapse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, </span>
<span>                                Common <span class="op">=</span> <span class="st">"all"</span>, </span>
<span>                                other_level <span class="op">=</span> <span class="st">"Independent"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  </span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, y <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span>, colour <span class="op">=</span> <span class="va">Interactions</span>, fill <span class="op">=</span> <span class="va">Interactions</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, colour <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html" class="external-link">stat_halfeye</a></span><span class="op">(</span>normalize <span class="op">=</span> <span class="st">"panels"</span>, slab_alpha <span class="op">=</span> <span class="fl">0.3</span>, .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="st">"covariatef"</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Interaction effect (SMD)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Treatment / Class"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Common <span class="op">=</span> <span class="st">"#7B3294"</span>, Independent <span class="op">=</span> <span class="st">"#91D388"</span><span class="op">)</span>,</span>
<span>                      aesthetics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"colour"</span>, <span class="st">"fill"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_multinma.html">theme_multinma</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="pso-full-relaxing-SEM-1.png" title="plot of chunk pso-full-relaxing-SEM" alt="plot of chunk pso-full-relaxing-SEM" style="display: block; margin: auto;"></p>
<p>The independent interaction estimates are very similar to the common interaction estimates, but with much more uncertainty—particularly for the secukinumab regimens which are estimated only from aggregate data. The only exception is for weight, where there is some suggestion that this covariate may interact differently with the secukinumab treatment regimens to the ixekizumab regimens. However, the credible intervals for the secukinumab interactions are wide and overlap those for the ixekizumab regimens and the common interaction. Overall, there is some weak evidence that the shared effect modifier assumption (for the class of interleukin-17 blockers) may be invalid for weight. Since we are fitting multiple models here we should be mindful of multiple testing and the possibility that such differences have occurred by chance. On the other hand, this approach is likely to have low power to detect violations of the shared effect modifier assumption, particularly when the data are lacking. In this case, results from the model relaxing the shared effect modifier assumption for weight are very similar to the original model <span class="citation">(see <a href="#ref-Phillippo2022" role="doc-biblioref">Phillippo et al. 2022</a>)</span>.</p>
</div>
</div>
<div class="section level3">
<h3 id="producing-relative-effects-and-event-probabilities-1">Producing relative effects and event probabilities<a class="anchor" aria-label="anchor" href="#producing-relative-effects-and-event-probabilities-1"></a>
</h3>
<div class="section level4">
<h4 id="study-populations-included-in-the-network">Study populations included in the network<a class="anchor" aria-label="anchor" href="#study-populations-included-in-the-network"></a>
</h4>
<p>Population-average treatment effects can be produced for all the study populations represented in the network using the <code><a href="../reference/relative_effects.html">relative_effects()</a></code> function.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_releff_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relative_effects.html">relative_effects</a></span><span class="op">(</span><span class="va">pso_fit_FE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>These relative effects can then be plotted using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_releff_FE</span>, ref_line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="pso-full-releff-1.png" title="plot of chunk pso-full-releff" alt="plot of chunk pso-full-releff" style="display: block; margin: auto;"></p>
<p>Similarly, average response probabilities on each treatment, in each study population, at each PASI cutoff can be produced using the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function. We specify <code>type = "response"</code> to produce predicted probabilities (rather than probit-probabilities).</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_pred_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Again, these can be plotted using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_pred_FE</span>, ref_line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="pso-full-pred-1.png" title="plot of chunk pso-full-pred" alt="plot of chunk pso-full-pred" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="external-target-populations">External target populations<a class="anchor" aria-label="anchor" href="#external-target-populations"></a>
</h4>
<p>For the purposes of decision-making it is crucial that population-average estimates are produced for the decision target population of interest. The decision target population may not be represented by any of the study populations in the network, indeed it is likely best represented by an external registry or cohort study, or perhaps expert knowledge <span class="citation">(<a href="#ref-TSD18" role="doc-biblioref">Phillippo et al. 2016</a>)</span>.</p>
<p>As an example, <span class="citation">Phillippo et al. (<a href="#ref-Phillippo2022" role="doc-biblioref">2022</a>)</span> produce estimates for three external target populations represented by the PsoBEST registry <span class="citation">(<a href="#ref-Reich2015" role="doc-biblioref">Reich et al. 2015</a>; <a href="#ref-Augustin2014" role="doc-biblioref">Augustin et al. 2014</a>)</span>, and the PROSPECT <span class="citation">(<a href="#ref-Thaci2019" role="doc-biblioref">Thaçi et al. 2019</a>)</span> and Chiricozzi 2019 <span class="citation">(<a href="#ref-Chiricozzi2019" role="doc-biblioref">Chiricozzi et al. 2019</a>)</span> cohort studies. First of all, we need the covariate means and standard deviations in each of these populations:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_agd_means</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>             <span class="op">~</span><span class="va">study</span>, <span class="op">~</span><span class="va">covariate</span>,  <span class="op">~</span><span class="va">mean</span>,   <span class="op">~</span><span class="va">sd</span>,</span>
<span>          <span class="st">"PsoBest"</span>,      <span class="st">"bsa"</span>,     <span class="fl">24</span>,  <span class="fl">20.5</span>,</span>
<span>          <span class="st">"PsoBest"</span>,  <span class="st">"durnpso"</span>,   <span class="fl">18.2</span>,  <span class="fl">14.1</span>,</span>
<span>          <span class="st">"PsoBest"</span>,  <span class="st">"prevsys"</span>,   <span class="fl">0.54</span>,    <span class="cn">NA</span>,</span>
<span>          <span class="st">"PsoBest"</span>,      <span class="st">"psa"</span>,  <span class="fl">0.207</span>,    <span class="cn">NA</span>,</span>
<span>          <span class="st">"PsoBest"</span>,   <span class="st">"weight"</span>,     <span class="fl">85</span>,  <span class="fl">19.1</span>,</span>
<span>         <span class="st">"PROSPECT"</span>,      <span class="st">"bsa"</span>,   <span class="fl">18.7</span>,  <span class="fl">18.4</span>,</span>
<span>         <span class="st">"PROSPECT"</span>,  <span class="st">"durnpso"</span>,   <span class="fl">19.6</span>,  <span class="fl">13.5</span>,</span>
<span>         <span class="st">"PROSPECT"</span>,  <span class="st">"prevsys"</span>, <span class="fl">0.9095</span>,    <span class="cn">NA</span>,</span>
<span>         <span class="st">"PROSPECT"</span>,      <span class="st">"psa"</span>,  <span class="fl">0.202</span>,    <span class="cn">NA</span>,</span>
<span>         <span class="st">"PROSPECT"</span>,   <span class="st">"weight"</span>,   <span class="fl">87.5</span>,  <span class="fl">20.3</span>,</span>
<span>  <span class="st">"Chiricozzi 2019"</span>,      <span class="st">"bsa"</span>,     <span class="fl">23</span>, <span class="fl">16.79</span>,</span>
<span>  <span class="st">"Chiricozzi 2019"</span>,  <span class="st">"durnpso"</span>,  <span class="fl">16.93</span>, <span class="fl">10.82</span>,</span>
<span>  <span class="st">"Chiricozzi 2019"</span>,  <span class="st">"prevsys"</span>, <span class="fl">0.9061</span>,    <span class="cn">NA</span>,</span>
<span>  <span class="st">"Chiricozzi 2019"</span>,      <span class="st">"psa"</span>, <span class="fl">0.2152</span>,    <span class="cn">NA</span>,</span>
<span>  <span class="st">"Chiricozzi 2019"</span>,   <span class="st">"weight"</span>,   <span class="fl">78.3</span>, <span class="fl">15.87</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Tidy up</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="va">study</span>, </span>
<span>              names_from <span class="op">=</span> <span class="va">covariate</span>, </span>
<span>              values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span>,</span>
<span>              names_glue <span class="op">=</span> <span class="st">"{covariate}_{.value}"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># Rescale as per analysis</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">transmute</a></span><span class="op">(</span><span class="va">study</span>,</span>
<span>            bsa_mean <span class="op">=</span> <span class="va">bsa_mean</span> <span class="op">/</span> <span class="fl">100</span>, </span>
<span>            bsa_sd <span class="op">=</span> <span class="va">bsa_sd</span> <span class="op">/</span> <span class="fl">100</span>,</span>
<span>            weight_mean <span class="op">=</span> <span class="va">weight_mean</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>            weight_sd <span class="op">=</span> <span class="va">weight_sd</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>            durnpso_mean <span class="op">=</span> <span class="va">durnpso_mean</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>            durnpso_sd <span class="op">=</span> <span class="va">durnpso_sd</span> <span class="op">/</span> <span class="fl">10</span>,</span>
<span>            prevsys <span class="op">=</span> <span class="va">prevsys_mean</span>,</span>
<span>            psa <span class="op">=</span> <span class="va">psa_mean</span><span class="op">)</span></span></code></pre></div>
<p>To produce estimates of population-average treatment effects, we use the <code><a href="../reference/relative_effects.html">relative_effects()</a></code> function with the data frame of covariate means in the target populations as the <code>newdata</code> argument. We only need the covariate means, with variable names matching those in the regression.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_releff_FE_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relative_effects.html">relative_effects</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, </span>
<span>                                       newdata <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">transmute</a></span><span class="op">(</span><span class="va">new_agd_means</span>,</span>
<span>                                                           <span class="va">study</span>,</span>
<span>                                                           bsa <span class="op">=</span> <span class="va">bsa_mean</span>,</span>
<span>                                                           weight <span class="op">=</span> <span class="va">weight_mean</span>,</span>
<span>                                                           durnpso <span class="op">=</span> <span class="va">durnpso_mean</span>,</span>
<span>                                                           <span class="va">prevsys</span>,</span>
<span>                                                           <span class="va">psa</span><span class="op">)</span>,</span>
<span>                                       study <span class="op">=</span> <span class="va">study</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; -------------------------------------------------------- Study: Chiricozzi 2019 ---- </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span></span>
<span><span class="co">#&gt;     1.69    0.91 0.23   7.83 0.22</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                             mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; d[Chiricozzi 2019: ETN]     1.79 0.11 1.58 1.71 1.79 1.86  2.01     1618     2360    1</span></span>
<span><span class="co">#&gt; d[Chiricozzi 2019: IXE_Q2W] 3.07 0.10 2.87 3.00 3.07 3.14  3.28     1623     2630    1</span></span>
<span><span class="co">#&gt; d[Chiricozzi 2019: IXE_Q4W] 2.85 0.10 2.65 2.78 2.85 2.92  3.06     1782     2447    1</span></span>
<span><span class="co">#&gt; d[Chiricozzi 2019: SEC_150] 2.35 0.11 2.13 2.28 2.35 2.43  2.58     2248     2749    1</span></span>
<span><span class="co">#&gt; d[Chiricozzi 2019: SEC_300] 2.76 0.11 2.55 2.69 2.76 2.84  2.98     1883     2739    1</span></span>
<span><span class="co">#&gt; d[Chiricozzi 2019: UST]     2.30 0.15 2.02 2.20 2.30 2.40  2.58     2569     2878    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------- Study: PROSPECT ---- </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight psa</span></span>
<span><span class="co">#&gt;     1.96    0.91 0.19   8.75 0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                      mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; d[PROSPECT: ETN]     1.62 0.11 1.42 1.55 1.62 1.70  1.84     2215     2573    1</span></span>
<span><span class="co">#&gt; d[PROSPECT: IXE_Q2W] 2.94 0.10 2.74 2.87 2.93 3.00  3.13     2128     2844    1</span></span>
<span><span class="co">#&gt; d[PROSPECT: IXE_Q4W] 2.72 0.10 2.52 2.65 2.72 2.78  2.92     2329     2929    1</span></span>
<span><span class="co">#&gt; d[PROSPECT: SEC_150] 2.22 0.11 2.00 2.14 2.22 2.29  2.44     2719     3321    1</span></span>
<span><span class="co">#&gt; d[PROSPECT: SEC_300] 2.63 0.11 2.41 2.55 2.63 2.70  2.85     2295     3224    1</span></span>
<span><span class="co">#&gt; d[PROSPECT: UST]     2.18 0.15 1.89 2.08 2.18 2.28  2.47     3205     3089    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------------------- Study: PsoBest ---- </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariate values:</span></span>
<span><span class="co">#&gt;  durnpso prevsys  bsa weight  psa</span></span>
<span><span class="co">#&gt;     1.82    0.54 0.24    8.5 0.21</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; d[PsoBest: ETN]     1.61 0.08 1.46 1.56 1.61 1.66  1.77     2021     2876    1</span></span>
<span><span class="co">#&gt; d[PsoBest: IXE_Q2W] 2.93 0.08 2.78 2.87 2.93 2.98  3.08     1857     2249    1</span></span>
<span><span class="co">#&gt; d[PsoBest: IXE_Q4W] 2.71 0.08 2.56 2.66 2.71 2.76  2.86     2164     2259    1</span></span>
<span><span class="co">#&gt; d[PsoBest: SEC_150] 2.21 0.09 2.04 2.15 2.21 2.27  2.39     2451     2706    1</span></span>
<span><span class="co">#&gt; d[PsoBest: SEC_300] 2.62 0.09 2.45 2.56 2.62 2.67  2.79     2016     2919    1</span></span>
<span><span class="co">#&gt; d[PsoBest: UST]     2.08 0.13 1.82 1.99 2.08 2.17  2.34     2852     3123    1</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p>These estimates are plotted using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_releff_FE_new</span>, ref_line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="st">"Study"</span><span class="op">)</span></span></code></pre></div>
<p><img src="pso-full-releff-new-1.png" title="plot of chunk pso-full-releff-new" alt="plot of chunk pso-full-releff-new" style="display: block; margin: auto;"></p>
<p>Estimates of average event probabilities are produced by integrating predictions over the joint covariate distribution in each population. Since we have marginal summary statistics available, rather than full IPD, we create integration points using the <code><a href="../reference/add_integration.html">add_integration()</a></code> function by specifying the forms of the marginal distributions and the correlation matrix. We choose to use the same forms of the marginal distributions that we used when specifying integration points for the AgD studies in the network, and the weighted correlation matrix from the IPD studies.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_agd_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_integration.html">add_integration</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">new_agd_means</span>, <span class="va">study</span> <span class="op">!=</span> <span class="st">"PsoBest"</span><span class="op">)</span>,</span>
<span>                               durnpso <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">durnpso_mean</span>, sd <span class="op">=</span> <span class="va">durnpso_sd</span><span class="op">)</span>,</span>
<span>                               prevsys <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">prevsys</span><span class="op">)</span>,</span>
<span>                               bsa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qlogitnorm</span>, mean <span class="op">=</span> <span class="va">bsa_mean</span>, sd <span class="op">=</span> <span class="va">bsa_sd</span><span class="op">)</span>,</span>
<span>                               weight <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qgamma</span>, mean <span class="op">=</span> <span class="va">weight_mean</span>, sd <span class="op">=</span> <span class="va">weight_sd</span><span class="op">)</span>,</span>
<span>                               psa <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbern</span>, prob <span class="op">=</span> <span class="va">psa</span><span class="op">)</span>,</span>
<span>                               n_int <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                               cor <span class="op">=</span> <span class="va">pso_net</span><span class="op">$</span><span class="va">int_cor</span><span class="op">)</span></span></code></pre></div>
<p>We then use the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function to produce the average event probabilities (<code>type = "response"</code>, and <code>level = "aggregate"</code> which is the default) in each of the target populations. To do so, we also need to specify a distribution for the baseline event probabilities (i.e. probability of achieving PASI 75 response) in each of the target populations. PASI 75 event counts for individuals receiving secukinumab 300 mg treatment were available from PROSPECT (1156 achieved PASI 75 out of 1509) and Chiricozzi 2019 (243 out of 330), which we use to construct beta distributions on the baseline average response probabilities (we specify <code>baseline_level = "aggregate"</code> as these are population averages, rather than specific to a reference individual, and <code>baseline_type = "response"</code> as these are probabilities rather than transformed probit probabilities). No information on baseline response was available from PsoBest, so no predictions of absolute response rates could be made.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pso_pred_FE_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">pso_fit_FE</span>, </span>
<span>        type <span class="op">=</span> <span class="st">"response"</span>, </span>
<span>        newdata <span class="op">=</span> <span class="va">new_agd_int</span>,</span>
<span>        study <span class="op">=</span> <span class="va">study</span>,</span>
<span>        baseline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>PROSPECT <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbeta</span>, <span class="fl">1156</span>, <span class="fl">1509</span><span class="op">-</span><span class="fl">1156</span><span class="op">)</span>,</span>
<span>                        <span class="st">"Chiricozzi 2019"</span> <span class="op">=</span> <span class="fu"><a href="../reference/distr.html">distr</a></span><span class="op">(</span><span class="va">qbeta</span>, <span class="fl">243</span>, <span class="fl">330</span><span class="op">-</span><span class="fl">243</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        baseline_type <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>        baseline_level <span class="op">=</span> <span class="st">"aggregate"</span>,</span>
<span>        trt_ref <span class="op">=</span> <span class="st">"SEC_300"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; -------------------------------------------------------- Study: Chiricozzi 2019 ---- </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                         mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: PBO, PASI75]      0.02 0.01 0.01 0.01 0.02 0.02  0.03     2564     3595    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: PBO, PASI90]      0.00 0.00 0.00 0.00 0.00 0.00  0.01     2643     3414    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: PBO, PASI100]     0.00 0.00 0.00 0.00 0.00 0.00  0.00     2763     3690    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: ETN, PASI75]      0.37 0.04 0.30 0.34 0.37 0.40  0.46     4758     3892    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: ETN, PASI90]      0.16 0.03 0.11 0.14 0.16 0.18  0.22     4762     3997    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: ETN, PASI100]     0.03 0.01 0.02 0.03 0.03 0.04  0.05     4701     3931    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: IXE_Q2W, PASI75]  0.83 0.03 0.77 0.81 0.83 0.84  0.88     4481     3929    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: IXE_Q2W, PASI90]  0.60 0.04 0.52 0.57 0.60 0.63  0.68     4458     4057    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: IXE_Q2W, PASI100] 0.28 0.04 0.21 0.26 0.28 0.31  0.36     4418     4016    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: IXE_Q4W, PASI75]  0.76 0.03 0.70 0.74 0.77 0.79  0.83     4476     3773    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: IXE_Q4W, PASI90]  0.52 0.04 0.43 0.49 0.52 0.55  0.60     4444     3737    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: IXE_Q4W, PASI100] 0.22 0.03 0.16 0.19 0.21 0.24  0.28     4393     3701    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: SEC_150, PASI75]  0.59 0.04 0.52 0.57 0.59 0.62  0.66     4949     3965    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: SEC_150, PASI90]  0.33 0.03 0.26 0.30 0.33 0.35  0.40     4810     3887    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: SEC_150, PASI100] 0.10 0.02 0.07 0.09 0.10 0.11  0.14     4741     3846    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: SEC_300, PASI75]  0.74 0.02 0.69 0.72 0.74 0.75  0.78     3923     3931    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: SEC_300, PASI90]  0.48 0.03 0.42 0.46 0.48 0.50  0.54     3912     3974    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: SEC_300, PASI100] 0.19 0.02 0.15 0.17 0.19 0.20  0.23     3885     3933    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: UST, PASI75]      0.57 0.05 0.47 0.53 0.57 0.60  0.67     5538     3835    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: UST, PASI90]      0.31 0.05 0.22 0.28 0.31 0.34  0.41     5591     3798    1</span></span>
<span><span class="co">#&gt; pred[Chiricozzi 2019: UST, PASI100]     0.10 0.02 0.06 0.08 0.09 0.11  0.15     5462     3920    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------- Study: PROSPECT ---- </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                  mean   sd 2.5%  25%  50%  75% 97.5% Bulk_ESS Tail_ESS Rhat</span></span>
<span><span class="co">#&gt; pred[PROSPECT: PBO, PASI75]      0.03 0.01 0.02 0.03 0.03 0.04  0.05     2902     3561    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: PBO, PASI90]      0.01 0.00 0.00 0.00 0.01 0.01  0.01     3098     3528    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: PBO, PASI100]     0.00 0.00 0.00 0.00 0.00 0.00  0.00     3269     3415    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: ETN, PASI75]      0.40 0.03 0.33 0.38 0.40 0.42  0.47     5199     3240    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: ETN, PASI90]      0.18 0.02 0.14 0.16 0.18 0.20  0.23     5147     3365    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: ETN, PASI100]     0.04 0.01 0.03 0.04 0.04 0.05  0.06     4967     3490    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: IXE_Q2W, PASI75]  0.85 0.02 0.81 0.84 0.85 0.86  0.88     5001     3224    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: IXE_Q2W, PASI90]  0.64 0.03 0.57 0.62 0.64 0.66  0.70     4949     3615    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: IXE_Q2W, PASI100] 0.32 0.03 0.26 0.30 0.32 0.34  0.38     4883     3727    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: IXE_Q4W, PASI75]  0.79 0.02 0.74 0.78 0.79 0.81  0.84     5310     3627    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: IXE_Q4W, PASI90]  0.56 0.03 0.49 0.53 0.56 0.58  0.62     5152     3587    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: IXE_Q4W, PASI100] 0.25 0.03 0.19 0.23 0.24 0.26  0.30     4930     3584    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: SEC_150, PASI75]  0.63 0.03 0.58 0.61 0.63 0.65  0.68     5720     3577    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: SEC_150, PASI90]  0.36 0.03 0.31 0.35 0.36 0.38  0.42     5332     3598    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: SEC_150, PASI100] 0.12 0.01 0.09 0.11 0.12 0.13  0.15     5036     3554    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: SEC_300, PASI75]  0.77 0.01 0.74 0.76 0.77 0.77  0.79     3785     4056    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: SEC_300, PASI90]  0.52 0.02 0.49 0.51 0.52 0.53  0.55     3560     3888    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: SEC_300, PASI100] 0.22 0.01 0.19 0.21 0.22 0.23  0.24     3510     3811    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: UST, PASI75]      0.61 0.05 0.52 0.58 0.61 0.64  0.70     5992     3337    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: UST, PASI90]      0.35 0.04 0.27 0.32 0.35 0.38  0.44     6096     3471    1</span></span>
<span><span class="co">#&gt; pred[PROSPECT: UST, PASI100]     0.12 0.02 0.08 0.10 0.11 0.13  0.17     5841     3581    1</span></span></code></pre></div>
<p>Again, we then plot these estimates using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function, here with some customisation using ggplot syntax.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pso_pred_FE_new</span>, ref_line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="st">"Study"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">Category</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Blues"</span><span class="op">)</span></span></code></pre></div>
<p><img src="pso-full-pred-new-1.png" title="plot of chunk pso-full-pred-new" alt="plot of chunk pso-full-pred-new" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Augustin2014" class="csl-entry">
Augustin, Matthias, Christina Spehr, Marc A. Radtke, Wolf-Henning Boehncke, Thomas Luger, Ulrich Mrowietz, Michael Reusch, et al. 2014. <span>“German Psoriasis Registry <span>PsoBest</span>: Objectives, Methodology and Baseline Data.”</span> <em><span>JDDG</span>: Journal Der Deutschen Dermatologischen Gesellschaft</em> 12 (1): 48–57. <a href="https://doi.org/10.1111/ddg.12233" class="external-link">https://doi.org/10.1111/ddg.12233</a>.
</div>
<div id="ref-Caflisch1998" class="csl-entry">
Caflisch, R. E. 1998. <span>“Monte Carlo and Quasi-Monte Carlo Methods.”</span> <em>Acta Numerica</em> 7: 1–49. <a href="https://doi.org/10.1017/S0962492900002804" class="external-link">https://doi.org/10.1017/S0962492900002804</a>.
</div>
<div id="ref-Chiricozzi2019" class="csl-entry">
Chiricozzi, Andrea, Anna Balato, Curdin Conrad, Andrea Conti, Paolo Dapavo, Paulo Ferreira, Francesca Maria Gaiani, et al. 2019. <span>“Secukinumab Demonstrates Improvements in Absolute and Relative Psoriasis Area Severity Indices in Moderate-to-Severe Plaque Psoriasis: Results from a European, Multicentric, Retrospective, Real-World Study.”</span> <em>Journal of Dermatological Treatment</em> 31 (5): 476–83. <a href="https://doi.org/10.1080/09546634.2019.1671577" class="external-link">https://doi.org/10.1080/09546634.2019.1671577</a>.
</div>
<div id="ref-TSD4" class="csl-entry">
Dias, S., N. J. Welton, A. J. Sutton, D. M. Caldwell, G. Lu, and A. E. Ades. 2011. <span>“<span>NICE DSU Technical Support Document</span> 4: Inconsistency in Networks of Evidence Based on Randomised Controlled Trials.”</span> <span>National Institute for Health and Care Excellence</span>. <a href="https://nicedsu.sites.sheffield.ac.uk" class="external-link">https://nicedsu.sites.sheffield.ac.uk</a>.
</div>
<div id="ref-Gordon2016" class="csl-entry">
Gordon, K. B., A. Blauvelt, K. A. Papp, R. G. Langley, T. Luger, M. Ohtsuki, K. Reich, et al. 2016. <span>“Phase 3 Trials of Ixekizumab in Moderate-to-Severe Plaque Psoriasis.”</span> <em>New England Journal of Medicine</em> 375 (4): 345–56. <a href="https://doi.org/10.1056/nejmoa1512711" class="external-link">https://doi.org/10.1056/nejmoa1512711</a>.
</div>
<div id="ref-Griffiths2015" class="csl-entry">
Griffiths, C. E. M., K. Reich, M. Lebwohl, P. van de Kerkhof, C. Paul, A. Menter, G. S. Cameron, et al. 2015. <span>“Comparison of Ixekizumab with Etanercept or Placebo in Moderate-to-Severe Psoriasis (<span>UNCOVER</span>-2 and <span>UNCOVER</span>-3): Results from Two Phase 3 Randomised Trials.”</span> <em>The Lancet</em> 386 (9993): 541–51. <a href="https://doi.org/10.1016/s0140-6736(15)60125-8" class="external-link">https://doi.org/10.1016/s0140-6736(15)60125-8</a>.
</div>
<div id="ref-Langley2014" class="csl-entry">
Langley, R. G., B. E. Elewski, M. Lebwohl, K. Reich, C. E. M. Griffiths, K. Papp, L. Puig, et al. 2014. <span>“Secukinumab in Plaque Psoriasis — Results of Two Phase 3 Trials.”</span> <em>New England Journal of Medicine</em> 371 (4): 326–38. <a href="https://doi.org/10.1056/nejmoa1314258" class="external-link">https://doi.org/10.1056/nejmoa1314258</a>.
</div>
<div id="ref-Niederreiter1978" class="csl-entry">
Niederreiter, H. 1978. <span>“Quasi-Monte Carlo Methods and Pseudo-Random Numbers.”</span> <em>Bulletin of the American Mathematical Society</em> 84 (6): 957–1041. <a href="https://doi.org/10.1090/S0002-9904-1978-14532-7" class="external-link">https://doi.org/10.1090/S0002-9904-1978-14532-7</a>.
</div>
<div id="ref-Phillippo_thesis" class="csl-entry">
Phillippo, D. M. 2019. <span>“Calibration of Treatment Effects in Network Meta-Analysis Using Individual Patient Data.”</span> PhD thesis, University of Bristol.
</div>
<div id="ref-TSD18" class="csl-entry">
Phillippo, D. M., A. E. Ades, S. Dias, S. Palmer, K. R. Abrams, and N. J. Welton. 2016. <span>“<span>NICE DSU Technical Support Document</span> 18: Methods for Population-Adjusted Indirect Comparisons in Submission to <span>NICE</span>.”</span> <span>National Institute for Health and Care Excellence</span>. <a href="https://nicedsu.sites.sheffield.ac.uk" class="external-link">https://nicedsu.sites.sheffield.ac.uk</a>.
</div>
<div id="ref-Phillippo2022" class="csl-entry">
Phillippo, D. M., S. Dias, A. E. Ades, M. Belger, A. Brnabic, D. Saure, Y. Schymura, and N. J. Welton. 2022. <span>“Validating the Assumptions of Population Adjustment: Application of Multilevel Network Meta-Regression to a Network of Treatments for Plaque Psoriasis.”</span> <em>Medical Decision Making</em>. <a href="https://doi.org/10.1177/0272989X221117162" class="external-link">https://doi.org/10.1177/0272989X221117162</a>.
</div>
<div id="ref-methods_paper" class="csl-entry">
Phillippo, D. M., S. Dias, A. E. Ades, M. Belger, A. Brnabic, A. Schacht, D. Saure, Z. Kadziola, and N. J. Welton. 2020. <span>“Multilevel Network Meta-Regression for Population-Adjusted Treatment Comparisons.”</span> <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em> 183 (3): 1189–1210. <a href="https://doi.org/10.1111/rssa.12579" class="external-link">https://doi.org/10.1111/rssa.12579</a>.
</div>
<div id="ref-Reich2015" class="csl-entry">
Reich, K., U. Mrowietz, M. A. Radtke, D. Thaci, S. J. Rustenbach, C. Spehr, and M. Augustin. 2015. <span>“Drug Safety of Systemic Treatments for Psoriasis: Results from the German Psoriasis Registry <span>PsoBest</span>.”</span> <em>Archives of Dermatological Research</em> 307 (10): 875–83. <a href="https://doi.org/10.1007/s00403-015-1593-8" class="external-link">https://doi.org/10.1007/s00403-015-1593-8</a>.
</div>
<div id="ref-Thaci2019" class="csl-entry">
Thaçi, D., A. Körber, R. Kiedrowski, T. Bachhuber, N. Melzer, T. Kasparek, E. Duetting, G. Kraehn-Senftleben, U. Amon, and M. Augustin. 2019. <span>“Secukinumab Is Effective in Treatment of Moderate-to-Severe Plaque Psoriasis: Real-Life Effectiveness and Safety from the <span>PROSPECT</span> Study.”</span> <em>Journal of the European Academy of Dermatology and Venereology</em> 34 (2): 310–18. <a href="https://doi.org/10.1111/jdv.15962" class="external-link">https://doi.org/10.1111/jdv.15962</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by David M. Phillippo.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  <script data-goatcounter="https://multinma.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</body>
</html>
