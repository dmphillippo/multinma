<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Distribution functions for M-spline baseline hazards — dmspline • multinma</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Distribution functions for M-spline baseline hazards — dmspline"><meta name="description" content="Density, distribution, quantile, hazard, cumulative hazard, and restricted
mean survival time functions for the M-spline baseline hazards model."><meta property="og:description" content="Density, distribution, quantile, hazard, cumulative hazard, and restricted
mean survival time functions for the M-spline baseline hazards model."><meta property="og:image" content="https://dmphillippo.github.io/multinma/logo.svg"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multinma</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.7.2.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vignette_overview.html">Overview of Examples</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Examples</h6></li>
    <li><a class="dropdown-item" href="../articles/example_atrial_fibrillation.html">Example: Atrial fibrillation</a></li>
    <li><a class="dropdown-item" href="../articles/example_bcg_vaccine.html">Example: BCG vaccine for tuberculosis</a></li>
    <li><a class="dropdown-item" href="../articles/example_blocker.html">Example: Beta blockers</a></li>
    <li><a class="dropdown-item" href="../articles/example_diabetes.html">Example: Diabetes</a></li>
    <li><a class="dropdown-item" href="../articles/example_dietary_fat.html">Example: Dietary fat</a></li>
    <li><a class="dropdown-item" href="../articles/example_hta_psoriasis.html">Example: Plaque psoriasis HTA report</a></li>
    <li><a class="dropdown-item" href="../articles/example_ndmm.html">Example: Newly diagnosed multiple myeloma</a></li>
    <li><a class="dropdown-item" href="../articles/example_parkinsons.html">Example: Parkinson's disease</a></li>
    <li><a class="dropdown-item" href="../articles/example_plaque_psoriasis.html">Example: Plaque psoriasis ML-NMR</a></li>
    <li><a class="dropdown-item" href="../articles/example_smoking.html">Example: Smoking cessation</a></li>
    <li><a class="dropdown-item" href="../articles/example_statins.html">Example: Statins for cholesterol lowering</a></li>
    <li><a class="dropdown-item" href="../articles/example_thrombolytics.html">Example: Thrombolytic treatments</a></li>
    <li><a class="dropdown-item" href="../articles/example_transfusion.html">Example: White blood cell transfusion</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dmphillippo/multinma/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Distribution functions for M-spline baseline hazards</h1>
      <small class="dont-index">Source: <a href="https://github.com/dmphillippo/multinma/blob/develop/R/mspline.R" class="external-link"><code>R/mspline.R</code></a></small>
      <div class="d-none name"><code>mspline.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Density, distribution, quantile, hazard, cumulative hazard, and restricted
mean survival time functions for the M-spline baseline hazards model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dmspline</span><span class="op">(</span><span class="va">x</span>, <span class="va">basis</span>, <span class="va">scoef</span>, <span class="va">rate</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pmspline</span><span class="op">(</span><span class="va">q</span>, <span class="va">basis</span>, <span class="va">scoef</span>, <span class="va">rate</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span>, log.p <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">qmspline</span><span class="op">(</span><span class="va">p</span>, <span class="va">basis</span>, <span class="va">scoef</span>, <span class="va">rate</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span>, log.p <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmspline</span><span class="op">(</span><span class="va">x</span>, <span class="va">basis</span>, <span class="va">scoef</span>, <span class="va">rate</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Hmspline</span><span class="op">(</span><span class="va">x</span>, <span class="va">basis</span>, <span class="va">scoef</span>, <span class="va">rate</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rmst_mspline</span><span class="op">(</span><span class="va">t</span>, <span class="va">basis</span>, <span class="va">scoef</span>, <span class="va">rate</span>, start <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x-q">x, q<a class="anchor" aria-label="anchor" href="#arg-x-q"></a></dt>
<dd><p>Vector of quantiles</p></dd>


<dt id="arg-basis">basis<a class="anchor" aria-label="anchor" href="#arg-basis"></a></dt>
<dd><p>M-spline basis produced by <code><a href="https://wwenjie.org/splines2/reference/mSpline.html" class="external-link">splines2::mSpline()</a></code></p></dd>


<dt id="arg-scoef">scoef<a class="anchor" aria-label="anchor" href="#arg-scoef"></a></dt>
<dd><p>Vector (or matrix) of spline coefficients with length (or number
of columns) equal to the dimension of <code>basis</code></p></dd>


<dt id="arg-rate">rate<a class="anchor" aria-label="anchor" href="#arg-rate"></a></dt>
<dd><p>Vector of rate parameters</p></dd>


<dt id="arg-log-log-p">log, log.p<a class="anchor" aria-label="anchor" href="#arg-log-log-p"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, probabilities <code>p</code> are given as
\(\log(p)\)</p></dd>


<dt id="arg-lower-tail">lower.tail<a class="anchor" aria-label="anchor" href="#arg-lower-tail"></a></dt>
<dd><p>Logical; if <code>TRUE</code> (the default), probabilities are
\(P(X \le x)\), otherwise \(P(X &gt; x)\)</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Vector of probabilities</p></dd>


<dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>Vector of times to which the restricted mean survival time is
calculated</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>Optional left-truncation time or times. The returned restricted
mean survival will be conditioned on survival up to this time</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>dmspline()</code> gives the density, <code>pmspline()</code> gives the distribution
function (CDF), <code>qmspline()</code> gives the quantile function (inverse-CDF),
<code>hmspline()</code> gives the hazard function, <code>Hmspline()</code> gives the cumulative
hazard function, and <code>rmst_mspline()</code> gives restricted mean survival times.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Survival models with a flexible M-spline on the baseline hazard are
described by Brilleman2020;textualmultinma.
Piecewise-exponential baseline hazards are a special case where the degree
of the M-spline polynomial is 0.</p>
<p>The d/p/h/H functions are calculated from their definitions. <code>qmspline()</code>
uses numerical inversion via <code><a href="http://chjackson.github.io/flexsurv-dev/reference/qgeneric.html" class="external-link">flexsurv::qgeneric()</a></code>. <code>rmst_mspline()</code>uses
numerical integration via <code><a href="http://chjackson.github.io/flexsurv-dev/reference/rmst_generic.html" class="external-link">flexsurv::rmst_generic()</a></code>, except for the
special case of the piecewise-exponential hazard (i.e. degree 0 M-splines)
which uses the explicit formula from
Royston2013;textualmultinma.</p>
<p>Beyond the boundary knots, the hazard is assumed to be constant. (This
differs from the approach in <code><a href="https://wwenjie.org/splines2/reference/mSpline.html" class="external-link">splines2::mSpline()</a></code> that extrapolates the
polynomial basis functions, which is numerically unstable and highly
dependent on the data just before the boundary knots.) As with all
extrapolation, care should be taken when evaluating the splines at times
beyond the boundary knots (either directly through the d/p/h/H/rmst
functions, or indirectly by requesting quantiles with <code>qmspline()</code> that
correspond to times beyond the boundary knots). For this reason evaluating
the (unrestricted) mean survival time is not generally recommended as this
requires integrating over an infinite time horizon (i.e. <code>rmst_mspline()</code>
with <code>t = Inf</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David M. Phillippo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>



  <script data-goatcounter="https://multinma.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></body></html>

