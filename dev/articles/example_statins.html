<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example: Statins for cholesterol lowering • multinma</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Example: Statins for cholesterol lowering">
<meta property="og:description" content="multinma">
<meta property="og:image" content="https://dmphillippo.github.io/multinma/logo.svg">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multinma</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette_overview.html">Overview of Examples</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Examples</li>
    <li>
      <a href="../articles/example_atrial_fibrillation.html">Example: Atrial fibrillation</a>
    </li>
    <li>
      <a href="../articles/example_bcg_vaccine.html">Example: BCG vaccine for tuberculosis</a>
    </li>
    <li>
      <a href="../articles/example_blocker.html">Example: Beta blockers</a>
    </li>
    <li>
      <a href="../articles/example_diabetes.html">Example: Diabetes</a>
    </li>
    <li>
      <a href="../articles/example_dietary_fat.html">Example: Dietary fat</a>
    </li>
    <li>
      <a href="../articles/example_hta_psoriasis.html">Example: Plaque psoriasis HTA report</a>
    </li>
    <li>
      <a href="../articles/example_parkinsons.html">Example: Parkinson's disease</a>
    </li>
    <li>
      <a href="../articles/example_plaque_psoriasis.html">Example: Plaque psoriasis ML-NMR</a>
    </li>
    <li>
      <a href="../articles/example_smoking.html">Example: Smoking cessation</a>
    </li>
    <li>
      <a href="../articles/example_statins.html">Example: Statins for cholesterol lowering</a>
    </li>
    <li>
      <a href="../articles/example_thrombolytics.html">Example: Thrombolytic treatments</a>
    </li>
    <li>
      <a href="../articles/example_transfusion.html">Example: White blood cell transfusion</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dmphillippo/multinma/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="example_statins_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example: Statins for cholesterol lowering</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dmphillippo/multinma/blob/master/vignettes/example_statins.Rmd"><code>vignettes/example_statins.Rmd</code></a></small>
      <div class="hidden name"><code>example_statins.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dmphillippo.github.io/multinma/">multinma</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; For execution on a local, multicore CPU with excess RAM we recommend calling
#&gt; options(mc.cores = parallel::detectCores())
#&gt; 
#&gt; Attaching package: 'multinma'
#&gt; The following objects are masked from 'package:stats':
#&gt; 
#&gt;     dgamma, pgamma, qgamma</code></pre>
<p>This vignette describes the analysis of 19 trials comparing statins to placebo or usual care <span class="citation">(Dias et al. 2011)</span>. The data are available in this package as <code>statins</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">statins</span><span class="op">)</span>
<span class="co">#&gt;   studyn    studyc trtn    trtc prevention   r    n</span>
<span class="co">#&gt; 1      1        4S    1 Placebo  Secondary 256 2223</span>
<span class="co">#&gt; 2      1        4S    2  Statin  Secondary 182 2221</span>
<span class="co">#&gt; 3      2 Bestehorn    1 Placebo  Secondary   4  125</span>
<span class="co">#&gt; 4      2 Bestehorn    2  Statin  Secondary   1  129</span>
<span class="co">#&gt; 5      3     Brown    1 Placebo  Secondary   0   52</span>
<span class="co">#&gt; 6      3     Brown    2  Statin  Secondary   1   94</span></code></pre></div>
<p><span class="citation">Dias et al. (2011)</span> used these data to demonstrate meta-regression models adjusting for the binary covariate <code>prevention</code> (primary or secondary prevention), which we recreate here.</p>
<div id="setting-up-the-network" class="section level3">
<h3 class="hasAnchor">
<a href="#setting-up-the-network" class="anchor"></a>Setting up the network</h3>
<p>We have data giving the number of deaths (<code>r</code>) out of the total (<code>n</code>) in each arm, so we use the function <code><a href="../reference/set_agd_arm.html">set_agd_arm()</a></code> to set up the network. We set placebo as the network reference treatment.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">statin_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_agd_arm.html">set_agd_arm</a></span><span class="op">(</span><span class="va">statins</span>, 
                          study <span class="op">=</span> <span class="va">studyc</span>,
                          trt <span class="op">=</span> <span class="va">trtc</span>,
                          r <span class="op">=</span> <span class="va">r</span>, 
                          n <span class="op">=</span> <span class="va">n</span>,
                          trt_ref <span class="op">=</span> <span class="st">"Placebo"</span><span class="op">)</span>
<span class="va">statin_net</span>
<span class="co">#&gt; A network with 19 AgD studies (arm-based).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ------------------------------------------------------- AgD studies (arm-based) ---- </span>
<span class="co">#&gt;  Study     Treatments         </span>
<span class="co">#&gt;  4S        2: Placebo | Statin</span>
<span class="co">#&gt;  Bestehorn 2: Placebo | Statin</span>
<span class="co">#&gt;  Brown     2: Placebo | Statin</span>
<span class="co">#&gt;  CCAIT     2: Placebo | Statin</span>
<span class="co">#&gt;  Downs     2: Placebo | Statin</span>
<span class="co">#&gt;  EXCEL     2: Placebo | Statin</span>
<span class="co">#&gt;  Furberg   2: Placebo | Statin</span>
<span class="co">#&gt;  Haskell   2: Placebo | Statin</span>
<span class="co">#&gt;  Jones     2: Placebo | Statin</span>
<span class="co">#&gt;  KAPS      2: Placebo | Statin</span>
<span class="co">#&gt;  ... plus 9 more studies</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Outcome type: count</span>
<span class="co">#&gt; ------------------------------------------------------------------------------------</span>
<span class="co">#&gt; Total number of treatments: 2</span>
<span class="co">#&gt; Total number of studies: 19</span>
<span class="co">#&gt; Reference treatment is: Placebo</span>
<span class="co">#&gt; Network is connected</span></code></pre></div>
<p>The <code>prevention</code> variable in the <code>statins</code> data frame will automatically be available to use in a meta-regression model.</p>
</div>
<div id="meta-analysis-models" class="section level3">
<h3 class="hasAnchor">
<a href="#meta-analysis-models" class="anchor"></a>Meta-analysis models</h3>
<p>We fit fixed effect (FE) and random effects (RE) models, with a meta-regression on the binary covariate <code>prevention</code>.</p>
<div id="fixed-effect-meta-regression" class="section level4">
<h4 class="hasAnchor">
<a href="#fixed-effect-meta-regression" class="anchor"></a>Fixed effect meta-regression</h4>
<p>We start by fitting a FE model. We use <span class="math inline">\(\mathrm{N}(0, 100^2)\)</span> prior distributions for the treatment effect <span class="math inline">\(d_\mathrm{Statin}\)</span>, study-specific intercepts <span class="math inline">\(\mu_j\)</span>, and regression coefficient <span class="math inline">\(\beta\)</span>. We can examine the range of parameter values implied by these prior distributions with the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> method:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; A Normal prior distribution: location = 0, scale = 100.</span>
<span class="co">#&gt; 50% of the prior density lies between -67.45 and 67.45.</span>
<span class="co">#&gt; 95% of the prior density lies between -196 and 196.</span></code></pre></div>
<p>The model is fitted with the <code><a href="../reference/nma.html">nma()</a></code> function, with a fixed effect model specified by <code>trt_effects = "fixed"</code>. The <code>regression</code> formula <code>~ .trt:prevention</code> means that interaction of primary/secondary prevention with treatment will be included; the <code>.trt</code> special variable indicates treatment, and <code>prevention</code> is in the original data set.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">statin_fit_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">statin_net</span>, 
                     trt_effects <span class="op">=</span> <span class="st">"fixed"</span>,
                     regression <span class="op">=</span> <span class="op">~</span><span class="va">.trt</span><span class="op">:</span><span class="va">prevention</span>,
                     prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,
                     prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,
                     prior_reg <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Note: No treatment classes specified in network, any interactions in `regression` formula will be separate (independent) for each treatment.</span>
<span class="co">#&gt; Use set_*() argument `trt_class` and nma() argument `class_interactions` to change this.</span></code></pre></div>
<p>Basic parameter summaries are given by the <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> method:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">statin_fit_FE</span>
<span class="co">#&gt; A fixed effects NMA with a binomial likelihood (logit link).</span>
<span class="co">#&gt; Regression model: ~.trt:prevention.</span>
<span class="co">#&gt; Inference for Stan model: binomial_1par.</span>
<span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span>
<span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                          mean se_mean   sd     2.5%      25%      50%      75%</span>
<span class="co">#&gt; beta[.trtStatin:preventionSecondary]    -0.21    0.00 0.11    -0.43    -0.28    -0.21    -0.14</span>
<span class="co">#&gt; d[Statin]                               -0.10    0.00 0.10    -0.29    -0.17    -0.10    -0.04</span>
<span class="co">#&gt; lp__                                 -7246.77    0.09 3.39 -7254.37 -7248.89 -7246.46 -7244.38</span>
<span class="co">#&gt;                                         97.5% n_eff Rhat</span>
<span class="co">#&gt; beta[.trtStatin:preventionSecondary]     0.00  2356    1</span>
<span class="co">#&gt; d[Statin]                                0.09  2383    1</span>
<span class="co">#&gt; lp__                                 -7240.96  1580    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Tue Nov 23 18:39:42 2021.</span>
<span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span>
<span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span>
<span class="co">#&gt; convergence, Rhat=1).</span></code></pre></div>
<p>By default, summaries of the study-specific intercepts <span class="math inline">\(\mu_j\)</span> are hidden, but could be examined by changing the <code>pars</code> argument:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Not run</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">statin_fit_FE</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"beta"</span>, <span class="st">"mu"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The prior and posterior distributions can be compared visually using the <code><a href="../reference/plot_prior_posterior.html">plot_prior_posterior()</a></code> function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_prior_posterior.html">plot_prior_posterior</a></span><span class="op">(</span><span class="va">statin_fit_FE</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"trt"</span>, <span class="st">"reg"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example_statins_files/figure-html/statin_FE_pp_plot-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="random-effects-meta-regression" class="section level4">
<h4 class="hasAnchor">
<a href="#random-effects-meta-regression" class="anchor"></a>Random effects meta-regression</h4>
<p>We now fit a RE model. We use <span class="math inline">\(\mathrm{N}(0, 100^2)\)</span> prior distributions for the treatment effect <span class="math inline">\(d_\mathrm{Statin}\)</span>, study-specific intercepts <span class="math inline">\(\mu_j\)</span>, and regression coefficient <span class="math inline">\(\beta\)</span>. We use a <span class="math inline">\(\textrm{half-N}(0, 5^2)\)</span> prior distribution for the heterogeneity standard deviation <span class="math inline">\(\tau\)</span>. We can examine the range of parameter values implied by these prior distributions with the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> method:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; A Normal prior distribution: location = 0, scale = 100.</span>
<span class="co">#&gt; 50% of the prior density lies between -67.45 and 67.45.</span>
<span class="co">#&gt; 95% of the prior density lies between -196 and 196.</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/priors.html">half_normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; A half-Normal prior distribution: location = 0, scale = 5.</span>
<span class="co">#&gt; 50% of the prior density lies between 0 and 3.37.</span>
<span class="co">#&gt; 95% of the prior density lies between 0 and 9.8.</span></code></pre></div>
<p>Again, the model is fitted with the <code><a href="../reference/nma.html">nma()</a></code> function, now with <code>trt_effects = "random"</code>. We increase <code>adapt_delta</code> to 0.99 to remove a small number of divergent transition errors (the default for RE models is set to 0.95).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">statin_fit_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.html">nma</a></span><span class="op">(</span><span class="va">statin_net</span>, 
                     trt_effects <span class="op">=</span> <span class="st">"random"</span>,
                     regression <span class="op">=</span> <span class="op">~</span><span class="va">.trt</span><span class="op">:</span><span class="va">prevention</span>,
                     prior_intercept <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,
                     prior_trt <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,
                     prior_reg <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,
                     prior_het <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">half_normal</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,
                     adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span>
<span class="co">#&gt; Note: No treatment classes specified in network, any interactions in `regression` formula will be separate (independent) for each treatment.</span>
<span class="co">#&gt; Use set_*() argument `trt_class` and nma() argument `class_interactions` to change this.</span></code></pre></div>
<p>Basic parameter summaries are given by the <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> method:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">statin_fit_RE</span>
<span class="co">#&gt; A random effects NMA with a binomial likelihood (logit link).</span>
<span class="co">#&gt; Regression model: ~.trt:prevention.</span>
<span class="co">#&gt; Inference for Stan model: binomial_1par.</span>
<span class="co">#&gt; 4 chains, each with iter=2000; warmup=1000; thin=1; </span>
<span class="co">#&gt; post-warmup draws per chain=1000, total post-warmup draws=4000.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                          mean se_mean   sd     2.5%      25%      50%      75%</span>
<span class="co">#&gt; beta[.trtStatin:preventionSecondary]    -0.30    0.01 0.25    -0.84    -0.43    -0.28    -0.15</span>
<span class="co">#&gt; d[Statin]                               -0.07    0.01 0.20    -0.48    -0.18    -0.07     0.04</span>
<span class="co">#&gt; lp__                                 -7255.76    0.17 5.25 -7266.96 -7259.09 -7255.54 -7252.22</span>
<span class="co">#&gt; tau                                      0.24    0.01 0.20     0.01     0.09     0.19     0.34</span>
<span class="co">#&gt;                                         97.5% n_eff Rhat</span>
<span class="co">#&gt; beta[.trtStatin:preventionSecondary]     0.18  1421    1</span>
<span class="co">#&gt; d[Statin]                                0.34  1402    1</span>
<span class="co">#&gt; lp__                                 -7246.05   985    1</span>
<span class="co">#&gt; tau                                      0.76   761    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Tue Nov 23 18:40:01 2021.</span>
<span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span>
<span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span>
<span class="co">#&gt; convergence, Rhat=1).</span></code></pre></div>
<p>By default, summaries of the study-specific intercepts <span class="math inline">\(\mu_j\)</span> and study-specific relative effects <span class="math inline">\(\delta_{jk}\)</span> are hidden, but could be examined by changing the <code>pars</code> argument:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Not run</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">statin_fit_RE</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"beta"</span>, <span class="st">"mu"</span>, <span class="st">"delta"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The prior and posterior distributions can be compared visually using the <code><a href="../reference/plot_prior_posterior.html">plot_prior_posterior()</a></code> function:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_prior_posterior.html">plot_prior_posterior</a></span><span class="op">(</span><span class="va">statin_fit_RE</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"trt"</span>, <span class="st">"reg"</span>, <span class="st">"het"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example_statins_files/figure-html/statin_RE_pp_plot-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="model-fit-and-comparison" class="section level3">
<h3 class="hasAnchor">
<a href="#model-fit-and-comparison" class="anchor"></a>Model fit and comparison</h3>
<p>Model fit can be checked using the <code><a href="../reference/dic.html">dic()</a></code> function:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">statin_dic_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">statin_fit_FE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Residual deviance: 46.1 (on 38 data points)</span>
<span class="co">#&gt;                pD: 21.9</span>
<span class="co">#&gt;               DIC: 68</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">statin_dic_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dic.html">dic</a></span><span class="op">(</span><span class="va">statin_fit_RE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Residual deviance: 42.4 (on 38 data points)</span>
<span class="co">#&gt;                pD: 24.9</span>
<span class="co">#&gt;               DIC: 67.3</span></code></pre></div>
<p>The DIC is very similar between FE and RE models, so we might choose the FE model based on parsimony. The residual deviance statistics are larger than the number of data points, suggesting that some data points are not fit well.</p>
<p>We can also examine the residual deviance contributions with the corresponding <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> method.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">statin_dic_FE</span><span class="op">)</span></code></pre></div>
<p><img src="example_statins_files/figure-html/statin_FE_resdev_plot-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">statin_dic_RE</span><span class="op">)</span></code></pre></div>
<p><img src="example_statins_files/figure-html/statin_RE_resdev_plot-1.png" width="700" style="display: block; margin: auto;"></p>
<p>There are a number of studies which are not fit well under either model, having posterior mean residual deviance contributions greater than 1, and should be investigated to see if there are further substantive differences between studies.</p>
</div>
<div id="further-results" class="section level2">
<h2 class="hasAnchor">
<a href="#further-results" class="anchor"></a>Further results</h2>
<p>We can produce estimates of the relative effect of statins vs. placebo for either primary or secondary prevention, using the <code><a href="../reference/relative_effects.html">relative_effects()</a></code> function. The <code>newdata</code> argument specifies a data frame containing the levels of the covariate <code>prevention</code> that we are interested in, and the <code>study</code> argument is used to specify a column of <code>newdata</code> for an informative label.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">statin_releff_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relative_effects.html">relative_effects</a></span><span class="op">(</span><span class="va">statin_fit_FE</span>,
                                     newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>prevention <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Primary"</span>, <span class="st">"Secondary"</span><span class="op">)</span><span class="op">)</span>,
                                     study <span class="op">=</span> <span class="va">prevention</span><span class="op">)</span>

<span class="va">statin_releff_FE</span>
<span class="co">#&gt; ---------------------------------------------------------------- Study: Primary ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  prevention</span>
<span class="co">#&gt;     Primary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                    mean  sd  2.5%   25%  50%   75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; d[Primary: Statin] -0.1 0.1 -0.29 -0.17 -0.1 -0.04  0.09     2407     2870    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- Study: Secondary ---- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariate values:</span>
<span class="co">#&gt;  prevention</span>
<span class="co">#&gt;   Secondary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                       mean   sd  2.5%   25%   50%   75% 97.5% Bulk_ESS Tail_ESS Rhat</span>
<span class="co">#&gt; d[Secondary: Statin] -0.31 0.05 -0.42 -0.35 -0.31 -0.27 -0.21     4524     3274    1</span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> method may be used to visually compare these estimates:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">statin_releff_FE</span>, 
     ref_line <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p><img src="example_statins_files/figure-html/statins_releff_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Model parameters may be plotted with the corresponding <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> method:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">statin_fit_FE</span>, 
     pars <span class="op">=</span> <span class="st">"beta"</span>, 
     ref_line <span class="op">=</span> <span class="fl">0</span>,
     stat <span class="op">=</span> <span class="st">"halfeye"</span><span class="op">)</span></code></pre></div>
<p><img src="example_statins_files/figure-html/statins_beta_FE-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Whilst the 95% Credible Interval includes zero, there is a suggestion that statins are more effective for secondary prevention.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-TSD3">
<p>Dias, S., A. J. Sutton, N. J. Welton, and A. E. Ades. 2011. “NICE DSU Technical Support Document 3: Heterogeneity: Subgroups, Meta-Regression, Bias and Bias-Adjustment.” National Institute for Health and Care Excellence. <a href="http://nicedsu.org.uk/">http://nicedsu.org.uk/</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by David M. Phillippo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
