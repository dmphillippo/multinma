<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Density, distribution, quantile, hazard, cumulative hazard, and restricted
mean survival time functions for the M-spline baseline hazards model."><title>Distribution functions for M-spline baseline hazards — dmspline • multinma</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.7/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Distribution functions for M-spline baseline hazards — dmspline"><meta property="og:description" content="Density, distribution, quantile, hazard, cumulative hazard, and restricted
mean survival time functions for the M-spline baseline hazards model."><meta property="og:image" content="https://dmphillippo.github.io/multinma/logo.svg"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">multinma</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.5.1.9006</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vignette_overview.html">Overview of Examples</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Examples</h6>
    <a class="dropdown-item" href="../articles/example_atrial_fibrillation.html">Example: Atrial fibrillation</a>
    <a class="dropdown-item" href="../articles/example_bcg_vaccine.html">Example: BCG vaccine for tuberculosis</a>
    <a class="dropdown-item" href="../articles/example_blocker.html">Example: Beta blockers</a>
    <a class="dropdown-item" href="../articles/example_diabetes.html">Example: Diabetes</a>
    <a class="dropdown-item" href="../articles/example_dietary_fat.html">Example: Dietary fat</a>
    <a class="dropdown-item" href="../articles/example_hta_psoriasis.html">Example: Plaque psoriasis HTA report</a>
    <a class="dropdown-item" href="../articles/example_ndmm.html">Example: Newly diagnosed multiple myeloma</a>
    <a class="dropdown-item" href="../articles/example_parkinsons.html">Example: Parkinson's disease</a>
    <a class="dropdown-item" href="../articles/example_plaque_psoriasis.html">Example: Plaque psoriasis ML-NMR</a>
    <a class="dropdown-item" href="../articles/example_smoking.html">Example: Smoking cessation</a>
    <a class="dropdown-item" href="../articles/example_statins.html">Example: Statins for cholesterol lowering</a>
    <a class="dropdown-item" href="../articles/example_thrombolytics.html">Example: Thrombolytic treatments</a>
    <a class="dropdown-item" href="../articles/example_transfusion.html">Example: White blood cell transfusion</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dmphillippo/multinma/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Distribution functions for M-spline baseline hazards</h1>
      <small class="dont-index">Source: <a href="https://github.com/dmphillippo/multinma/blob/HEAD/R/mspline.R" class="external-link"><code>R/mspline.R</code></a></small>
      <div class="d-none name"><code>mspline.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Density, distribution, quantile, hazard, cumulative hazard, and restricted
mean survival time functions for the M-spline baseline hazards model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dmspline</span><span class="op">(</span><span class="va">x</span>, <span class="va">basis</span>, <span class="va">scoef</span>, <span class="va">rate</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pmspline</span><span class="op">(</span><span class="va">q</span>, <span class="va">basis</span>, <span class="va">scoef</span>, <span class="va">rate</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span>, log.p <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">qmspline</span><span class="op">(</span><span class="va">p</span>, <span class="va">basis</span>, <span class="va">scoef</span>, <span class="va">rate</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span>, log.p <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmspline</span><span class="op">(</span><span class="va">x</span>, <span class="va">basis</span>, <span class="va">scoef</span>, <span class="va">rate</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Hmspline</span><span class="op">(</span><span class="va">x</span>, <span class="va">basis</span>, <span class="va">scoef</span>, <span class="va">rate</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rmst_mspline</span><span class="op">(</span><span class="va">t</span>, <span class="va">basis</span>, <span class="va">scoef</span>, <span class="va">rate</span>, start <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x, q</dt>
<dd><p>Vector of quantiles</p></dd>


<dt>basis</dt>
<dd><p>M-spline basis produced by <code><a href="https://wwenjie.org/splines2/reference/mSpline.html" class="external-link">splines2::mSpline()</a></code></p></dd>


<dt>scoef</dt>
<dd><p>Vector (or matrix) of spline coefficients with length (or number
of columns) equal to the dimension of <code>basis</code></p></dd>


<dt>rate</dt>
<dd><p>Vector of rate parameters</p></dd>


<dt>log, log.p</dt>
<dd><p>Logical; if <code>TRUE</code>, probabilities <code>p</code> are given as
\(\log(p)\)</p></dd>


<dt>lower.tail</dt>
<dd><p>Logical; if <code>TRUE</code> (the default), probabilities are
\(P(X \le x)\), otherwise \(P(X &gt; x)\)</p></dd>


<dt>p</dt>
<dd><p>Vector of probabilities</p></dd>


<dt>t</dt>
<dd><p>Vector of times to which the restricted mean survival time is
calculated</p></dd>


<dt>start</dt>
<dd><p>Optional left-truncation time or times. The returned restricted
mean survival will be conditioned on survival up to this time</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>dmspline()</code> gives the density, <code>pmspline()</code> gives the distribution
function (CDF), <code>qmspline()</code> gives the quantile function (inverse-CDF),
<code>hmspline()</code> gives the hazard function, <code>Hmspline()</code> gives the cumulative
hazard function, and <code>rmst_mspline()</code> gives restricted mean survival times.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Survival models with a flexible M-spline on the baseline hazard are
described by Brilleman et al. (2020)
.
Piecewise-exponential baseline hazards are a special case where the degree
of the M-spline polynomial is 0.</p>
<p>The d/p/h/H functions are calculated from their definitions. <code>qmspline()</code>
uses numerical inversion via <code><a href="https://rdrr.io/pkg/flexsurv/man/qgeneric.html" class="external-link">flexsurv::qgeneric()</a></code>. <code>rmst_mspline()</code>uses
numerical integration via <code><a href="https://rdrr.io/pkg/flexsurv/man/rmst_generic.html" class="external-link">flexsurv::rmst_generic()</a></code>, except for the
special case of the piecewise-exponential hazard (i.e. degree 0 M-splines)
which uses the explicit formula from
Royston and Parmar (2013)
.</p>
<p>Beyond the boundary knots, the hazard is assumed to be constant. (This
differs from the approach in <code><a href="https://wwenjie.org/splines2/reference/mSpline.html" class="external-link">splines2::mSpline()</a></code> that extrapolates the
polynomial basis functions, which is numerically unstable and highly
dependent on the data just before the boundary knots.) As with all
extrapolation, care should be taken when evaluating the splines at times
beyond the boundary knots (either directly through the d/p/h/H/rmst
functions, or indirectly by requesting quantiles with <code>qmspline()</code> that
correspond to times beyond the boundary knots). For this reason evaluating
the (unrestricted) mean survival time is not generally recommended as this
requires integrating over an infinite time horizon (i.e. <code>rmst_mspline()</code>
with <code>t = Inf</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Brilleman SL, Elci EM, Novik JB, Wolfe R (2020).
“Bayesian Survival Analysis Using the rstanarm R Package.”
<em>arXiv</em>.
<a href="https://doi.org/10.48550/arXiv.2002.09633" class="external-link">doi:10.48550/arXiv.2002.09633</a>
, 2002.09633.<br><br> Royston P, Parmar MKB (2013).
“Restricted mean survival time: an alternative to the hazard ratio for the design and analysis of randomized trials with a time-to-event outcome.”
<em>BMC Medical Research Methodology</em>, <b>13</b>(1).
<a href="https://doi.org/10.1186/1471-2288-13-152" class="external-link">doi:10.1186/1471-2288-13-152</a>
.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by David M. Phillippo.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  <script data-goatcounter="https://multinma.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></body></html>

